(self.webpackChunkcart_compare=self.webpackChunkcart_compare||[]).push([[6847],{9383:function(t,e,n){"use strict";n.r(e),n.d(e,{__PRIVATE_registerFirestore:function(){return Zl}});var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function o(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}u((r=r.apply(t,e||[])).next())})}function s(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function a(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}var u=n(6232),c=n(300),h=n(3701),f=function(t,e){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function l(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var p,d="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},v=v||{},g=d||self;function y(){}function m(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function b(t){var e=m(t);return"array"==e||"object"==e&&"number"==typeof t.length}function w(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var _="closure_uid_"+(1e9*Math.random()>>>0),I=0;function E(t,e,n){return t.call.apply(t.bind,arguments)}function T(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function S(t,e,n){return(S=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?E:T).apply(null,arguments)}function A(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var N=Date.now;function k(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function x(){this.j=this.j,this.i=this.i}x.prototype.j=!1,x.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,_)&&t[_]||(t[_]=++I)}(this)},x.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var O=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},C=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function D(t){return Array.prototype.concat.apply([],arguments)}function P(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function M(t){return/^[\s\xa0]*$/.test(t)}var L,R=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function V(t,e){return-1!=t.indexOf(e)}function F(t,e){return t<e?-1:t>e?1:0}t:{var U=g.navigator;if(U){var j=U.userAgent;if(j){L=j;break t}}L=""}function q(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function B(t){var e={};for(var n in t)e[n]=t[n];return e}var G="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function K(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<G.length;o++)n=G[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function z(t){return z[" "](t),t}z[" "]=y;var W,H,Q=V(L,"Opera"),Y=V(L,"Trident")||V(L,"MSIE"),$=V(L,"Edge"),J=$||Y,X=V(L,"Gecko")&&!(V(L.toLowerCase(),"webkit")&&!V(L,"Edge"))&&!(V(L,"Trident")||V(L,"MSIE"))&&!V(L,"Edge"),Z=V(L.toLowerCase(),"webkit")&&!V(L,"Edge");function tt(){var t=g.document;return t?t.documentMode:void 0}t:{var et="",nt=(H=L,X?/rv:([^\);]+)(\)|;)/.exec(H):$?/Edge\/([\d\.]+)/.exec(H):Y?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(H):Z?/WebKit\/(\S+)/.exec(H):Q?/(?:Version)[ \/]?(\S+)/.exec(H):void 0);if(nt&&(et=nt?nt[1]:""),Y){var rt=tt();if(null!=rt&&rt>parseFloat(et)){W=String(rt);break t}}W=et}var it={};function ot(t){return function(t,e){var n=it;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,function(){for(var e=0,n=R(String(W)).split("."),r=R(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=F(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||F(0==s[2].length,0==a[2].length)||F(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e})}var st=g.document&&Y&&(tt()||parseInt(W,10))||void 0,at=!Y||9<=Number(st),ut=Y&&!ot("9"),ct=function(){if(!g.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{g.addEventListener("test",y,e),g.removeEventListener("test",y,e)}catch(n){}return t}();function ht(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function ft(t,e){if(ht.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(X){t:{try{z(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:lt[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}ht.prototype.b=function(){this.defaultPrevented=!0},k(ft,ht);var lt={2:"touch",3:"pen",4:"mouse"};ft.prototype.b=function(){ft.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,ut)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(lr){}};var pt="closure_listenable_"+(1e6*Math.random()|0),dt=0;function vt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++dt,this.Y=this.Z=!1}function gt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function yt(t){this.src=t,this.a={},this.b=0}function mt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=O(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(gt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function bt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}yt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=bt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new vt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var wt="closure_lm_"+(1e6*Math.random()|0),_t={};function It(t,e,n,r,i){if(r&&r.once)return Tt(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)It(t,e[o],n,r,i);return null}return n=Dt(n),t&&t[pt]?t.va(e,n,w(r)?!!r.capture:!!r,i):Et(t,e,n,!1,r,i)}function Et(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=w(i)?!!i.capture:!!i;if(s&&!at)return null;var a=Ot(t);if(a||(t[wt]=a=new yt(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=xt,e=at?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)ct||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Nt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Tt(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Tt(t,e[o],n,r,i);return null}return n=Dt(n),t&&t[pt]?t.wa(e,n,w(r)?!!r.capture:!!r,i):Et(t,e,n,!0,r,i)}function St(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)St(t,e[o],n,r,i);else r=w(r)?!!r.capture:!!r,n=Dt(n),t&&t[pt]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=bt(o=t.a[e],n,r,i))&&(gt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=Ot(t))&&(e=t.a[e.toString()],t=-1,e&&(t=bt(e,n,r,i)),(n=-1<t?e[t]:null)&&At(n))}function At(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[pt])mt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Nt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ot(e))?(mt(n,t),0==n.b&&(n.src=null,e[wt]=null)):gt(t)}}}function Nt(t){return t in _t?_t[t]:_t[t]="on"+t}function kt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&At(t),n.call(r,e)}function xt(t,e){if(t.Y)return!0;if(!at){if(!e)t:{e=["window","event"];for(var n=g,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return kt(t,e=new ft(e,this))}return kt(t,new ft(e,this))}function Ot(t){return(t=t[wt])instanceof yt?t:null}var Ct="__closure_events_fn_"+(1e9*Math.random()>>>0);function Dt(t){return"function"==m(t)?t:(t[Ct]||(t[Ct]=function(e){return t.handleEvent(e)}),t[Ct])}function Pt(){x.call(this),this.c=new yt(this),this.J=this,this.C=null}function Mt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var a=s.listener,u=s.ca||s.src;s.Z&&mt(t.c,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}k(Pt,x),Pt.prototype[pt]=!0,(p=Pt.prototype).addEventListener=function(t,e,n,r){It(this,t,e,n,r)},p.removeEventListener=function(t,e,n,r){St(this,t,e,n,r)},p.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t)t=new ht(t,n);else if(t instanceof ht)t.target=t.target||n;else{var i=t;K(t=new ht(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];i=Mt(s,r,!0,t)&&i}if(i=Mt(s=t.a=n,r,!0,t)&&i,i=Mt(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Mt(s=t.a=e[o],r,!1,t)&&i;return i},p.G=function(){if(Pt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)gt(n[r]);delete e.a[t],e.b--}}this.C=null},p.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},p.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Lt=g.JSON.stringify;function Rt(){this.b=this.a=null}var Vt,Ft=new(function(){function t(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())(function(){return new jt},function(t){t.reset()},100);function Ut(){var t=Kt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function jt(){this.next=this.b=this.a=null}function qt(t){g.setTimeout(function(){throw t},0)}function Bt(t,e){Vt||function(){var t=g.Promise.resolve(void 0);Vt=function(){t.then(zt)}}(),Gt||(Vt(),Gt=!0),Kt.add(t,e)}Rt.prototype.add=function(t,e){var n=Ft.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},jt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},jt.prototype.reset=function(){this.next=this.b=this.a=null};var Gt=!1,Kt=new Rt;function zt(){for(var t;t=Ut();){try{t.a.call(t.b)}catch(n){qt(n)}var e=Ft;e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)}Gt=!1}function Wt(t,e){Pt.call(this),this.b=t||1,this.a=e||g,this.f=S(this.Ya,this),this.g=N()}function Ht(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Qt(t,e,n){if("function"==m(t))n&&(t=S(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=S(t.handleEvent,t)}return 2147483647<Number(e)?-1:g.setTimeout(t,e||0)}function Yt(t){t.a=Qt(function(){t.a=null,t.c&&(t.c=!1,Yt(t))},t.h);var e=t.b;t.b=null,t.g.apply(null,e)}k(Wt,Pt),(p=Wt.prototype).aa=!1,p.M=null,p.Ya=function(){if(this.aa){var t=N()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(Ht(this),this.start()))}},p.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=N())},p.G=function(){Wt.S.G.call(this),Ht(this),delete this.a};var $t=function(t){function e(e,n,r){var i=t.call(this)||this;return i.g=null!=r?e.bind(r):e,i.h=n,i.b=null,i.c=!1,i.a=null,i}return function(t,e){function n(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Yt(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(g.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(x);function Jt(t){x.call(this),this.b=t,this.a={}}k(Jt,x);var Xt=[];function Zt(t,e,n,r){Array.isArray(n)||(n&&(Xt[0]=n.toString()),n=Xt);for(var i=0;i<n.length;i++){var o=It(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function te(t){q(t.a,function(t,e){this.a.hasOwnProperty(e)&&At(t)},t),t.a={}}function ee(){this.a=!0}function ne(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Lt(n)}catch(a){return e}}(t,n)+(r?" "+r:"")})}Jt.prototype.G=function(){Jt.S.G.call(this),te(this)},Jt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ee.prototype.info=function(){};var re=null;function ie(){return re=re||new Pt}function oe(t){ht.call(this,"serverreachability",t)}function se(t){var e=ie();e.dispatchEvent(new oe(e,t))}function ae(t){ht.call(this,"statevent",t)}function ue(t){var e=ie();e.dispatchEvent(new ae(e,t))}function ce(t){ht.call(this,"timingevent",t)}function he(t,e){if("function"!=m(t))throw Error("Fn must not be null and must be a function");return g.setTimeout(function(){t()},e)}k(oe,ht),k(ae,ht),k(ce,ht);var fe={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},le={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function pe(){}function de(){}pe.prototype.a=null;var ve,ge={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function ye(){ht.call(this,"d")}function me(){ht.call(this,"c")}function be(){}function we(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new Jt(this),this.P=_e,this.R=new Wt(t=J?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}k(ye,ht),k(me,ht),k(be,pe),ve=new be;var _e=45e3,Ie={},Ee={};function Te(t,e,n){t.H=1,t.i=We(je(e)),t.j=n,t.I=!0,Se(t,null)}function Se(t,e){t.u=N(),ke(t),t.l=je(t.i);var n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),sn(n.b,"t",r),t.D=0,t.a=tr(t.g,t.g.C?e:null),0<t.O&&(t.F=new $t(S(t.Ca,t,t.a),t.O)),Zt(t.J,t.a,"readystatechange",t.Wa),e=t.B?B(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),se(1),function(t,e,n,r,i,o){t.info(function(){if(t.a)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var f=h.split("_");s=2<=f.length&&"type"==f[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.c,t.m,t.l,t.f,t.T,t.j)}function Ae(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=Ne(t,n);if(i==Ee){4==e&&(t.h=4,ue(14),r=!1),ne(t.c,t.f,null,"[Incomplete Response]");break}if(i==Ie){t.h=4,ue(15),ne(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}ne(t.c,t.f,i,null),Pe(t,i)}4==e&&0==n.length&&(t.h=1,ue(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Wn(e),e.F=!0)):(ne(t.c,t.f,n,"[Invalid Chunked Response]"),De(t),Ce(t))}function Ne(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?Ee:(n=Number(e.substring(n,r)),isNaN(n)?Ie:(r+=1)+n>e.length?Ee:(e=e.substr(r,n),t.D=r+n,e))}function ke(t){t.U=N()+t.P,xe(t,t.P)}function xe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=he(S(t.Ua,t),e)}function Oe(t){t.o&&(g.clearTimeout(t.o),t.o=null)}function Ce(t){0==t.g.v||t.A||Yn(t.g,t)}function De(t){Oe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Ht(t.R),te(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Pe(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||pn(n.b,t)))if(n.I=t.N,!t.C&&pn(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(Zl){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Qn(n),Vn(n)}zn(n),ue(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=he(S(n.Ra,n),6e3));if(1>=ln(n.b)&&n.ea){try{n.ea()}catch(Zl){}n.ea=void 0}}else Jn(n,11)}else if((t.C||n.a==t)&&Qn(n),!M(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(n.P=(i=e[r])[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var a=i[5];if(null!=a&&"number"==typeof a&&0<a){var u=1.5*a;n.D=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=u.b;!f.a&&(V(h,"spdy")||V(h,"quic")||V(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(dn(f,f.b),f.b=null))}if(u.A){var l=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(u.na=l,ze(u.B,u.A,l))}}n.v=3,n.f&&n.f.ta(),n.V&&(n.N=N()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((u=n).la=Zn(u,u.C?u.ga:null,u.fa),p.C){vn(u.b,p);var d=p,v=u.D;v&&d.setTimeout(v),d.o&&(Oe(d),ke(d)),u.a=p}else Kn(u);0<n.g.length&&jn(n)}else"stop"!=i[0]&&"close"!=i[0]||Jn(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?Jn(n,7):Rn(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);se(4)}catch(Zl){}}function Me(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(b(t)||"string"==typeof t)C(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(b(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(b(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Le(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Le)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Re(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ve(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Ve(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Ve(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(p=we.prototype).setTimeout=function(t){this.P=t},p.Wa=function(t){t=t.target;var e=this.F;e&&3==Dn(t)?e.f():this.Ca(t)},p.Ca=function(t){try{if(t==this.a)t:{var e=Dn(this.a),n=this.a.ua(),r=this.a.X();if(!(3>e||3==e&&!J&&!this.a.$())){this.A||4!=e||7==n||se(8==n||0>=r?3:2),Oe(this);var i=this.a.X();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.c,this.m,this.l,this.f,this.T,e,i),this.b){if(this.V&&!this.C){e:{if(this.a){var s,a=this.a;if((s=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.h=3,ue(12),De(this),Ce(this);break t}ne(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Pe(this,u)}this.I?(Ae(this,e,o),J&&this.b&&3==e&&(Zt(this.J,this.R,"tick",this.Va),this.R.start())):(ne(this.c,this.f,o,null),Pe(this,o)),4==e&&De(this),this.b&&!this.A&&(4==e?Yn(this.g,this):(this.b=!1,ke(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,ue(12)):(this.h=0,ue(13)),De(this),Ce(this)}}}catch(c){}},p.Va=function(){if(this.a){var t=Dn(this.a),e=this.a.$();this.D<e.length&&(Oe(this),Ae(this,t,e),this.b&&4!=t&&ke(this))}},p.cancel=function(){this.A=!0,De(this)},p.Ua=function(){this.o=null;var t=N();0<=t-this.U?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.c,this.l),2!=this.H&&(se(3),ue(17)),De(this),this.h=2,Ce(this)):xe(this,this.U-t)},(p=Le.prototype).K=function(){Re(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},p.L=function(){return Re(this),this.a.concat()},p.get=function(t,e){return Ve(this.b,t)?this.b[t]:e},p.set=function(t,e){Ve(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},p.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Fe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ue(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ue){this.a=void 0!==e?e:t.a,qe(this,t.f),this.j=t.j,Be(this,t.c),Ge(this,t.h),this.g=t.g,e=t.b;var n=new en;n.c=e.c,e.a&&(n.a=new Le(e.a),n.b=e.b),Ke(this,n),this.i=t.i}else t&&(n=String(t).match(Fe))?(this.a=!!e,qe(this,n[1]||"",!0),this.j=He(n[2]||""),Be(this,n[3]||"",!0),Ge(this,n[4]),this.g=He(n[5]||"",!0),Ke(this,n[6]||"",!0),this.i=He(n[7]||"")):(this.a=!!e,this.b=new en(null,this.a))}function je(t){return new Ue(t)}function qe(t,e,n){t.f=n?He(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Be(t,e,n){t.c=n?He(e,!0):e}function Ge(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ke(t,e,n){e instanceof en?(t.b=e,function(t,e){e&&!t.f&&(nn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(rn(this,e),sn(this,n,t))},t)),t.f=e}(t.b,t.a)):(n||(e=Qe(e,Ze)),t.b=new en(e,t.a))}function ze(t,e,n){t.b.set(e,n)}function We(t){return ze(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^N()).toString(36)),t}function He(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Qe(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Ye),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Ye(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ue.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Qe(e,$e,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(Qe(e,$e,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Qe(n,"/"==n.charAt(0)?Xe:Je,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Qe(n,tn)),t.join("")};var $e=/[#\/\?@]/g,Je=/[#\?:]/g,Xe=/[#\?]/g,Ze=/[#\?@]/g,tn=/#/g;function en(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function nn(t){t.a||(t.a=new Le,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function rn(t,e){nn(t),e=an(t,e),Ve(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ve((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Re(t)))}function on(t,e){return nn(t),e=an(t,e),Ve(t.a.b,e)}function sn(t,e,n){rn(t,e),0<n.length&&(t.c=null,t.a.set(an(t,e),P(n)),t.b+=n.length)}function an(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function un(t,e){this.b=t,this.a=e}function cn(t){this.g=t||hn,t=g.PerformanceNavigationTiming?0<(t=g.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(g.ia&&g.ia.ya&&g.ia.ya()&&g.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(p=en.prototype).add=function(t,e){nn(this),this.c=null,t=an(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},p.forEach=function(t,e){nn(this),this.a.forEach(function(n,r){C(n,function(n){t.call(e,n,r,this)},this)},this)},p.L=function(){nn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},p.K=function(t){nn(this);var e=[];if("string"==typeof t)on(this,t)&&(e=D(e,this.a.get(an(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=D(e,t[n])}return e},p.set=function(t,e){return nn(this),this.c=null,on(this,t=an(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},p.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},p.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var hn=10;function fn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function ln(t){return t.b?1:t.a?t.a.size:0}function pn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function dn(t,e){t.a?t.a.add(e):t.b=e}function vn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function gn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=l(t.a.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.s)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return P(t.c)}function yn(){}function mn(){this.a=new yn}function bn(t,e,n){var r=n||"";try{Me(t,function(t,n){var i=t;w(t)&&(i=Lt(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function wn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}cn.prototype.cancel=function(){var t,e;if(this.c=gn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=l(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},yn.prototype.stringify=function(t){return g.JSON.stringify(t,void 0)},yn.prototype.parse=function(t){return g.JSON.parse(t,void 0)};var _n=g.JSON.parse;function In(t){Pt.call(this),this.headers=new Le,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=En,this.D=this.F=!1}k(In,Pt);var En="",Tn=/^https?$/i,Sn=["POST","PUT"];function An(t){return"content-type"==t.toLowerCase()}function Nn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,kn(t),On(t)}function kn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function xn(t){if(t.b&&void 0!==v&&(!t.s[1]||4!=Dn(t)||2!=t.X()))if(t.l&&4==Dn(t))Qt(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Dn(t)){t.b=!1;try{var e,n=t.X();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(Fe)[1]||null;if(!o&&g.self&&g.self.location){var s=g.self.location.protocol;o=s.substr(0,s.length-1)}i=!Tn.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var a=2<Dn(t)?t.a.statusText:""}catch(u){a=""}t.f=a+" ["+t.X()+"]",kn(t)}}finally{On(t)}}}function On(t,e){if(t.a){Cn(t);var n=t.a,r=t.s[0]?y:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){}}}function Cn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(g.clearTimeout(t.m),t.m=null)}function Dn(t){return t.a?t.a.readyState:0}function Pn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return q(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):ze(t,e,n))}function Mn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Ln(t){this.pa=0,this.g=[],this.c=new ee,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Mn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Mn("baseRetryDelayMs",5e3,t),this.Ma=Mn("retryDelaySeedMs",1e4,t),this.Ja=Mn("forwardChannelMaxRetries",2,t),this.ma=Mn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new cn(t&&t.concurrentRequestLimit),this.ka=new mn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Rn(t){if(Fn(t),3==t.v){var e=t.R++,n=je(t.B);ze(n,"SID",t.J),ze(n,"RID",e),ze(n,"TYPE","terminate"),Bn(t,n),(e=new we(t,t.c,e,void 0)).H=2,e.i=We(je(n)),n=!1,g.navigator&&g.navigator.sendBeacon&&(n=g.navigator.sendBeacon(e.i.toString(),"")),!n&&g.Image&&((new Image).src=e.i,n=!0),n||(e.a=tr(e.g,null),e.a.ba(e.i)),e.u=N(),ke(e)}Xn(t)}function Vn(t){t.a&&(Wn(t),t.a.cancel(),t.a=null)}function Fn(t){Vn(t),t.j&&(g.clearTimeout(t.j),t.j=null),Qn(t),t.b.cancel(),t.h&&("number"==typeof t.h&&g.clearTimeout(t.h),t.h=null)}function Un(t,e){t.g.push(new un(t.La++,e)),3==t.v&&jn(t)}function jn(t){fn(t.b)||t.h||(t.h=!0,Bt(t.Ba,t),t.u=0)}function qn(t,e){var n;n=e?e.f:t.R++;var r=je(t.B);ze(r,"SID",t.J),ze(r,"RID",n),ze(r,"AID",t.P),Bn(t,r),t.i&&t.l&&Pn(r,t.i,t.l),n=new we(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Gn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),dn(t.b,n),Te(n,r,e)}function Bn(t,e){t.f&&Me({},function(t,n){ze(e,n,t)})}function Gn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?S(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].b)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),a=!1;else try{bn(h,s,"req"+c+"_")}catch(Lr){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Kn(t){t.a||t.j||(t.U=1,Bt(t.Aa,t),t.o=0)}function zn(t){return!(t.a||t.j||3<=t.o||(t.U++,t.j=he(S(t.Aa,t),$n(t,t.o)),t.o++,0))}function Wn(t){null!=t.s&&(g.clearTimeout(t.s),t.s=null)}function Hn(t){t.a=new we(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=je(t.la);ze(e,"RID","rpc"),ze(e,"SID",t.J),ze(e,"CI",t.H?"0":"1"),ze(e,"AID",t.P),Bn(t,e),ze(e,"TYPE","xmlhttp"),t.i&&t.l&&Pn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=We(je(e)),n.j=null,n.I=!0,Se(n,t)}function Qn(t){null!=t.m&&(g.clearTimeout(t.m),t.m=null)}function Yn(t,e){var n=null;if(t.a==e){Qn(t),Wn(t),t.a=null;var r=2}else{if(!pn(t.b,e))return;n=e.s,vn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=N()-e.u;var i=t.u;(r=ie()).dispatchEvent(new ce(r,n,e,i)),jn(t)}else Kn(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(ln(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)||(t.h=he(S(t.Ba,t,e),$n(t,t.u)),t.u++,0)))}(t,e)||2==r&&zn(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:Jn(t,5);break;case 4:Jn(t,10);break;case 3:Jn(t,6);break;default:Jn(t,2)}}function $n(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function Jn(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=S(t.Xa,t);n||(n=new Ue("//www.google.com/images/cleardot.gif"),g.location&&"http"==g.location.protocol||qe(n,"https"),We(n)),function(t,e){var n=new ee;if(g.Image){var r=new Image;r.onload=A(wn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=A(wn,n,r,"TestLoadImage: error",!1,e),r.onabort=A(wn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=A(wn,n,r,"TestLoadImage: timeout",!1,e),g.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else ue(2);t.v=0,t.f&&t.f.ra(e),Xn(t),Fn(t)}function Xn(t){t.v=0,t.I=-1,t.f&&(0==gn(t.b).length&&0==t.g.length||(t.b.c.length=0,P(t.g),t.g.length=0),t.f.qa())}function Zn(t,e,n){var r=function(t){return t instanceof Ue?je(t):new Ue(t,void 0)}(n);if(""!=r.c)e&&Be(r,e+"."+r.c),Ge(r,r.h);else{var i=g.location;r=function(t,e,n,r){var i=new Ue(null,void 0);return t&&qe(i,t),e&&Be(i,e),n&&Ge(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.W&&q(t.W,function(t,e){ze(r,e,t)}),n=t.na,(e=t.A)&&n&&ze(r,e,n),ze(r,"VER",t.ha),Bn(t,r),r}function tr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new In(t.Ka)).F=t.C,e}function er(){}function nr(){if(Y&&!(10<=Number(st)))throw Error("Environmental error: no available transport.")}function rr(t,e){Pt.call(this),this.a=new Ln(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!M(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!M(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new sr(this)}function ir(t){ye.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function or(){me.call(this),this.status=1}function sr(t){this.a=t}(p=In.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(t){var e;return(e=t.a)||(e=t.a={}),e}(this.H?this.H:ve),this.a.onreadystatechange=S(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void Nn(this,o)}t=n||"";var i=new Le(this.headers);r&&Me(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=An,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=g.FormData&&t instanceof g.FormData,!(0<=O(Sn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Cn(this),0<this.o&&((this.D=function(t){return Y&&ot(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=S(this.xa,this)):this.m=Qt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){Nn(this,o)}},p.xa=function(){void 0!==v&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},p.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),On(this))},p.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),On(this,!0)),In.S.G.call(this)},p.za=function(){this.j||(this.A||this.l||this.g?xn(this):this.Ta())},p.Ta=function(){xn(this)},p.X=function(){try{return 2<Dn(this)?this.a.status:-1}catch(H){return-1}},p.$=function(){try{return this.a?this.a.responseText:""}catch(H){return""}},p.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),_n(e)}},p.ua=function(){return this.h},p.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(p=Ln.prototype).ha=8,p.v=1,p.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new we(this,this.c,t,void 0),r=this.l;if(this.O&&(r?K(r=B(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Gn(this,n,e),ze(i=je(this.B),"RID",t),ze(i,"CVER",22),this.A&&ze(i,"X-HTTP-Session-Id",this.A),Bn(this,i),this.i&&r&&Pn(i,this.i,r),dn(this.b,n),this.Ga&&ze(i,"TYPE","init"),this.da?(ze(i,"$req",e),ze(i,"SID","null"),n.V=!0,Te(n,i,null)):Te(n,i,e),this.v=2}}else 3==this.v&&(t?qn(this,t):0==this.g.length||fn(this.b)||qn(this))},p.Aa=function(){if(this.j=null,Hn(this),this.V&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=he(S(this.Sa,this),t)}},p.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Vn(this),Hn(this))},p.Ra=function(){null!=this.m&&(this.m=null,Vn(this),zn(this),ue(19))},p.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),ue(2)):(this.c.info("Failed to ping google.com"),ue(1))},(p=er.prototype).ta=function(){},p.sa=function(){},p.ra=function(){},p.qa=function(){},p.Ha=function(){},nr.prototype.a=function(t,e){return new rr(t,e)},k(rr,Pt),(p=rr.prototype).addEventListener=function(t,e,n,r){rr.S.addEventListener.call(this,t,e,n,r)},p.removeEventListener=function(t,e,n,r){rr.S.removeEventListener.call(this,t,e,n,r)},p.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;ue(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=Zn(t,null,t.fa),jn(t)},p.close=function(){Rn(this.a)},p.Pa=function(t){if("string"==typeof t){var e={};e.__data__=t,Un(this.a,e)}else this.g?((e={}).__data__=Lt(t),Un(this.a,e)):Un(this.a,t)},p.G=function(){this.a.f=null,delete this.f,Rn(this.a),delete this.a,rr.S.G.call(this)},k(ir,ye),k(or,me),k(sr,er),sr.prototype.ta=function(){this.a.dispatchEvent("a")},sr.prototype.sa=function(t){this.a.dispatchEvent(new ir(t))},sr.prototype.ra=function(t){this.a.dispatchEvent(new or(t))},sr.prototype.qa=function(){this.a.dispatchEvent("b")},nr.prototype.createWebChannel=nr.prototype.a,rr.prototype.send=rr.prototype.Pa,rr.prototype.open=rr.prototype.Oa,rr.prototype.close=rr.prototype.close,fe.NO_ERROR=0,fe.TIMEOUT=8,fe.HTTP_ERROR=6,le.COMPLETE="complete",de.EventType=ge,ge.OPEN="a",ge.CLOSE="b",ge.ERROR="c",ge.MESSAGE="d",Pt.prototype.listen=Pt.prototype.va,In.prototype.listenOnce=In.prototype.wa,In.prototype.getLastError=In.prototype.Qa,In.prototype.getLastErrorCode=In.prototype.ua,In.prototype.getStatus=In.prototype.X,In.prototype.getResponseJson=In.prototype.Na,In.prototype.getResponseText=In.prototype.$,In.prototype.send=In.prototype.ba;var ar=fe,ur=le,cr=de,hr=In,fr=n(8308),lr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},pr=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),dr=new c.Yd("@firebase/firestore");function vr(){return dr.logLevel}function gr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(dr.logLevel<=c.in.DEBUG){var r=e.map(br);dr.debug.apply(dr,a(["Firestore (8.0.2): "+t],r))}}function yr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(dr.logLevel<=c.in.ERROR){var r=e.map(br);dr.error.apply(dr,a(["Firestore (8.0.2): "+t],r))}}function mr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(dr.logLevel<=c.in.WARN){var r=e.map(br);dr.warn.apply(dr,a(["Firestore (8.0.2): "+t],r))}}function br(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(e){return t}}function wr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.0.2) INTERNAL ASSERTION FAILED: "+t;throw yr(e),new Error(e)}function _r(t,e){t||wr()}function Ir(t,e){return t}function Er(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Tr=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Er(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Sr(t,e){return t<e?-1:t>e?1:0}function Ar(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function Nr(t){return t+"\0"}function kr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function xr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Or(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Cr=function(){function t(t,e){this.h=t,this.l=e,this._={}}return t.prototype.get=function(t){var e=this.h(t),n=this._[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.l(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.h(t),r=this._[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.l(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this._[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.h(t),n=this._[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.l(n[r][0],t))return 1===n.length?delete this._[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){xr(this._,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}})},t.prototype.T=function(){return Or(this._)},t}(),Dr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Pr=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return i(e,t),e}(Error),Mr=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Pr(Dr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Pr(Dr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Pr(Dr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Pr(Dr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.I=function(t){return this.seconds===t.seconds?Sr(this.nanoseconds,t.nanoseconds):Sr(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),Lr=function(){function t(t){this.timestamp=t}return t.m=function(e){return new t(e)},t.min=function(){return new t(new Mr(0,0))},t.prototype.A=function(t){return this.timestamp.I(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.R=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.P=function(){return this.timestamp},t}(),Rr=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&wr(),void 0===n?n=t.length-e:n>t.length-e&&wr(),this.segments=t,this.offset=e,this.g=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.g},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.V(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.p(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.v=function(t){return this.p(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.S=function(){return this.p(this.segments,this.offset,this.length-1)},t.prototype.D=function(){return this.segments[this.offset]},t.prototype.C=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.T=function(){return 0===this.length},t.prototype.N=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.F=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.O=function(){return this.segments.slice(this.offset,this.limit())},t.V=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Vr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.p=function(t,n,r){return new e(t,n,r)},e.prototype.M=function(){return this.O().join("/")},e.prototype.toString=function(){return this.M()},e.k=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Pr(Dr.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.$=function(){return new e([])},e}(Rr),Fr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ur=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.p=function(t,n,r){return new e(t,n,r)},e.L=function(t){return Fr.test(t)},e.prototype.M=function(){return this.O().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.L(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.M()},e.prototype.B=function(){return 1===this.length&&"__name__"===this.get(0)},e.q=function(){return new e(["__name__"])},e.U=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Pr(Dr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new Pr(Dr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Pr(Dr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new Pr(Dr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.$=function(){return new e([])},e}(Rr),jr=function(){function t(t){this.path=t}return t.K=function(e){return new t(Vr.k(e))},t.W=function(e){return new t(Vr.k(e).v(5))},t.prototype.j=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===Vr.V(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.V=function(t,e){return Vr.V(t.path,e.path)},t.G=function(t){return t.length%2==0},t.H=function(e){return new t(new Vr(e.slice()))},t}();function qr(t){return null==t}function Br(t){return 0===t&&1/t==-1/0}function Gr(t){return"number"==typeof t&&Number.isInteger(t)&&!Br(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Kr=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.J=null};function zr(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Kr(t,e,n,r,i,o,s)}function Wr(t){var e=Ir(t);if(null===e.J){var n=e.path.M();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.M()+t.op.toString()+Fi(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return(e=t).field.M()+e.dir;var e}).join(","),qr(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Gs(e.startAt)),e.endAt&&(n+="|ub:",n+=Gs(e.endAt)),e.J=n}return e.J}function Hr(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Qs(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!Mi(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!zs(t.startAt,e.startAt)&&zs(t.endAt,e.endAt)}function Qr(t){return jr.G(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Yr=function(){function t(t){this.Y=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.Y)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.Y)},t.prototype.X=function(){return 2*this.Y.length},t.prototype.A=function(t){return Sr(this.Y,t.Y)},t.prototype.isEqual=function(t){return this.Y===t.Y},t}();Yr.Z=new Yr("");var $r,Jr,Xr=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=Lr.min()),void 0===o&&(o=Lr.min()),void 0===s&&(s=Yr.Z),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.nt=function(e){return new t(this.target,this.targetId,this.tt,e,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.st=function(e,n){return new t(this.target,this.targetId,this.tt,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.it=function(e){return new t(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,e,this.resumeToken)},t}(),Zr=function(t){this.count=t};function ti(t){switch(t){case Dr.OK:return wr();case Dr.CANCELLED:case Dr.UNKNOWN:case Dr.DEADLINE_EXCEEDED:case Dr.RESOURCE_EXHAUSTED:case Dr.INTERNAL:case Dr.UNAVAILABLE:case Dr.UNAUTHENTICATED:return!1;case Dr.INVALID_ARGUMENT:case Dr.NOT_FOUND:case Dr.ALREADY_EXISTS:case Dr.PERMISSION_DENIED:case Dr.FAILED_PRECONDITION:case Dr.ABORTED:case Dr.OUT_OF_RANGE:case Dr.UNIMPLEMENTED:case Dr.DATA_LOSS:return!0;default:return wr()}}function ei(t){if(void 0===t)return yr("GRPC error has no .code"),Dr.UNKNOWN;switch(t){case $r.OK:return Dr.OK;case $r.CANCELLED:return Dr.CANCELLED;case $r.UNKNOWN:return Dr.UNKNOWN;case $r.DEADLINE_EXCEEDED:return Dr.DEADLINE_EXCEEDED;case $r.RESOURCE_EXHAUSTED:return Dr.RESOURCE_EXHAUSTED;case $r.INTERNAL:return Dr.INTERNAL;case $r.UNAVAILABLE:return Dr.UNAVAILABLE;case $r.UNAUTHENTICATED:return Dr.UNAUTHENTICATED;case $r.INVALID_ARGUMENT:return Dr.INVALID_ARGUMENT;case $r.NOT_FOUND:return Dr.NOT_FOUND;case $r.ALREADY_EXISTS:return Dr.ALREADY_EXISTS;case $r.PERMISSION_DENIED:return Dr.PERMISSION_DENIED;case $r.FAILED_PRECONDITION:return Dr.FAILED_PRECONDITION;case $r.ABORTED:return Dr.ABORTED;case $r.OUT_OF_RANGE:return Dr.OUT_OF_RANGE;case $r.UNIMPLEMENTED:return Dr.UNIMPLEMENTED;case $r.DATA_LOSS:return Dr.DATA_LOSS;default:return wr()}}(Jr=$r||($r={}))[Jr.OK=0]="OK",Jr[Jr.CANCELLED=1]="CANCELLED",Jr[Jr.UNKNOWN=2]="UNKNOWN",Jr[Jr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Jr[Jr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Jr[Jr.NOT_FOUND=5]="NOT_FOUND",Jr[Jr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Jr[Jr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Jr[Jr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Jr[Jr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Jr[Jr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Jr[Jr.ABORTED=10]="ABORTED",Jr[Jr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Jr[Jr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Jr[Jr.INTERNAL=13]="INTERNAL",Jr[Jr.UNAVAILABLE=14]="UNAVAILABLE",Jr[Jr.DATA_LOSS=15]="DATA_LOSS";var ni=function(){function t(t,e){this.V=t,this.root=e||ii.EMPTY}return t.prototype.rt=function(e,n){return new t(this.V,this.root.rt(e,n,this.V).copy(null,null,ii.ot,null,null))},t.prototype.remove=function(e){return new t(this.V,this.root.remove(e,this.V).copy(null,null,ii.ot,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.T();){var n=this.V(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.T();){var r=this.V(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.T=function(){return this.root.T()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.at=function(){return this.root.at()},t.prototype.ct=function(){return this.root.ct()},t.prototype.ut=function(t){return this.root.ut(t)},t.prototype.forEach=function(t){this.ut(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.ut(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.ht=function(t){return this.root.ht(t)},t.prototype.lt=function(){return new ri(this.root,null,this.V,!1)},t.prototype._t=function(t){return new ri(this.root,t,this.V,!1)},t.prototype.ft=function(){return new ri(this.root,null,this.V,!0)},t.prototype.dt=function(t){return new ri(this.root,t,this.V,!0)},t}(),ri=function(){function t(t,e,n,r){this.wt=r,this.Tt=[];for(var i=1;!t.T();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}return t.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.T();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.T();)this.Tt.push(t),t=t.left;return e},t.prototype.It=function(){return this.Tt.length>0},t.prototype.At=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},t}(),ii=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.T=function(){return!1},t.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},t.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},t.prototype.min=function(){return this.left.T()?this:this.left.min()},t.prototype.at=function(){return this.min().key},t.prototype.ct=function(){return this.right.T()?this.key:this.right.ct()},t.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},t.prototype.Pt=function(){if(this.left.T())return t.EMPTY;var e=this;return e.left.gt()||e.left.left.gt()||(e=e.Vt()),(e=e.copy(null,null,null,e.left.Pt(),null)).Rt()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.T()||i.left.gt()||i.left.left.gt()||(i=i.Vt()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.gt()&&(i=i.yt()),i.right.T()||i.right.gt()||i.right.left.gt()||(i=i.vt()),0===n(e,i.key)){if(i.right.T())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.Pt())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.Rt()},t.prototype.gt=function(){return this.color},t.prototype.Rt=function(){var t=this;return t.right.gt()&&!t.left.gt()&&(t=t.bt()),t.left.gt()&&t.left.left.gt()&&(t=t.yt()),t.left.gt()&&t.right.gt()&&(t=t.St()),t},t.prototype.Vt=function(){var t=this.St();return t.right.left.gt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.yt())).bt()).St()),t},t.prototype.vt=function(){var t=this.St();return t.left.left.gt()&&(t=(t=t.yt()).St()),t},t.prototype.bt=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.yt=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Dt=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},t.prototype.Ct=function(){if(this.gt()&&this.left.gt())throw wr();if(this.right.gt())throw wr();var t=this.left.Ct();if(t!==this.right.Ct())throw wr();return t+(this.gt()?0:1)},t}();ii.EMPTY=null,ii.RED=!0,ii.ot=!1,ii.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw wr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw wr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw wr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw wr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw wr()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.rt=function(t,e,n){return new ii(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.T=function(){return!0},t.prototype.ut=function(t){return!1},t.prototype.ht=function(t){return!1},t.prototype.at=function(){return null},t.prototype.ct=function(){return null},t.prototype.gt=function(){return!1},t.prototype.Dt=function(){return!0},t.prototype.Ct=function(){return 0},t}());var oi=function(){function t(t){this.V=t,this.data=new ni(this.V)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.at()},t.prototype.last=function(){return this.data.ct()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.ut(function(e,n){return t(e),!1})},t.prototype.Nt=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Et();if(this.V(r.key,t[1])>=0)return;e(r.key)}},t.prototype.xt=function(t,e){var n;for(n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},t.prototype.Ft=function(t){var e=this.data._t(t);return e.It()?e.Et().key:null},t.prototype.lt=function(){return new si(this.data.lt())},t.prototype._t=function(t){return new si(this.data._t(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.T=function(){return this.data.T()},t.prototype.Ot=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.lt(),r=e.data.lt();n.It();){var i=n.Et().key,o=r.Et().key;if(0!==this.V(i,o))return!1}return!0},t.prototype.O=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.V);return n.data=e,n},t}(),si=function(){function t(t){this.Mt=t}return t.prototype.Et=function(){return this.Mt.Et().key},t.prototype.It=function(){return this.Mt.It()},t}(),ai=new ni(jr.V);function ui(){return ai}function ci(){return ui()}var hi=new ni(jr.V);function fi(){return hi}var li=new ni(jr.V),pi=new oi(jr.V);function di(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=pi,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var vi=new oi(Sr);function gi(){return vi}var yi=function(){function t(t){this.V=t?function(e,n){return t(e,n)||jr.V(e.key,n.key)}:function(t,e){return jr.V(t.key,e.key)},this.kt=fi(),this.$t=new ni(this.V)}return t.Lt=function(e){return new t(e.V)},t.prototype.has=function(t){return null!=this.kt.get(t)},t.prototype.get=function(t){return this.kt.get(t)},t.prototype.first=function(){return this.$t.at()},t.prototype.last=function(){return this.$t.ct()},t.prototype.T=function(){return this.$t.T()},t.prototype.indexOf=function(t){var e=this.kt.get(t);return e?this.$t.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.$t.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.$t.ut(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.kt.rt(t.key,t),e.$t.rt(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.kt.remove(t),this.$t.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.$t.lt(),r=e.$t.lt();n.It();){var i=n.Et().key,o=r.Et().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.V=this.V,r.kt=e,r.$t=n,r},t}(),mi=function(){function t(){this.Bt=new ni(jr.V)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Bt.get(e);n?0!==t.type&&3===n.type?this.Bt=this.Bt.rt(e,t):3===t.type&&1!==n.type?this.Bt=this.Bt.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Bt=this.Bt.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Bt=this.Bt.remove(e):1===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):wr():this.Bt=this.Bt.rt(e,t)},t.prototype.qt=function(){var t=[];return this.Bt.ut(function(e,n){t.push(n)}),t},t}(),bi=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.Ut=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Kt=s,this.Wt=a}return t.jt=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,yi.Lt(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Qt.T()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Kt===t.Kt&&this.Qt.isEqual(t.Qt)&&ks(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ut.isEqual(t.Ut)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),wi=function(){function t(t,e,n,r,i){this.et=t,this.Gt=e,this.zt=n,this.Ht=r,this.Jt=i}return t.Yt=function(e,n){var r=new Map;return r.set(e,_i.Xt(e,n)),new t(Lr.min(),r,gi(),ui(),di())},t}(),_i=function(){function t(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}return t.Xt=function(e,n){return new t(Yr.Z,n,di(),di(),di())},t}(),Ii=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},Ei=function(t,e){this.targetId=t,this.re=e},Ti=function(t,e,n,r){void 0===n&&(n=Yr.Z),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Si=function(){function t(){this.oe=0,this.ae=ki(),this.ce=Yr.Z,this.ue=!1,this.he=!0}return Object.defineProperty(t.prototype,"Zt",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),t.prototype.fe=function(t){t.X()>0&&(this.he=!0,this.ce=t)},t.prototype.de=function(){var t=di(),e=di(),n=di();return this.ae.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:wr()}}),new _i(this.ce,this.ue,t,e,n)},t.prototype.we=function(){this.he=!1,this.ae=ki()},t.prototype.Te=function(t,e){this.he=!0,this.ae=this.ae.rt(t,e)},t.prototype.Ee=function(t){this.he=!0,this.ae=this.ae.remove(t)},t.prototype.Ie=function(){this.oe+=1},t.prototype.me=function(){this.oe-=1},t.prototype.Ae=function(){this.he=!0,this.ue=!0},t}(),Ai=function(){function t(t){this.Re=t,this.Pe=new Map,this.ge=ui(),this.Ve=Ni(),this.ye=new oi(Sr)}return t.prototype.pe=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof ls?this.ve(r,t.ie):t.ie instanceof ps&&this.be(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.be(o[i],t.key,t.ie)},t.prototype.Se=function(t){var e=this;this.De(t,function(n){var r=e.Ce(n);switch(t.state){case 0:e.Ne(n)&&r.fe(t.resumeToken);break;case 1:r.me(),r.le||r.we(),r.fe(t.resumeToken);break;case 2:r.me(),r.le||e.removeTarget(n);break;case 3:e.Ne(n)&&(r.Ae(),r.fe(t.resumeToken));break;case 4:e.Ne(n)&&(e.xe(n),r.fe(t.resumeToken));break;default:wr()}})},t.prototype.De=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.Pe.forEach(function(t,r){n.Ne(r)&&e(r)})},t.prototype.Fe=function(t){var e=t.targetId,n=t.re.count,r=this.Oe(e);if(r){var i=r.target;if(Qr(i))if(0===n){var o=new jr(i.path);this.be(e,o,new ps(o,Lr.min()))}else _r(1===n);else this.Me(e)!==n&&(this.xe(e),this.ye=this.ye.add(e))}},t.prototype.ke=function(t){var e=this,n=new Map;this.Pe.forEach(function(r,i){var o=e.Oe(i);if(o){if(r.Zt&&Qr(o.target)){var s=new jr(o.target.path);null!==e.ge.get(s)||e.$e(i,s)||e.be(i,s,new ps(s,t))}r._e&&(n.set(i,r.de()),r.we())}});var r=di();this.Ve.forEach(function(t,n){var i=!0;n.xt(function(t){var n=e.Oe(t);return!n||2===n.tt||(i=!1,!1)}),i&&(r=r.add(t))});var i=new wi(t,n,this.ye,this.ge,r);return this.ge=ui(),this.Ve=Ni(),this.ye=new oi(Sr),i},t.prototype.ve=function(t,e){if(this.Ne(t)){var n=this.$e(t,e.key)?2:0;this.Ce(t).Te(e.key,n),this.ge=this.ge.rt(e.key,e),this.Ve=this.Ve.rt(e.key,this.Le(e.key).add(t))}},t.prototype.be=function(t,e,n){if(this.Ne(t)){var r=this.Ce(t);this.$e(t,e)?r.Te(e,1):r.Ee(e),this.Ve=this.Ve.rt(e,this.Le(e).delete(t)),n&&(this.ge=this.ge.rt(e,n))}},t.prototype.removeTarget=function(t){this.Pe.delete(t)},t.prototype.Me=function(t){var e=this.Ce(t).de();return this.Re.Be(t).size+e.te.size-e.ne.size},t.prototype.Ie=function(t){this.Ce(t).Ie()},t.prototype.Ce=function(t){var e=this.Pe.get(t);return e||(e=new Si,this.Pe.set(t,e)),e},t.prototype.Le=function(t){var e=this.Ve.get(t);return e||(e=new oi(Sr),this.Ve=this.Ve.rt(t,e)),e},t.prototype.Ne=function(t){var e=null!==this.Oe(t);return e||gr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.Oe=function(t){var e=this.Pe.get(t);return e&&e.le?null:this.Re.qe(t)},t.prototype.xe=function(t){var e=this;this.Pe.set(t,new Si),this.Re.Be(t).forEach(function(n){e.be(t,n,null)})},t.prototype.$e=function(t,e){return this.Re.Be(t).has(e)},t}();function Ni(){return new ni(jr.V)}function ki(){return new ni(jr.V)}function xi(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Oi(t){var e=t.mapValue.fields.__previous_value__;return xi(e)?Oi(e):e}function Ci(t){var e=ji(t.mapValue.fields.__local_write_time__.timestampValue);return new Mr(e.seconds,e.nanos)}var Di=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Pi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?xi(t)?4:10:wr()}function Mi(t,e){var n=Pi(t);if(n!==Pi(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ci(t).isEqual(Ci(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=ji(t.timestampValue),r=ji(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Bi(t.bytesValue).isEqual(Bi(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return qi(t.geoPointValue.latitude)===qi(e.geoPointValue.latitude)&&qi(t.geoPointValue.longitude)===qi(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return qi(t.integerValue)===qi(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=qi(t.doubleValue),r=qi(e.doubleValue);return n===r?Br(n)===Br(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Ar(t.arrayValue.values||[],e.arrayValue.values||[],Mi);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(kr(n)!==kr(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Mi(n[i],r[i])))return!1;return!0}(t,e);default:return wr()}}function Li(t,e){return void 0!==(t.values||[]).find(function(t){return Mi(t,e)})}function Ri(t,e){var n=Pi(t),r=Pi(e);if(n!==r)return Sr(n,r);switch(n){case 0:return 0;case 1:return Sr(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=qi(t.integerValue||t.doubleValue),r=qi(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Vi(t.timestampValue,e.timestampValue);case 4:return Vi(Ci(t),Ci(e));case 5:return Sr(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Bi(t),r=Bi(e);return n.A(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Sr(n[i],r[i]);if(0!==o)return o}return Sr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Sr(qi(t.latitude),qi(e.latitude));return 0!==n?n:Sr(qi(t.longitude),qi(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Ri(n[i],r[i]);if(o)return o}return Sr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=Sr(r[s],o[s]);if(0!==a)return a;var u=Ri(n[r[s]],i[o[s]]);if(0!==u)return u}return Sr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw wr()}}function Vi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Sr(t,e);var n=ji(t),r=ji(e),i=Sr(n.seconds,r.seconds);return 0!==i?i:Sr(n.nanos,r.nanos)}function Fi(t){return Ui(t)}function Ui(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=ji(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Bi(t.bytesValue).toBase64():"referenceValue"in t?jr.W(t.referenceValue).toString():"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Ui(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Ui(t.fields[o])}return e+"}"}(t.mapValue):wr();var e}function ji(t){if(_r(!!t),"string"==typeof t){var e=0,n=Di.exec(t);if(_r(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:qi(t.seconds),nanos:qi(t.nanos)}}function qi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Bi(t){return"string"==typeof t?Yr.fromBase64String(t):Yr.fromUint8Array(t)}function Gi(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.M()}}function Ki(t){return!!t&&"integerValue"in t}function zi(t){return!!t&&"arrayValue"in t}function Wi(t){return!!t&&"nullValue"in t}function Hi(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Qi(t){return!!t&&"mapValue"in t}var Yi={asc:"ASCENDING",desc:"DESCENDING"},$i={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ji=function(t,e){this.t=t,this.Ue=e};function Xi(t){return{integerValue:""+t}}function Zi(t,e){if(t.Ue){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Br(e)?"-0":e}}function to(t,e){return Gr(e)?Xi(e):Zi(t,e)}function eo(t,e){return t.Ue?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function no(t,e){return t.Ue?e.toBase64():e.toUint8Array()}function ro(t,e){return eo(t,e.P())}function io(t){return _r(!!t),Lr.m(function(t){var e=ji(t);return new Mr(e.seconds,e.nanos)}(t))}function oo(t,e){return function(t){return new Vr(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).M()}function so(t){var e=Vr.k(t);return _r(Oo(e)),e}function ao(t,e){return oo(t.t,e.path)}function uo(t,e){var n=so(e);if(n.get(1)!==t.t.projectId)throw new Pr(Dr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.t.projectId);if(n.get(3)!==t.t.database)throw new Pr(Dr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.t.database);return new jr(lo(n))}function co(t,e){return oo(t.t,e)}function ho(t){var e=so(t);return 4===e.length?Vr.$():lo(e)}function fo(t){return new Vr(["projects",t.t.projectId,"databases",t.t.database]).M()}function lo(t){return _r(t.length>4&&"documents"===t.get(4)),t.v(5)}function po(t,e,n){return{name:ao(t,e),fields:n.proto.mapValue.fields}}function vo(t,e){var n;if(e instanceof ts)n={update:po(t,e.key,e.value)};else if(e instanceof ss)n={delete:ao(t,e.key)};else if(e instanceof es)n={update:po(t,e.key,e.data),updateMask:xo(e.Qe)};else if(e instanceof rs)n={transform:{document:ao(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof Lo)return{fieldPath:e.field.M(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ro)return{fieldPath:e.field.M(),appendMissingElements:{values:n.elements}};if(n instanceof Fo)return{fieldPath:e.field.M(),removeAllFromArray:{values:n.elements}};if(n instanceof jo)return{fieldPath:e.field.M(),increment:n.Ke};throw wr()}(0,t)})}};else{if(!(e instanceof as))return wr();n={verify:ao(t,e.key)}}return e.je.We||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:ro(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:wr()}(t,e.je)),n}function go(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Wo.updateTime(io(t.updateTime)):void 0!==t.exists?Wo.exists(t.exists):Wo.Ge()}(e.currentDocument):Wo.Ge();if(e.update){var r=uo(t,e.update.name),i=new us({mapValue:{fields:e.update.fields}});if(e.updateMask){var o=function(t){return new Go((t.fieldPaths||[]).map(function(t){return Ur.U(t)}))}(e.updateMask);return new es(r,i,o,n)}return new ts(r,i,n)}if(e.delete){var s=uo(t,e.delete);return new ss(s,n)}if(e.transform){var a=uo(t,e.transform.document),u=e.transform.fieldTransforms.map(function(e){return function(t,e){var n=null;"setToServerValue"in e?(_r("REQUEST_TIME"===e.setToServerValue),n=new Lo):"appendMissingElements"in e?n=new Ro(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new Fo(e.removeAllFromArray.values||[]):"increment"in e?n=new jo(t,e.increment):wr();var r=Ur.U(e.fieldPath);return new Ko(r,n)}(t,e)});return _r(!0===n.exists),new rs(a,u)}if(e.verify){var c=uo(t,e.verify);return new as(c,n)}return wr()}function yo(t,e){return{documents:[co(t,e.path)]}}function mo(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=co(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=co(t,r.S()),n.structuredQuery.from=[{collectionId:r.C()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(Hi(t.value))return{unaryFilter:{field:So(t.field),op:"IS_NAN"}};if(Wi(t.value))return{unaryFilter:{field:So(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Hi(t.value))return{unaryFilter:{field:So(t.field),op:"IS_NOT_NAN"}};if(Wi(t.value))return{unaryFilter:{field:So(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:So(t.field),op:To(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:So(t.field),direction:Eo(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.Ue||qr(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=_o(e.startAt)),e.endAt&&(n.structuredQuery.endAt=_o(e.endAt)),n}function bo(t){var e=ho(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){_r(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=wo(n.where));var a=[];n.orderBy&&(a=n.orderBy.map(function(t){return function(t){return new Ws(Ao(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var u=null;n.limit&&(u=function(t){var e;return qr(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Io(n.startAt));var h=null;return n.endAt&&(h=Io(n.endAt)),gs(e,i,a,s,u,"F",c,h)}function wo(t){return t?void 0!==t.unaryFilter?[ko(t)]:void 0!==t.fieldFilter?[No(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return wo(t)}).reduce(function(t,e){return t.concat(e)}):wr():[]}function _o(t){return{before:t.before,values:t.position}}function Io(t){return new Bs(t.values||[],!!t.before)}function Eo(t){return Yi[t]}function To(t){return $i[t]}function So(t){return{fieldPath:t.M()}}function Ao(t){return Ur.U(t.fieldPath)}function No(t){return Ps.create(Ao(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return wr()}}(t.fieldFilter.op),t.fieldFilter.value)}function ko(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Ao(t.unaryFilter.field);return Ps.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Ao(t.unaryFilter.field);return Ps.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Ao(t.unaryFilter.field);return Ps.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Ao(t.unaryFilter.field);return Ps.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return wr()}}function xo(t){var e=[];return t.fields.forEach(function(t){return e.push(t.M())}),{fieldPaths:e}}function Oo(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var Co=function(){this.ze=void 0};function Do(t,e,n){return t instanceof Lo?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Ro?Vo(t,e):t instanceof Fo?Uo(t,e):function(t,e){var n=Mo(t,e),r=qo(n)+qo(t.Ke);return Ki(n)&&Ki(t.Ke)?Xi(r):Zi(t.serializer,r)}(t,e)}function Po(t,e,n){return t instanceof Ro?Vo(t,e):t instanceof Fo?Uo(t,e):n}function Mo(t,e){return t instanceof jo?Ki(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Lo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(Co),Ro=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return i(e,t),e}(Co);function Vo(t,e){for(var n=Bo(e),r=function(t){n.some(function(e){return Mi(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Fo=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return i(e,t),e}(Co);function Uo(t,e){for(var n=Bo(e),r=function(t){n=n.filter(function(e){return!Mi(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var jo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).serializer=e,r.Ke=n,r}return i(e,t),e}(Co);function qo(t){return qi(t.integerValue||t.doubleValue)}function Bo(t){return zi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Go=function(){function t(t){this.fields=t,t.sort(Ur.V)}return t.prototype.He=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].N(t))return!0;return!1},t.prototype.isEqual=function(t){return Ar(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),Ko=function(t,e){this.field=t,this.transform=e},zo=function(t,e){this.version=t,this.transformResults=e},Wo=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.Ge=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"We",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Ho(t,e){return void 0!==t.updateTime?e instanceof ls&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof ls}var Qo=function(){};function Yo(t,e,n){return t instanceof ts?function(t,e,n){return new ls(t.key,n.version,t.value,{hasCommittedMutations:!0})}(t,0,n):t instanceof es?function(t,e,n){if(!Ho(t.je,e))return new ds(t.key,n.version);var r=ns(t,e);return new ls(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof rs?function(t,e,n){if(_r(null!=n.transformResults),!Ho(t.je,e))return new ds(t.key,n.version);var r=is(0,e),i=function(t,e,n){var r=[];_r(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=null;e instanceof ls&&(a=e.field(o.field)),r.push(Po(s,a,n[i]))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=os(t,r.data(),i);return new ls(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new ps(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function $o(t,e,n,r){return t instanceof ts?function(t,e){if(!Ho(t.je,e))return e;var n=Zo(e);return new ls(t.key,n,t.value,{Je:!0})}(t,e):t instanceof es?function(t,e){if(!Ho(t.je,e))return e;var n=Zo(e),r=ns(t,e);return new ls(t.key,n,r,{Je:!0})}(t,e):t instanceof rs?function(t,e,n,r){if(!Ho(t.je,e))return e;var i=is(0,e),o=function(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var a=s[o],u=a.transform,c=null;n instanceof ls&&(c=n.field(a.field)),null===c&&r instanceof ls&&(c=r.field(a.field)),i.push(Do(u,c,e))}return i}(t.fieldTransforms,n,e,r),s=os(t,i.data(),o);return new ls(t.key,i.version,s,{Je:!0})}(t,e,r,n):function(t,e){return Ho(t.je,e)?new ps(t.key,Lr.min()):e}(t,e)}function Jo(t,e){return t instanceof rs?function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e instanceof ls?e.field(o.field):void 0,a=Mo(o.transform,s||null);null!=a&&(n=null==n?(new cs).set(o.field,a):n.set(o.field,a))}return n?n.Ye():null}(t,e):null}function Xo(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.je.isEqual(e.je)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||Ar(t.fieldTransforms,t.fieldTransforms,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Ro&&e instanceof Ro||t instanceof Fo&&e instanceof Fo?Ar(t.elements,e.elements,Mi):t instanceof jo&&e instanceof jo?Mi(t.Ke,e.Ke):t instanceof Lo&&e instanceof Lo}(t.transform,e.transform)}(t,e)}))}function Zo(t){return t instanceof ls?t.version:Lr.min()}var ts=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.je=r,i.type=0,i}return i(e,t),e}(Qo),es=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.Qe=r,o.je=i,o.type=1,o}return i(e,t),e}(Qo);function ns(t,e){return function(t,e){var n=new cs(e);return t.Qe.fields.forEach(function(e){if(!e.T()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}}),n.Ye()}(t,e instanceof ls?e.data():us.empty())}var rs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.je=Wo.exists(!0),r}return i(e,t),e}(Qo);function is(t,e){return e}function os(t,e,n){for(var r=new cs(e),i=0;i<t.fieldTransforms.length;i++)r.set(t.fieldTransforms[i].field,n[i]);return r.Ye()}var ss=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.je=n,r.type=3,r}return i(e,t),e}(Qo),as=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.je=n,r.type=4,r}return i(e,t),e}(Qo),us=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.T())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Qi(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.C()])||null},t.prototype.isEqual=function(t){return Mi(this.proto,t.proto)},t}(),cs=function(){function t(t){void 0===t&&(t=us.empty()),this.Xe=t,this.Ze=new Map}return t.prototype.set=function(t,e){return this.tn(t,e),this},t.prototype.delete=function(t){return this.tn(t,null),this},t.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===Pi(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.C(),e)},t.prototype.Ye=function(){var t=this.en(Ur.$(),this.Ze);return null!=t?new us(t):this.Xe},t.prototype.en=function(t,e){var n=this,r=!1,i=this.Xe.field(t),o=Qi(i)?Object.assign({},i.mapValue.fields):{};return e.forEach(function(e,i){if(e instanceof Map){var s=n.en(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)}),r?{mapValue:{fields:o}}:null},t}();function hs(t){var e=[];return xr(t.fields||{},function(t,n){var r=new Ur([t]);if(Qi(n)){var i=hs(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)}),new Go(e)}var fs=function(t,e){this.key=t,this.version=e},ls=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).nn=r,o.Je=!!i.Je,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return i(e,t),e.prototype.field=function(t){return this.nn.field(t)},e.prototype.data=function(){return this.nn},e.prototype.sn=function(){return this.nn.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Je===t.Je&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Je+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.Je||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(fs),ps=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return i(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(fs),ds=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(fs),vs=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.on=null,this.an=null};function gs(t,e,n,r,i,o,s,a){return new vs(t,e,n,r,i,o,s,a)}function ys(t){return new vs(t)}function ms(t){return!qr(t.limit)&&"F"===t.limitType}function bs(t){return!qr(t.limit)&&"L"===t.limitType}function ws(t){return t.rn.length>0?t.rn[0].field:null}function _s(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.cn())return r.field}return null}function Is(t){return null!==t.collectionGroup}function Es(t){var e=Ir(t);if(null===e.on){e.on=[];var n=_s(e),r=ws(e);if(null!==n&&null===r)n.B()||e.on.push(new Ws(n)),e.on.push(new Ws(Ur.q(),"asc"));else{for(var i=!1,o=0,s=e.rn;o<s.length;o++){var a=s[o];e.on.push(a),a.field.B()&&(i=!0)}if(!i){var u=e.rn.length>0?e.rn[e.rn.length-1].dir:"asc";e.on.push(new Ws(Ur.q(),u))}}}return e.on}function Ts(t){var e=Ir(t);if(!e.an)if("F"===e.limitType)e.an=zr(e.path,e.collectionGroup,Es(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Es(e);r<i.length;r++){var o=i[r];n.push(new Ws(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new Bs(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Bs(e.startAt.position,!e.startAt.before):null;e.an=zr(e.path,e.collectionGroup,n,e.filters,e.limit,s,a)}return e.an}function Ss(t,e,n){return new vs(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function As(t,e){return new vs(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}function Ns(t,e){return new vs(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}function ks(t,e){return Hr(Ts(t),Ts(e))&&t.limitType===e.limitType}function xs(t){return Wr(Ts(t))+"|lt:"+t.limitType}function Os(t){return"Query(target="+function(t){var e=t.path.M();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.M()+" "+e.op+" "+Fi(e.value);var e}).join(", ")+"]"),qr(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return(e=t).field.M()+" ("+e.dir+")";var e}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Gs(t.startAt)),t.endAt&&(e+=", endAt: "+Gs(t.endAt)),"Target("+e+")"}(Ts(t))+"; limitType="+t.limitType+")"}function Cs(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.j(t.collectionGroup)&&t.path.N(n):jr.G(t.path)?t.path.isEqual(n):t.path.F(n)}(t,e)&&function(t,e){for(var n=0,r=t.rn;n<r.length;n++){var i=r[n];if(!i.field.B()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Ks(t.startAt,Es(t),e)||t.endAt&&Ks(t.endAt,Es(t),e))}(t,e)}function Ds(t){return function(e,n){for(var r=!1,i=0,o=Es(t);i<o.length;i++){var s=o[i],a=Hs(s,e,n);if(0!==a)return a;r=r||s.field.B()}return 0}}var Ps=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return i(e,t),e.create=function(t,n,r){return t.B()?"in"===n||"not-in"===n?this.un(t,n,r):new Ms(t,n,r):"array-contains"===n?new Fs(t,r):"in"===n?new Us(t,r):"not-in"===n?new js(t,r):"array-contains-any"===n?new qs(t,r):new e(t,n,r)},e.un=function(t,e,n){return"in"===e?new Ls(t,n):new Rs(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.hn(Ri(e,this.value)):null!==e&&Pi(this.value)===Pi(e)&&this.hn(Ri(e,this.value))},e.prototype.hn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return wr()}},e.prototype.cn=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),Ms=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=jr.W(r.referenceValue),i}return i(e,t),e.prototype.matches=function(t){var e=jr.V(t.key,this.key);return this.hn(e)},e}(Ps),Ls=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Vs(0,n),r}return i(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(Ps),Rs=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Vs(0,n),r}return i(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(Ps);function Vs(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return jr.W(t.referenceValue)})}var Fs=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return i(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return zi(e)&&Li(e.arrayValue,this.value)},e}(Ps),Us=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return i(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Li(this.value.arrayValue,e)},e}(Ps),js=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return i(e,t),e.prototype.matches=function(t){if(Li(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!Li(this.value.arrayValue,e)},e}(Ps),qs=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return i(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!zi(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Li(e.value.arrayValue,t)})},e}(Ps),Bs=function(t,e){this.position=t,this.before=e};function Gs(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return Fi(t)}).join(",")}function Ks(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.B()?jr.V(jr.W(s.referenceValue),n.key):Ri(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function zs(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Mi(t.position[n],e.position[n]))return!1;return!0}var Ws=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Hs(t,e,n){var r=t.field.B()?jr.V(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?Ri(r,i):wr()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return wr()}}function Qs(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var Ys=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},$s=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.ln=t,this._n=e,this.fn=n,this.dn=r,this.wn=i,this.Tn=0,this.En=null,this.In=Date.now(),this.reset()}return t.prototype.reset=function(){this.Tn=0},t.prototype.mn=function(){this.Tn=this.wn},t.prototype.An=function(t){var e=this;this.cancel();var n=Math.floor(this.Tn+this.Rn()),r=Math.max(0,Date.now()-this.In),i=Math.max(0,n-r);i>0&&gr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Tn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.En=this.ln.Pn(this._n,i,function(){return e.In=Date.now(),t()}),this.Tn*=this.dn,this.Tn<this.fn&&(this.Tn=this.fn),this.Tn>this.wn&&(this.Tn=this.wn)},t.prototype.gn=function(){null!==this.En&&(this.En.Vn(),this.En=null)},t.prototype.cancel=function(){null!==this.En&&(this.En.cancel(),this.En=null)},t.prototype.Rn=function(){return(Math.random()-.5)*this.Tn},t}(),Js=function(){function t(t){var e=this;this.yn=null,this.pn=null,this.result=void 0,this.error=void 0,this.vn=!1,this.bn=!1,t(function(t){e.vn=!0,e.result=t,e.yn&&e.yn(t)},function(t){e.vn=!0,e.error=t,e.pn&&e.pn(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.bn&&wr(),this.bn=!0,this.vn?this.error?this.Sn(n,this.error):this.Dn(e,this.result):new t(function(t,i){r.yn=function(n){r.Dn(e,n).next(t,i)},r.pn=function(e){r.Sn(n,e).next(t,i)}})},t.prototype.Cn=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.Nn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.Dn=function(e,n){return e?this.Nn(function(){return e(n)}):t.resolve(n)},t.prototype.Sn=function(e,n){return e?this.Nn(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.xn=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.Fn=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.xn(r)},t}(),Xs=function(){function t(e,n,r){this.name=e,this.version=n,this.On=r,12.2===t.Mn((0,h.z$)())&&yr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return gr("SimpleDb","Removing database:",t),ia(window.indexedDB.deleteDatabase(t)).Cn()},t.kn=function(){if("undefined"==typeof indexedDB)return!1;if(t.$n())return!0;var e=(0,h.z$)(),n=t.Mn(e),r=0<n&&n<10,i=t.Ln(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.$n=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Bn)},t.qn=function(t,e){return t.store(e)},t.Mn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Ln=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Un=function(t){return o(this,void 0,void 0,function(){var e,n=this;return s(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(gr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new ta(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new Pr(Dr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new ta(t,n))},i.onupgradeneeded=function(t){gr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.On.createOrUpgrade(t.target.result,i.transaction,t.oldVersion,n.version).next(function(){gr("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Qn&&(this.db.onversionchange=function(t){return n.Qn(t)}),this.db)]}})})},t.prototype.Kn=function(t){this.Qn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return o(this,void 0,void 0,function(){var i,o,a,u,c;return s(this,function(h){switch(h.label){case 0:i="readonly"===e,o=0,a=function(){var e,a,c,h,f;return s(this,function(s){switch(s.label){case 0:++o,s.label=1;case 1:return s.trys.push([1,4,,5]),[4,u.Un(t)];case 2:return u.db=s.sent(),e=na.open(u.db,t,i?"readonly":"readwrite",n),a=r(e).catch(function(t){return e.abort(t),Js.reject(t)}).Cn(),c={},a.catch(function(){}),[4,e.Wn];case 3:return[2,(c.value=(s.sent(),a),c)];case 4:return gr("SimpleDb","Transaction failed with error:",(h=s.sent()).message,"Retrying:",f="FirebaseError"!==h.name&&o<3),u.close(),f?[3,5]:[2,{value:Promise.reject(h)}];case 5:return[2]}})},u=this,h.label=1;case 1:return[5,a()];case 2:if("object"==typeof(c=h.sent()))return[2,c.value];h.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Zs=function(){function t(t){this.jn=t,this.Gn=!1,this.zn=null}return Object.defineProperty(t.prototype,"vn",{get:function(){return this.Gn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Hn",{get:function(){return this.zn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.jn=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Gn=!0},t.prototype.Jn=function(t){this.zn=t},t.prototype.delete=function(){return ia(this.jn.delete())},t}(),ta=function(t){function e(e,n){var r=this;return(r=t.call(this,Dr.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return i(e,t),e}(Pr);function ea(t){return"IndexedDbTransactionError"===t.name}var na=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.Yn=new Ys,this.transaction.oncomplete=function(){n.Yn.resolve()},this.transaction.onabort=function(){e.error?n.Yn.reject(new ta(t,e.error)):n.Yn.resolve()},this.transaction.onerror=function(e){var r=sa(e.target.error);n.Yn.reject(new ta(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new ta(n,e)}},Object.defineProperty(t.prototype,"Wn",{get:function(){return this.Yn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.Yn.reject(t),this.aborted||(gr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new ra(e)},t}(),ra=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(gr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(gr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),ia(n)},t.prototype.add=function(t){return gr("SimpleDb","ADD",this.store.name,t,t),ia(this.store.add(t))},t.prototype.get=function(t){var e=this;return ia(this.store.get(t)).next(function(n){return void 0===n&&(n=null),gr("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return gr("SimpleDb","DELETE",this.store.name,t),ia(this.store.delete(t))},t.prototype.count=function(){return gr("SimpleDb","COUNT",this.store.name),ia(this.store.count())},t.prototype.Xn=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.Zn(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.ts=function(t,e){gr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.es=!1;var r=this.cursor(n);return this.Zn(r,function(t,e,n){return n.delete()})},t.prototype.ns=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.Zn(r,e)},t.prototype.ss=function(t){var e=this.cursor({});return new Js(function(n,r){e.onerror=function(t){var e=sa(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.Zn=function(t,e){var n=[];return new Js(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Zs(i),s=e(i.primaryKey,i.value,o);if(s instanceof Js){var a=s.catch(function(t){return o.done(),Js.reject(t)});n.push(a)}o.vn?r():null===o.Hn?i.continue():i.continue(o.Hn)}else r()}}).next(function(){return Js.xn(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.es?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function ia(t){return new Js(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=sa(t.target.error);n(e)}})}var oa=!1;function sa(t){var e=Xs.Mn((0,h.z$)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Pr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return oa||(oa=!0,setTimeout(function(){throw r},0)),r}}return t}function aa(){return"undefined"!=typeof window?window:null}function ua(){return"undefined"!=typeof document?document:null}var ca=function(){function t(t,e,n,r,i){this.rs=t,this._n=e,this.os=n,this.op=r,this.cs=i,this.us=new Ys,this.then=this.us.promise.then.bind(this.us.promise),this.us.promise.catch(function(t){})}return t.hs=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.ls=setTimeout(function(){return e._s()},t)},t.prototype.Vn=function(){return this._s()},t.prototype.cancel=function(t){null!==this.ls&&(this.clearTimeout(),this.us.reject(new Pr(Dr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype._s=function(){var t=this;this.rs.fs(function(){return null!==t.ls?(t.clearTimeout(),t.op().then(function(e){return t.us.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.ls&&(this.cs(this),clearTimeout(this.ls),this.ls=null)},t}(),ha=function(){function t(){var t=this;this.ds=Promise.resolve(),this.ws=[],this.Ts=!1,this.Es=[],this.Is=null,this.As=!1,this.Rs=[],this.Ps=new $s(this,"async_queue_retry"),this.gs=function(){var e=ua();e&&gr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Ps.gn()};var e=ua();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.gs)}return Object.defineProperty(t.prototype,"Vs",{get:function(){return this.Ts},enumerable:!1,configurable:!0}),t.prototype.fs=function(t){this.enqueue(t)},t.prototype.ys=function(t){this.ps(),this.vs(t)},t.prototype.bs=function(){if(!this.Ts){this.Ts=!0;var t=ua();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.gs)}},t.prototype.enqueue=function(t){return this.ps(),this.Ts?new Promise(function(t){}):this.vs(t)},t.prototype.Ss=function(t){var e=this;this.fs(function(){return e.ws.push(t),e.Ds()})},t.prototype.Ds=function(){return o(this,void 0,void 0,function(){var t,e=this;return s(this,function(n){switch(n.label){case 0:if(0===this.ws.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.ws[0]()];case 2:return n.sent(),this.ws.shift(),this.Ps.reset(),[3,4];case 3:if(!ea(t=n.sent()))throw t;return gr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.ws.length>0&&this.Ps.An(function(){return e.Ds()}),n.label=5;case 5:return[2]}})})},t.prototype.vs=function(t){var e=this,n=this.ds.then(function(){return e.As=!0,t().catch(function(t){throw e.Is=t,e.As=!1,yr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.As=!1,t})});return this.ds=n,n},t.prototype.Pn=function(t,e,n){var r=this;this.ps(),this.Rs.indexOf(t)>-1&&(e=0);var i=ca.hs(this,t,e,n,function(t){return r.Cs(t)});return this.Es.push(i),i},t.prototype.ps=function(){this.Is&&wr()},t.prototype.Ns=function(){},t.prototype.xs=function(){return o(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return[4,t=this.ds];case 1:e.sent(),e.label=2;case 2:if(t!==this.ds)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.Fs=function(t){for(var e=0,n=this.Es;e<n.length;e++)if(n[e]._n===t)return!0;return!1},t.prototype.Os=function(t){var e=this;return this.xs().then(function(){e.Es.sort(function(t,e){return t.os-e.os});for(var n=0,r=e.Es;n<r.length;n++){var i=r[n];if(i.Vn(),"all"!==t&&i._n===t)break}return e.xs()})},t.prototype.Ms=function(t){this.Rs.push(t)},t.prototype.Cs=function(t){var e=this.Es.indexOf(t);this.Es.splice(e,1)},t}();function fa(t,e){if(yr("AsyncQueue",e+": "+t),ea(t))return new Pr(Dr.UNAVAILABLE,e+": "+t);throw t}var la=function(){this.ks=void 0,this.listeners=[]},pa=function(){this.queries=new Cr(function(t){return xs(t)},ks),this.onlineState="Unknown",this.$s=new Set};function da(t,e){return o(this,void 0,void 0,function(){var n,r,i,o,a,u,c;return s(this,function(s){switch(s.label){case 0:if(n=Ir(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new la),!i)return[3,4];s.label=1;case 1:return s.trys.push([1,3,,4]),a=o,[4,n.Ls(r)];case 2:return a.ks=s.sent(),[3,4];case 3:return u=s.sent(),c=fa(u,"Initialization of query '"+Os(e.query)+"' failed"),[2,void e.onError(c)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.Bs(n.onlineState),o.ks&&e.qs(o.ks)&&ma(n),[2]}})})}function va(t,e){return o(this,void 0,void 0,function(){var n,r,i,o,a;return s(this,function(s){return n=Ir(t),i=!1,(o=n.queries.get(r=e.query))&&(a=o.listeners.indexOf(e))>=0&&(o.listeners.splice(a,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.Us(r))]:[2]})})}function ga(t,e){for(var n=Ir(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=n.queries.get(s.query);if(a){for(var u=0,c=a.listeners;u<c.length;u++)c[u].qs(s)&&(r=!0);a.ks=s}}r&&ma(n)}function ya(t,e,n){var r=Ir(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function ma(t){t.$s.forEach(function(t){t.next()})}var ba=function(){function t(t,e,n){this.query=t,this.Qs=e,this.Ks=!1,this.Ws=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new bi(t.query,t.docs,t.Ut,e,t.Qt,t.fromCache,t.Kt,!0)}var o=!1;return this.Ks?this.js(t)&&(this.Qs.next(t),o=!0):this.Gs(t,this.onlineState)&&(this.zs(t),o=!0),this.Ws=t,o},t.prototype.onError=function(t){this.Qs.error(t)},t.prototype.Bs=function(t){this.onlineState=t;var e=!1;return this.Ws&&!this.Ks&&this.Gs(this.Ws,t)&&(this.zs(this.Ws),e=!0),e},t.prototype.Gs=function(t,e){return!t.fromCache||!(this.options.Hs&&"Offline"!==e||t.docs.T()&&"Offline"!==e)},t.prototype.js=function(t){return t.docChanges.length>0||!!(t.Kt||this.Ws&&this.Ws.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.zs=function(t){t=bi.jt(t.query,t.docs,t.Qt,t.fromCache),this.Ks=!0,this.Qs.next(t)},t}(),wa=function(){function t(t){this.uid=t}return t.prototype.Js=function(){return null!=this.uid},t.prototype.Ys=function(){return this.Js()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();wa.UNAUTHENTICATED=new wa(null),wa.Xs=new wa("google-credentials-uid"),wa.Zs=new wa("first-party-uid");var _a=function(t,e){this.user=e,this.type="OAuth",this.ti={},this.ti.Authorization="Bearer "+t},Ia=function(){function t(){this.ei=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.ni=function(){},t.prototype.si=function(t){this.ei=t,t(wa.UNAUTHENTICATED)},t.prototype.ii=function(){this.ei=null},t}(),Ea=function(){function t(t){var e=this;this.ri=null,this.currentUser=wa.UNAUTHENTICATED,this.oi=!1,this.ai=0,this.ei=null,this.forceRefresh=!1,this.ri=function(){e.ai++,e.currentUser=e.ci(),e.oi=!0,e.ei&&e.ei(e.currentUser)},this.ai=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.ri):(this.ri(null),t.get().then(function(t){e.auth=t,e.ri&&e.auth.addAuthTokenListener(e.ri)},function(){}))}return t.prototype.getToken=function(){var t=this,e=this.ai,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.ai!==e?(gr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(_r("string"==typeof n.accessToken),new _a(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.ni=function(){this.forceRefresh=!0},t.prototype.si=function(t){this.ei=t,this.oi&&t(this.currentUser)},t.prototype.ii=function(){this.auth&&this.auth.removeAuthTokenListener(this.ri),this.ri=null,this.ei=null},t.prototype.ci=function(){var t=this.auth&&this.auth.getUid();return _r(null===t||"string"==typeof t),new wa(t)},t}(),Ta=function(){function t(t,e){this.ui=t,this.hi=e,this.type="FirstParty",this.user=wa.Zs}return Object.defineProperty(t.prototype,"ti",{get:function(){var t={"X-Goog-AuthUser":this.hi},e=this.ui.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Sa=function(){function t(t,e){this.ui=t,this.hi=e}return t.prototype.getToken=function(){return Promise.resolve(new Ta(this.ui,this.hi))},t.prototype.si=function(t){t(wa.Zs)},t.prototype.ii=function(){},t.prototype.ni=function(){},t}(),Aa=function(){function t(t,e,n,r){this.batchId=t,this.li=e,this.baseMutations=n,this.mutations=r}return t.prototype._i=function(t,e,n){for(var r=n.fi,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Yo(o,e,r[i]))}return e},t.prototype.di=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=$o(i,e,e,this.li))}for(var o=e,s=0,a=this.mutations;s<a.length;s++){var u=a[s];u.key.isEqual(t)&&(e=$o(u,e,o,this.li))}return e},t.prototype.wi=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.di(r.key,t.get(r.key));i&&(n=n.rt(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},di())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Ar(this.mutations,t.mutations,function(t,e){return Xo(t,e)})&&Ar(this.baseMutations,t.baseMutations,function(t,e){return Xo(t,e)})},t}(),Na=function(){function t(t,e,n,r){this.batch=t,this.Ti=e,this.fi=n,this.Ei=r}return t.from=function(e,n,r){_r(e.mutations.length===r.length);for(var i=li,o=e.mutations,s=0;s<o.length;s++)i=i.rt(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),ka=function(){function t(){this.Ii=new Cr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.mi=!1}return t.prototype.Ai=function(t){var e=this.Ii.get(t);return e?e.readTime:Lr.min()},t.prototype.Ri=function(t,e){this.Pi(),this.Ii.set(t.key,{gi:t,readTime:e})},t.prototype.Vi=function(t,e){void 0===e&&(e=null),this.Pi(),this.Ii.set(t,{gi:null,readTime:e})},t.prototype.yi=function(t,e){this.Pi();var n=this.Ii.get(e);return void 0!==n?Js.resolve(n.gi):this.pi(t,e)},t.prototype.getEntries=function(t,e){return this.vi(t,e)},t.prototype.apply=function(t){return this.Pi(),this.mi=!0,this.bi(t)},t.prototype.Pi=function(){},t}();function xa(t){return new Ji(t,!0)}function Oa(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Ca="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Da=function(){function t(){this.Si=[]}return t.prototype.Di=function(t){this.Si.push(t)},t.prototype.Ci=function(){this.Si.forEach(function(t){return t()})},t}(),Pa=function(){function t(t,e,n){this.Ni=t,this.xi=e,this.Fi=n}return t.prototype.Oi=function(t,e){var n=this;return this.xi.Mi(t,e).next(function(r){return n.ki(t,e,r)})},t.prototype.ki=function(t,e,n){return this.Ni.yi(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].di(e,t);return t})},t.prototype.$i=function(t,e,n){var r=ci();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].di(t,e);r=r.rt(t,e)}),r},t.prototype.Li=function(t,e){var n=this;return this.Ni.getEntries(t,e).next(function(e){return n.Bi(t,e)})},t.prototype.Bi=function(t,e){var n=this;return this.xi.qi(t,e).next(function(r){var i=n.$i(t,e,r),o=ui();return i.forEach(function(t,e){e||(e=new ps(t,Lr.min())),o=o.rt(t,e)}),o})},t.prototype.Ui=function(t,e,n){return function(t){return jr.G(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Qi(t,e.path):Is(e)?this.Ki(t,e,n):this.Wi(t,e,n)},t.prototype.Qi=function(t,e){return this.Oi(t,new jr(e)).next(function(t){var e=fi();return t instanceof ls&&(e=e.rt(t.key,t)),e})},t.prototype.Ki=function(t,e,n){var r=this,i=e.collectionGroup,o=fi();return this.Fi.ji(t,i).next(function(s){return Js.forEach(s,function(s){var a=function(t,e){return new vs(e,null,t.rn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.Wi(t,a,n).next(function(t){t.forEach(function(t,e){o=o.rt(t,e)})})}).next(function(){return o})})},t.prototype.Wi=function(t,e,n){var r,i,o=this;return this.Ni.Ui(t,e,n).next(function(n){return r=n,o.xi.Gi(t,e)}).next(function(e){return o.zi(t,i=e,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,h=r.get(c),f=$o(u,h,h,o.li);r=f instanceof ls?r.rt(c,f):r.remove(c)}})}).next(function(){return r.forEach(function(t,n){Cs(e,n)||(r=r.remove(t))}),r})},t.prototype.zi=function(t,e,n){for(var r=di(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof es&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ni.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof ls&&(c=c.rt(t,e))}),c})},t}(),Ma=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.Hi=n,this.Ji=r}return t.Yi=function(e,n){for(var r=di(),i=di(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),La=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.Xi=function(t){return n.Zi(t)},this.tr=function(t){return e.er(t)})}return t.prototype.Zi=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.tr&&this.tr(t),t},t}();function Ra(t,e){var n=t[1],r=e[1],i=Sr(t[0],e[0]);return 0===i?Sr(n,r):i}La.nr=-1;var Va=function(){function t(t){this.sr=t,this.buffer=new oi(Ra),this.ir=0}return t.prototype.rr=function(){return++this.ir},t.prototype.ar=function(t){var e=[t,this.rr()];if(this.buffer.size<this.sr)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Ra(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Fa={cr:!1,ur:0,hr:0,lr:0},Ua=function(){function t(t,e,n){this._r=t,this.dr=e,this.wr=n}return t.Tr=function(e){return new t(e,t.Er,t.Ir)},t}();Ua.Er=10,Ua.Ir=1e3,Ua.mr=new Ua(41943040,Ua.Er,Ua.Ir),Ua.Ar=new Ua(-1,0,0);var ja=function(){function t(t,e){this.Rr=t,this.rs=e,this.Pr=!1,this.gr=null}return t.prototype.start=function(t){-1!==this.Rr.params._r&&this.Vr(t)},t.prototype.stop=function(){this.gr&&(this.gr.cancel(),this.gr=null)},Object.defineProperty(t.prototype,"yr",{get:function(){return null!==this.gr},enumerable:!1,configurable:!0}),t.prototype.Vr=function(t){var e=this,n=this.Pr?3e5:6e4;gr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.gr=this.rs.Pn("lru_garbage_collection",n,function(){return o(e,void 0,void 0,function(){var e;return s(this,function(n){switch(n.label){case 0:this.gr=null,this.Pr=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.pr(this.Rr)];case 2:return n.sent(),[3,7];case 3:return ea(e=n.sent())?(gr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,pc(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.Vr(t)];case 8:return n.sent(),[2]}})})})},t}(),qa=function(){function t(t,e){this.vr=t,this.params=e}return t.prototype.br=function(t,e){return this.vr.Sr(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.Dr=function(t,e){var n=this;if(0===e)return Js.resolve(La.nr);var r=new Va(e);return this.vr.De(t,function(t){return r.ar(t.sequenceNumber)}).next(function(){return n.vr.Cr(t,function(t){return r.ar(t)})}).next(function(){return r.maxValue})},t.prototype.Nr=function(t,e,n){return this.vr.Nr(t,e,n)},t.prototype.Fr=function(t,e){return this.vr.Fr(t,e)},t.prototype.Or=function(t,e){var n=this;return-1===this.params._r?(gr("LruGarbageCollector","Garbage collection skipped; disabled"),Js.resolve(Fa)):this.Mr(t).next(function(r){return r<n.params._r?(gr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params._r),Fa):n.kr(t,e)})},t.prototype.Mr=function(t){return this.vr.Mr(t)},t.prototype.kr=function(t,e){var n,r,i,o,s,a,u,h=this,f=Date.now();return this.br(t,this.params.dr).next(function(e){return e>h.params.wr?(gr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.wr+" from "+e),r=h.params.wr):r=e,o=Date.now(),h.Dr(t,r)}).next(function(r){return n=r,s=Date.now(),h.Nr(t,n,e)}).next(function(e){return i=e,a=Date.now(),h.Fr(t,n)}).next(function(t){return u=Date.now(),vr()<=c.in.DEBUG&&gr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-f)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-f)+"ms"),Js.resolve({cr:!0,ur:r,hr:i,lr:t})})},t}();function Ba(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Ka(e)),e=Ga(t.get(n),e);return Ka(e)}function Ga(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function Ka(t){return t+"\x01\x01"}function za(t){var e=t.length;if(_r(e>=2),2===e)return _r("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),Vr.$();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&wr(),t.charAt(s+1)){case"\x01":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:wr()}o=s+2}return new Vr(r)}var Wa=function(t){this.$r=t};function Ha(t,e){if(e.document)return function(t,e,n){var r=uo(t,e.name),i=io(e.updateTime),o=new us({mapValue:{fields:e.fields}});return new ls(r,i,o,{hasCommittedMutations:!!n})}(t.$r,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=jr.H(e.noDocument.path),r=Xa(e.noDocument.readTime);return new ps(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=jr.H(e.unknownDocument.path),o=Xa(e.unknownDocument.version);return new ds(i,o)}return wr()}function Qa(t,e,n){var r=Ya(n),i=e.key.path.S().O();if(e instanceof ls){var o=function(t,e){return{name:ao(t,e.key),fields:e.sn().mapValue.fields,updateTime:eo(t,e.version.P())}}(t.$r,e);return new Su(null,null,o,e.hasCommittedMutations,r,i)}if(e instanceof ps){var s=e.key.path.O(),a=Ja(e.version),u=e.hasCommittedMutations;return new Su(null,new Eu(s,a),null,u,r,i)}if(e instanceof ds){var c=e.key.path.O(),h=Ja(e.version);return new Su(new Tu(c,h),null,null,!0,r,i)}return wr()}function Ya(t){var e=t.P();return[e.seconds,e.nanoseconds]}function $a(t){var e=new Mr(t[0],t[1]);return Lr.m(e)}function Ja(t){var e=t.P();return new mu(e.seconds,e.nanoseconds)}function Xa(t){var e=new Mr(t.seconds,t.nanoseconds);return Lr.m(e)}function Za(t,e){var n=(e.baseMutations||[]).map(function(e){return go(t.$r,e)}),r=e.mutations.map(function(e){return go(t.$r,e)}),i=Mr.fromMillis(e.localWriteTimeMs);return new Aa(e.batchId,i,n,r)}function tu(t){var e,n,r=Xa(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Xa(t.lastLimboFreeSnapshotVersion):Lr.min();return void 0!==t.query.documents?(_r(1===(n=t.query).documents.length),e=Ts(ys(ho(n.documents[0])))):e=function(t){return Ts(bo(t))}(t.query),new Xr(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Yr.fromBase64String(t.resumeToken))}function eu(t,e){var n,r=Ja(e.et),i=Ja(e.lastLimboFreeSnapshotVersion);n=Qr(e.target)?yo(t.$r,e.target):mo(t.$r,e.target);var o=e.resumeToken.toBase64();return new Nu(e.targetId,Wr(e.target),r,o,e.sequenceNumber,i,n)}function nu(t){var e=bo({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Ss(e,e.limit,"L"):e}var ru=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.Fi=n,this.Lr=r,this.Br={}}return t.qr=function(e,n,r,i){return _r(""!==e.uid),new t(e.Js()?e.uid:"",n,r,i)},t.prototype.Ur=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return su(t).ns({index:_u.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.Qr=function(t,e,n,r){var i=this,o=au(t),s=su(t);return s.add({}).next(function(a){_r("number"==typeof a);for(var u=new Aa(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return vo(t.$r,e)}),i=n.mutations.map(function(e){return vo(t.$r,e)});return new _u(e,n.batchId,n.li.toMillis(),r,i)}(i.serializer,i.userId,u),h=[],f=new oi(function(t,e){return Sr(t.M(),e.M())}),l=0,p=r;l<p.length;l++){var d=p[l],v=Iu.key(i.userId,d.key.path,a);f=f.add(d.key.path.S()),h.push(s.put(c)),h.push(o.put(v,Iu.PLACEHOLDER))}return f.forEach(function(e){h.push(i.Fi.Kr(t,e))}),t.Di(function(){i.Br[a]=u.keys()}),Js.xn(h).next(function(){return u})})},t.prototype.Wr=function(t,e){var n=this;return su(t).get(e).next(function(t){return t?(_r(t.userId===n.userId),Za(n.serializer,t)):null})},t.prototype.jr=function(t,e){var n=this;return this.Br[e]?Js.resolve(this.Br[e]):this.Wr(t,e).next(function(t){if(t){var r=t.keys();return n.Br[e]=r,r}return null})},t.prototype.Gr=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return su(t).ns({index:_u.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(_r(e.batchId>=r),o=Za(n.serializer,e)),i.done()}).next(function(){return o})},t.prototype.zr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return su(t).ns({index:_u.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.Hr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return su(t).Xn(_u.userMutationsIndex,n).next(function(t){return t.map(function(t){return Za(e.serializer,t)})})},t.prototype.Mi=function(t,e){var n=this,r=Iu.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return au(t).ns({range:i},function(r,i,s){var a=r[0],u=r[2],c=za(r[1]);if(a===n.userId&&e.path.isEqual(c))return su(t).get(u).next(function(t){if(!t)throw wr();_r(t.userId===n.userId),o.push(Za(n.serializer,t))});s.done()}).next(function(){return o})},t.prototype.qi=function(t,e){var n=this,r=new oi(Sr),i=[];return e.forEach(function(e){var o=Iu.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=au(t).ns({range:s},function(t,i,o){var s=t[0],a=t[2],u=za(t[1]);s===n.userId&&e.path.isEqual(u)?r=r.add(a):o.done()});i.push(a)}),Js.xn(i).next(function(){return n.Jr(t,r)})},t.prototype.Gi=function(t,e){var n=this,r=e.path,i=r.length+1,o=Iu.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new oi(Sr);return au(t).ns({range:s},function(t,e,o){var s=t[0],u=t[2],c=za(t[1]);s===n.userId&&r.N(c)?c.length===i&&(a=a.add(u)):o.done()}).next(function(){return n.Jr(t,a)})},t.prototype.Jr=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(su(t).get(e).next(function(t){if(null===t)throw wr();_r(t.userId===n.userId),r.push(Za(n.serializer,t))}))}),Js.xn(i).next(function(){return r})},t.prototype.Yr=function(t,e){var n=this;return ou(t.Xr,this.userId,e).next(function(r){return t.Di(function(){n.Zr(e.batchId)}),Js.forEach(r,function(e){return n.Lr.eo(t,e)})})},t.prototype.Zr=function(t){delete this.Br[t]},t.prototype.no=function(t){var e=this;return this.Ur(t).next(function(n){if(!n)return Js.resolve();var r=IDBKeyRange.lowerBound(Iu.prefixForUser(e.userId)),i=[];return au(t).ns({range:r},function(t,n,r){if(t[0]===e.userId){var o=za(t[1]);i.push(o)}else r.done()}).next(function(){_r(0===i.length)})})},t.prototype.so=function(t,e){return iu(t,this.userId,e)},t.prototype.io=function(t){var e=this;return uu(t).get(this.userId).next(function(t){return t||new wu(e.userId,-1,"")})},t}();function iu(t,e,n){var r=Iu.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return au(t).ns({range:o,es:!0},function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()}).next(function(){return s})}function ou(t,e,n){var r=t.store(_u.store),i=t.store(Iu.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.ns({range:s},function(t,e,n){return a++,n.delete()});o.push(u.next(function(){_r(1===a)}));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=Iu.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return Js.xn(o).next(function(){return c})}function su(t){return Qu.qn(t,_u.store)}function au(t){return Qu.qn(t,Iu.store)}function uu(t){return Qu.qn(t,wu.store)}var cu=function(){function t(t,e){this.serializer=t,this.Fi=e}return t.prototype.Ri=function(t,e,n){return lu(t).put(pu(e),n)},t.prototype.Vi=function(t,e){var n=lu(t),r=pu(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.ro(t,r)})},t.prototype.yi=function(t,e){var n=this;return lu(t).get(pu(e)).next(function(t){return n.oo(t)})},t.prototype.ao=function(t,e){var n=this;return lu(t).get(pu(e)).next(function(t){var e=n.oo(t);return e?{gi:e,size:du(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=ci();return this.co(t,e,function(t,e){var i=n.oo(e);r=r.rt(t,i)}).next(function(){return r})},t.prototype.uo=function(t,e){var n=this,r=ci(),i=new ni(jr.V);return this.co(t,e,function(t,e){var o=n.oo(e);o?(r=r.rt(t,o),i=i.rt(t,du(e))):(r=r.rt(t,null),i=i.rt(t,0))}).next(function(){return{ho:r,lo:i}})},t.prototype.co=function(t,e,n){if(e.T())return Js.resolve();var r=IDBKeyRange.bound(e.first().path.O(),e.last().path.O()),i=e.lt(),o=i.Et();return lu(t).ns({range:r},function(t,e,r){for(var s=jr.H(t);o&&jr.V(o,s)<0;)n(o,null),o=i.Et();o&&o.isEqual(s)&&(n(o,e),o=i.It()?i.Et():null),o?r.Jn(o.path.O()):r.done()}).next(function(){for(;o;)n(o,null),o=i.It()?i.Et():null})},t.prototype.Ui=function(t,e,n){var r=this,i=fi(),o=e.path.length+1,s={};if(n.isEqual(Lr.min())){var a=e.path.O();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.O(),c=Ya(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=Su.collectionReadTimeIndex}return lu(t).ns(s,function(t,n,s){if(t.length===o){var a=Ha(r.serializer,n);e.path.N(a.key.path)?a instanceof ls&&Cs(e,a)&&(i=i.rt(a.key,a)):s.done()}}).next(function(){return i})},t.prototype._o=function(t){return new hu(this,!!t&&t.fo)},t.prototype.wo=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return fu(t).get(Au.key).next(function(t){return _r(!!t),t})},t.prototype.ro=function(t,e){return fu(t).put(Au.key,e)},t.prototype.oo=function(t){if(t){var e=Ha(this.serializer,t);return e instanceof ps&&e.version.isEqual(Lr.min())?null:e}return null},t}(),hu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).To=e,r.fo=n,r.Eo=new Cr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return i(e,t),e.prototype.bi=function(t){var e=this,n=[],r=0,i=new oi(function(t,e){return Sr(t.M(),e.M())});return this.Ii.forEach(function(o,s){var a=e.Eo.get(o);if(s.gi){var u=Qa(e.To.serializer,s.gi,e.Ai(o));i=i.add(o.path.S());var c=du(u);r+=c-a,n.push(e.To.Ri(t,o,u))}else if(r-=a,e.fo){var h=Qa(e.To.serializer,new ps(o,Lr.min()),e.Ai(o));n.push(e.To.Ri(t,o,h))}else n.push(e.To.Vi(t,o))}),i.forEach(function(r){n.push(e.To.Fi.Kr(t,r))}),n.push(this.To.updateMetadata(t,r)),Js.xn(n)},e.prototype.pi=function(t,e){var n=this;return this.To.ao(t,e).next(function(t){return null===t?(n.Eo.set(e,0),null):(n.Eo.set(e,t.size),t.gi)})},e.prototype.vi=function(t,e){var n=this;return this.To.uo(t,e).next(function(t){var e=t.ho;return t.lo.forEach(function(t,e){n.Eo.set(t,e)}),e})},e}(ka);function fu(t){return Qu.qn(t,Au.store)}function lu(t){return Qu.qn(t,Su.store)}function pu(t){return t.path.O()}function du(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw wr();e=t.noDocument}return JSON.stringify(e).length}var vu=function(){function t(){this.Io=new gu}return t.prototype.Kr=function(t,e){return this.Io.add(e),Js.resolve()},t.prototype.ji=function(t,e){return Js.resolve(this.Io.getEntries(e))},t}(),gu=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.C(),n=t.S(),r=this.index[e]||new oi(Vr.V),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.C(),n=t.S(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new oi(Vr.V)).O()},t}(),yu=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;_r(n<r&&n>=0&&r<=11);var o=new na("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(bu.store)}(t),function(t){t.createObjectStore(wu.store,{keyPath:wu.keyPath}),t.createObjectStore(_u.store,{keyPath:_u.keyPath,autoIncrement:!0}).createIndex(_u.userMutationsIndex,_u.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Iu.store)}(t),Cu(t),function(t){t.createObjectStore(Su.store)}(t));var s=Js.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(ku.store),t.deleteObjectStore(Nu.store),t.deleteObjectStore(xu.store)}(t),Cu(t)),s=s.next(function(){return function(t){var e=t.store(xu.store),n=new xu(0,0,Lr.min().P(),0);return e.put(xu.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(_u.store).Xn().next(function(n){t.deleteObjectStore(_u.store),t.createObjectStore(_u.store,{keyPath:_u.keyPath,autoIncrement:!0}).createIndex(_u.userMutationsIndex,_u.userMutationsKeyPath,{unique:!0});var r=e.store(_u.store),i=n.map(function(t){return r.put(t)});return Js.xn(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(Du.store,{keyPath:Du.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.removeAcknowledgedMutations(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(Au.store)}(t),i.addDocumentGlobal(o)})),n<7&&r>=7&&(s=s.next(function(){return i.ensureSequenceNumbers(o)})),n<8&&r>=8&&(s=s.next(function(){return i.createCollectionParentIndex(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Su.store);e.createIndex(Su.readTimeIndex,Su.readTimeIndexPath,{unique:!1}),e.createIndex(Su.collectionReadTimeIndex,Su.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.rewriteCanonicalIds(o)})),n<11&&r>=11&&(s=s.next(function(){!function(t){t.createObjectStore(Pu.store,{keyPath:Pu.keyPath})}(t),function(t){t.createObjectStore(Mu.store,{keyPath:Mu.keyPath})}(t)})),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(Su.store).ns(function(t,n){e+=du(n)}).next(function(){var n=new Au(e);return t.store(Au.store).put(Au.key,n)})},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(wu.store),r=t.store(_u.store);return n.Xn().next(function(n){return Js.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Xn(_u.userMutationsIndex,i).next(function(r){return Js.forEach(r,function(r){_r(r.userId===n.userId);var i=Za(e.serializer,r);return ou(t,n.userId,i).next(function(){})})})})})},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(ku.store),n=t.store(Su.store);return t.store(xu.store).get(xu.key).next(function(t){var r=[];return n.ns(function(n,i){var o=new Vr(n),s=function(t){return[0,Ba(t)]}(o);r.push(e.get(s).next(function(n){return n?Js.resolve():function(n){return e.put(new ku(0,Ba(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return Js.xn(r)})})},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Ou.store,{keyPath:Ou.keyPath});var n=e.store(Ou.store),r=new gu,i=function(t){if(r.add(t)){var e=t.C(),i=t.S();return n.put({collectionId:e,parent:Ba(i)})}};return e.store(Su.store).ns({es:!0},function(t,e){var n=new Vr(t);return i(n.S())}).next(function(){return e.store(Iu.store).ns({es:!0},function(t,e){var n=za(t[1]);return i(n.S())})})},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(Nu.store);return n.ns(function(t,r){var i=tu(r),o=eu(e.serializer,i);return n.put(o)})},t}(),mu=function(t,e){this.seconds=t,this.nanoseconds=e},bu=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};bu.store="owner",bu.key="owner";var wu=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};wu.store="mutationQueues",wu.keyPath="userId";var _u=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};_u.store="mutations",_u.keyPath="batchId",_u.userMutationsIndex="userMutationsIndex",_u.userMutationsKeyPath=["userId","batchId"];var Iu=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Ba(e)]},t.key=function(t,e,n){return[t,Ba(e),n]},t}();Iu.store="documentMutations",Iu.PLACEHOLDER=new Iu;var Eu=function(t,e){this.path=t,this.readTime=e},Tu=function(t,e){this.path=t,this.version=e},Su=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Su.store="remoteDocuments",Su.readTimeIndex="readTimeIndex",Su.readTimeIndexPath="readTime",Su.collectionReadTimeIndex="collectionReadTimeIndex",Su.collectionReadTimeIndexPath=["parentPath","readTime"];var Au=function(t){this.byteSize=t};Au.store="remoteDocumentGlobal",Au.key="remoteDocumentGlobalKey";var Nu=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Nu.store="targets",Nu.keyPath="targetId",Nu.queryTargetsIndexName="queryTargetsIndex",Nu.queryTargetsKeyPath=["canonicalId","targetId"];var ku=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};ku.store="targetDocuments",ku.keyPath=["targetId","path"],ku.documentTargetsIndex="documentTargetsIndex",ku.documentTargetsKeyPath=["path","targetId"];var xu=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};xu.key="targetGlobalKey",xu.store="targetGlobal";var Ou=function(t,e){this.collectionId=t,this.parent=e};function Cu(t){t.createObjectStore(ku.store,{keyPath:ku.keyPath}).createIndex(ku.documentTargetsIndex,ku.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Nu.store,{keyPath:Nu.keyPath}).createIndex(Nu.queryTargetsIndexName,Nu.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(xu.store)}Ou.store="collectionParents",Ou.keyPath=["collectionId","parent"];var Du=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Du.store="clientMetadata",Du.keyPath="clientId";var Pu=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Pu.store="bundles",Pu.keyPath="bundleId";var Mu=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Mu.store="namedQueries",Mu.keyPath="name";var Lu=a(a(a(a([wu.store,_u.store,Iu.store,Su.store,Nu.store,bu.store,xu.store,ku.store],[Du.store]),[Au.store]),[Ou.store]),[Pu.store,Mu.store]),Ru=function(){function t(t){this.serializer=t}return t.prototype.mo=function(t,e){return Vu(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:Xa(e.createTime),version:e.version};var e})},t.prototype.Ao=function(t,e){return Vu(t).put({bundleId:(n=e).id,createTime:Ja(io(n.createTime)),version:n.version});var n},t.prototype.Ro=function(t,e){return Fu(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:nu(e.bundledQuery),readTime:Xa(e.readTime)};var e})},t.prototype.Po=function(t,e){return Fu(t).put(function(t){return{name:t.name,readTime:Ja(io(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Vu(t){return Qu.qn(t,Pu.store)}function Fu(t){return Qu.qn(t,Mu.store)}var Uu=function(){function t(){this.Vo=new gu}return t.prototype.Kr=function(t,e){var n=this;if(!this.Vo.has(e)){var r=e.C(),i=e.S();t.Di(function(){n.Vo.add(e)});var o={collectionId:r,parent:Ba(i)};return ju(t).put(o)}return Js.resolve()},t.prototype.ji=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Nr(e),""],!1,!0);return ju(t).Xn(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(za(o.parent))}return n})},t}();function ju(t){return Qu.qn(t,Ou.store)}var qu=function(){function t(t){this.yo=t}return t.prototype.next=function(){return this.yo+=2,this.yo},t.po=function(){return new t(0)},t.vo=function(){return new t(-1)},t}(),Bu=function(){function t(t,e){this.Lr=t,this.serializer=e}return t.prototype.bo=function(t){var e=this;return this.So(t).next(function(n){var r=new qu(n.highestTargetId);return n.highestTargetId=r.next(),e.Do(t,n).next(function(){return n.highestTargetId})})},t.prototype.Co=function(t){return this.So(t).next(function(t){return Lr.m(new Mr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.No=function(t){return this.So(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.xo=function(t,e,n){var r=this;return this.So(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.P()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Do(t,i)})},t.prototype.Fo=function(t,e){var n=this;return this.Oo(t,e).next(function(){return n.So(t).next(function(r){return r.targetCount+=1,n.Mo(e,r),n.Do(t,r)})})},t.prototype.ko=function(t,e){return this.Oo(t,e)},t.prototype.$o=function(t,e){var n=this;return this.Lo(t,e.targetId).next(function(){return Gu(t).delete(e.targetId)}).next(function(){return n.So(t)}).next(function(e){return _r(e.targetCount>0),e.targetCount-=1,n.Do(t,e)})},t.prototype.Nr=function(t,e,n){var r=this,i=0,o=[];return Gu(t).ns(function(s,a){var u=tu(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.$o(t,u)))}).next(function(){return Js.xn(o)}).next(function(){return i})},t.prototype.De=function(t,e){return Gu(t).ns(function(t,n){var r=tu(n);e(r)})},t.prototype.So=function(t){return Ku(t).get(xu.key).next(function(t){return _r(null!==t),t})},t.prototype.Do=function(t,e){return Ku(t).put(xu.key,e)},t.prototype.Oo=function(t,e){return Gu(t).put(eu(this.serializer,e))},t.prototype.Mo=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.Bo=function(t){return this.So(t).next(function(t){return t.targetCount})},t.prototype.qo=function(t,e){var n=Wr(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Gu(t).ns({range:r,index:Nu.queryTargetsIndexName},function(t,n,r){var o=tu(n);Hr(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.Uo=function(t,e,n){var r=this,i=[],o=zu(t);return e.forEach(function(e){var s=Ba(e.path);i.push(o.put(new ku(n,s))),i.push(r.Lr.Qo(t,n,e))}),Js.xn(i)},t.prototype.Ko=function(t,e,n){var r=this,i=zu(t);return Js.forEach(e,function(e){var o=Ba(e.path);return Js.xn([i.delete([n,o]),r.Lr.Wo(t,n,e)])})},t.prototype.Lo=function(t,e){var n=zu(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.jo=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=zu(t),i=di();return r.ns({range:n,es:!0},function(t,e,n){var r=za(t[1]),o=new jr(r);i=i.add(o)}).next(function(){return i})},t.prototype.so=function(t,e){var n=Ba(e.path),r=IDBKeyRange.bound([n],[Nr(n)],!1,!0),i=0;return zu(t).ns({index:ku.documentTargetsIndex,es:!0,range:r},function(t,e,n){0!==t[0]&&(i++,n.done())}).next(function(){return i>0})},t.prototype.qe=function(t,e){return Gu(t).get(e).next(function(t){return t?tu(t):null})},t}();function Gu(t){return Qu.qn(t,Nu.store)}function Ku(t){return Qu.qn(t,xu.store)}function zu(t){return Qu.qn(t,ku.store)}var Wu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Hu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Xr=e,r.Go=n,r}return i(e,t),e}(Da),Qu=function(){function t(e,n,r,i,o,s,a,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ln=o,this.window=s,this.document=a,this.zo=c,this.Ho=h,this.Jo=null,this.Yo=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Xo=null,this.inForeground=!1,this.Zo=null,this.ta=null,this.ea=Number.NEGATIVE_INFINITY,this.na=function(t){return Promise.resolve()},!t.kn())throw new Pr(Dr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Lr=new Ju(this,i),this.sa=n+"main",this.serializer=new Wa(u),this.ia=new Xs(this.sa,11,new yu(this.serializer)),this.ra=new Bu(this.Lr,this.serializer),this.Fi=new Uu,this.Ni=function(t,e){return new cu(t,e)}(this.serializer,this.Fi),this.oa=new Ru(this.serializer),this.window&&this.window.localStorage?this.aa=this.window.localStorage:(this.aa=null,!1===h&&yr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.qn=function(t,e){if(t instanceof Hu)return Xs.qn(t.Xr,e);throw wr()},t.prototype.start=function(){var t=this;return this.ca().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Pr(Dr.FAILED_PRECONDITION,Wu);return t.ua(),t.ha(),t.la(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.ra.No(e)})}).then(function(e){t.Jo=new La(e,t.zo)}).then(function(){t.Yo=!0}).catch(function(e){return t.ia&&t.ia.close(),Promise.reject(e)})},t.prototype._a=function(t){var e=this;return this.na=function(n){return o(e,void 0,void 0,function(){return s(this,function(e){return this.yr?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.fa=function(t){var e=this;this.ia.Kn(function(n){return o(e,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.da=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.ln.fs(function(){return o(e,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this.yr?[4,this.ca()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.ca=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return $u(e).put(new Du(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.wa(e).next(function(e){e||(t.isPrimary=!1,t.ln.Ss(function(){return t.na(!1)}))})}).next(function(){return t.Ta(e)}).next(function(n){return t.isPrimary&&!n?t.Ea(e).next(function(){return!1}):!!n&&t.Ia(e).next(function(){return!0})})}).catch(function(e){if(ea(e))return gr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return gr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.ln.Ss(function(){return t.na(e)}),t.isPrimary=e})},t.prototype.wa=function(t){var e=this;return Yu(t).get(bu.key).next(function(t){return Js.resolve(e.ma(t))})},t.prototype.Aa=function(t){return $u(t).delete(this.clientId)},t.prototype.Ra=function(){return o(this,void 0,void 0,function(){var e,n,r,i=this;return s(this,function(o){switch(o.label){case 0:return!this.isPrimary||this.Pa(this.ea,18e5)?[3,2]:(this.ea=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(e){var n=t.qn(e,Du.store);return n.Xn().next(function(t){var e=i.ga(t,18e5),r=t.filter(function(t){return-1===e.indexOf(t)});return Js.forEach(r,function(t){return n.delete(t.clientId)}).next(function(){return r})})}).catch(function(){return[]})]);case 1:if(e=o.sent(),this.aa)for(n=0,r=e;n<r.length;n++)this.aa.removeItem(this.Va(r[n].clientId));o.label=2;case 2:return[2]}})})},t.prototype.la=function(){var t=this;this.ta=this.ln.Pn("client_metadata_refresh",4e3,function(){return t.ca().then(function(){return t.Ra()}).then(function(){return t.la()})})},t.prototype.ma=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ta=function(t){var e=this;return this.Ho?Js.resolve(!0):Yu(t).get(bu.key).next(function(n){if(null!==n&&e.Pa(n.leaseTimestampMs,5e3)&&!e.ya(n.ownerId)){if(e.ma(n)&&e.networkEnabled)return!0;if(!e.ma(n)){if(!n.allowTabSynchronization)throw new Pr(Dr.FAILED_PRECONDITION,Wu);return!1}}return!(!e.networkEnabled||!e.inForeground)||$u(t).Xn().next(function(t){return void 0===e.ga(t,5e3).find(function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))})})}).next(function(t){return e.isPrimary!==t&&gr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.pa=function(){return o(this,void 0,void 0,function(){var t=this;return s(this,function(e){switch(e.label){case 0:return this.Yo=!1,this.va(),this.ta&&(this.ta.cancel(),this.ta=null),this.ba(),this.Sa(),[4,this.ia.runTransaction("shutdown","readwrite",[bu.store,Du.store],function(e){var n=new Hu(e,La.nr);return t.Ea(n).next(function(){return t.Aa(n)})})];case 1:return e.sent(),this.ia.close(),this.Da(),[2]}})})},t.prototype.ga=function(t,e){var n=this;return t.filter(function(t){return n.Pa(t.updateTimeMs,e)&&!n.ya(t.clientId)})},t.prototype.Ca=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return $u(e).Xn().next(function(e){return t.ga(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"yr",{get:function(){return this.Yo},enumerable:!1,configurable:!0}),t.prototype.Na=function(t){return ru.qr(t,this.serializer,this.Fi,this.Lr)},t.prototype.xa=function(){return this.ra},t.prototype.Fa=function(){return this.Ni},t.prototype.Oa=function(){return this.Fi},t.prototype.Ma=function(){return this.oa},t.prototype.runTransaction=function(t,e,n){var r,i=this;return gr("IndexedDbPersistence","Starting transaction:",t),this.ia.runTransaction(t,"readonly"===e?"readonly":"readwrite",Lu,function(o){return r=new Hu(o,i.Jo?i.Jo.next():La.nr),"readwrite-primary"===e?i.wa(r).next(function(t){return!!t||i.Ta(r)}).next(function(e){if(!e)throw yr("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.ln.Ss(function(){return i.na(!1)}),new Pr(Dr.FAILED_PRECONDITION,Ca);return n(r)}).next(function(t){return i.Ia(r).next(function(){return t})}):i.ka(r).next(function(){return n(r)})}).then(function(t){return r.Ci(),t})},t.prototype.ka=function(t){var e=this;return Yu(t).get(bu.key).next(function(t){if(null!==t&&e.Pa(t.leaseTimestampMs,5e3)&&!e.ya(t.ownerId)&&!e.ma(t)&&!(e.Ho||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Pr(Dr.FAILED_PRECONDITION,Wu)})},t.prototype.Ia=function(t){var e=new bu(this.clientId,this.allowTabSynchronization,Date.now());return Yu(t).put(bu.key,e)},t.kn=function(){return Xs.kn()},t.prototype.Ea=function(t){var e=this,n=Yu(t);return n.get(bu.key).next(function(t){return e.ma(t)?(gr("IndexedDbPersistence","Releasing primary lease."),n.delete(bu.key)):Js.resolve()})},t.prototype.Pa=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(yr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.ua=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Zo=function(){t.ln.fs(function(){return t.inForeground="visible"===t.document.visibilityState,t.ca()})},this.document.addEventListener("visibilitychange",this.Zo),this.inForeground="visible"===this.document.visibilityState)},t.prototype.ba=function(){this.Zo&&(this.document.removeEventListener("visibilitychange",this.Zo),this.Zo=null)},t.prototype.ha=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Xo=function(){e.va(),e.ln.fs(function(){return e.pa()})},this.window.addEventListener("unload",this.Xo))},t.prototype.Sa=function(){this.Xo&&(this.window.removeEventListener("unload",this.Xo),this.Xo=null)},t.prototype.ya=function(t){var e;try{var n=null!==(null===(e=this.aa)||void 0===e?void 0:e.getItem(this.Va(t)));return gr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return yr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.va=function(){if(this.aa)try{this.aa.setItem(this.Va(this.clientId),String(Date.now()))}catch(t){yr("Failed to set zombie client id.",t)}},t.prototype.Da=function(){if(this.aa)try{this.aa.removeItem(this.Va(this.clientId))}catch(t){}},t.prototype.Va=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Yu(t){return Qu.qn(t,bu.store)}function $u(t){return Qu.qn(t,Du.store)}var Ju=function(){function t(t,e){this.db=t,this.Rr=new qa(this,e)}return t.prototype.Sr=function(t){var e=this.$a(t);return this.db.xa().Bo(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.$a=function(t){var e=0;return this.Cr(t,function(t){e++}).next(function(){return e})},t.prototype.De=function(t,e){return this.db.xa().De(t,e)},t.prototype.Cr=function(t,e){return this.La(t,function(t,n){return e(n)})},t.prototype.Qo=function(t,e,n){return Xu(t,n)},t.prototype.Wo=function(t,e,n){return Xu(t,n)},t.prototype.Nr=function(t,e,n){return this.db.xa().Nr(t,e,n)},t.prototype.eo=function(t,e){return Xu(t,e)},t.prototype.Ba=function(t,e){return function(t,e){var n=!1;return uu(t).ss(function(r){return iu(t,r,e).next(function(t){return t&&(n=!0),Js.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.Fr=function(t,e){var n=this,r=this.db.Fa()._o(),i=[],o=0;return this.La(t,function(s,a){if(a<=e){var u=n.Ba(t,s).next(function(e){if(!e)return o++,r.yi(t,s).next(function(){return r.Vi(s),zu(t).delete([0,Ba(s.path)])})});i.push(u)}}).next(function(){return Js.xn(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.nt(t.Go);return this.db.xa().ko(t,n)},t.prototype.qa=function(t,e){return Xu(t,e)},t.prototype.La=function(t,e){var n,r=zu(t),i=La.nr;return r.ns({index:ku.documentTargetsIndex},function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==La.nr&&e(new jr(za(n)),i),i=s,n=o):i=La.nr}).next(function(){i!==La.nr&&e(new jr(za(n)),i)})},t.prototype.Mr=function(t){return this.db.Fa().wo(t)},t}();function Xu(t,e){return zu(t).put(function(t,e){return new ku(0,Ba(t.path),e)}(e,t.Go))}function Zu(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var tc=function(){function t(t,e,n,r){this.persistence=t,this.Ua=e,this.serializer=r,this.Qa=new ni(Sr),this.Ka=new Cr(function(t){return Wr(t)},Hr),this.Wa=Lr.min(),this.xi=t.Na(n),this.ja=t.Fa(),this.ra=t.xa(),this.Ga=new Pa(this.ja,this.xi,this.persistence.Oa()),this.oa=t.Ma(),this.Ua.za(this.Ga)}return t.prototype.pr=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.Or(n,e.Qa)})},t}();function ec(t,e,n,r){return new tc(t,e,n,r)}function nc(t,e){return o(this,void 0,void 0,function(){var n,r,i,o;return s(this,function(s){switch(s.label){case 0:return n=Ir(t),r=n.xi,i=n.Ga,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n.xi.Hr(t).next(function(s){return o=s,r=n.persistence.Na(e),i=new Pa(n.ja,r,n.persistence.Oa()),r.Hr(t)}).next(function(e){for(var n=[],r=[],s=di(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++)s=s.add(f[h].key)}for(var l=0,p=e;l<p.length;l++){var d=p[l];r.push(d.batchId);for(var v=0,g=d.mutations;v<g.length;v++)s=s.add(g[v].key)}return i.Li(t,s).next(function(t){return{Ha:t,Ja:n,Ya:r}})})})];case 1:return o=s.sent(),[2,(n.xi=r,n.Ga=i,n.Ua.za(n.Ga),o)]}})})}function rc(t,e){var n=Ir(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.ja._o({fo:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=Js.resolve();return o.forEach(function(t){s=s.next(function(){return r.yi(e,t)}).next(function(e){var o=e,s=n.Ei.get(t);_r(null!==s),(!o||o.version.A(s)<0)&&(o=i._i(t,o,n))&&r.Ri(o,n.Ti)})}),s.next(function(){return t.xi.Yr(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n.xi.no(t)}).next(function(){return n.Ga.Li(t,r)})})}function ic(t){var e=Ir(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.ra.Co(t)})}function oc(t,e){var n=Ir(t),r=e.et,i=n.Qa;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.ja._o({fo:!0});i=n.Qa;var s=[];e.Gt.forEach(function(e,o){var a=i.get(o);if(a){s.push(n.ra.Ko(t,e.ne,o).next(function(){return n.ra.Uo(t,e.te,o)}));var u=e.resumeToken;if(u.X()>0){var c=a.st(u,r).nt(t.Go);i=i.rt(o,c),function(t,e,n){return _r(e.resumeToken.X()>0),0===t.resumeToken.X()||e.et.R()-t.et.R()>=3e8||n.te.size+n.ee.size+n.ne.size>0}(a,c,e)&&s.push(n.ra.ko(t,c))}}});var a=ui();if(e.Ht.forEach(function(r,i){e.Jt.has(r)&&s.push(n.persistence.Lr.qa(t,r))}),s.push(function(t,e,n,r,i){var o=di();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var i=ui();return n.forEach(function(n,o){var s=t.get(n),a=r;o instanceof ps&&o.version.isEqual(Lr.min())?(e.Vi(n,a),i=i.rt(n,o)):null==s||o.version.A(s.version)>0||0===o.version.A(s.version)&&s.hasPendingWrites?(e.Ri(o,a),i=i.rt(n,o)):gr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",o.version)}),i})}(t,o,e.Ht,r).next(function(t){a=t})),!r.isEqual(Lr.min())){var u=n.ra.Co(t).next(function(e){return n.ra.xo(t,t.Go,r)});s.push(u)}return Js.xn(s).next(function(){return o.apply(t)}).next(function(){return n.Ga.Bi(t,a)})}).then(function(t){return n.Qa=i,t})}function sc(t,e){var n=Ir(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.xi.Gr(t,e)})}function ac(t,e){var n=Ir(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.ra.qo(t,e).next(function(i){return i?Js.resolve(r=i):n.ra.bo(t).next(function(i){return r=new Xr(e,i,0,t.Go),n.ra.Fo(t,r).next(function(){return r})})})}).then(function(t){var r=n.Qa.get(t.targetId);return(null===r||t.et.A(r.et)>0)&&(n.Qa=n.Qa.rt(t.targetId,t),n.Ka.set(e,t.targetId)),t})}function uc(t,e,n){return o(this,void 0,void 0,function(){var r,i,o,a;return s(this,function(s){switch(s.label){case 0:r=Ir(t),i=r.Qa.get(e),o=n?"readwrite":"readwrite-primary",s.label=1;case 1:return s.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.Lr.removeTarget(t,i)})];case 2:s.sent(),s.label=3;case 3:return[3,5];case 4:if(!ea(a=s.sent()))throw a;return gr("LocalStore","Failed to update sequence numbers for target "+e+": "+a),[3,5];case 5:return r.Qa=r.Qa.remove(e),r.Ka.delete(i.target),[2]}})})}function cc(t,e,n){var r=Ir(t),i=Lr.min(),o=di();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=Ir(t),i=r.Ka.get(n);return void 0!==i?Js.resolve(r.Qa.get(i)):r.ra.qo(e,n)}(r,t,Ts(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.ra.jo(t,e.targetId).next(function(t){o=t})}).next(function(){return r.Ua.Ui(t,e,n?i:Lr.min(),n?o:di())}).next(function(t){return{documents:t,Xa:o}})})}function hc(t,e){var n=Ir(t),r=Ir(n.ra),i=n.Qa.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.qe(t,e).next(function(t){return t?t.target:null})})}function fc(t){var e=Ir(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=Ir(t),i=ui(),o=Ya(n),s=lu(e),a=IDBKeyRange.lowerBound(o,!0);return s.ns({index:Su.readTimeIndex,range:a},function(t,e){var n=Ha(r.serializer,e);i=i.rt(n.key,n),o=e.readTime}).next(function(){return{Za:i,readTime:$a(o)}})}(e.ja,t,e.Wa)}).then(function(t){var n=t.Za;return e.Wa=t.readTime,n})}function lc(t){return o(this,void 0,void 0,function(){var e;return s(this,function(n){return[2,(e=Ir(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=lu(t),n=Lr.min();return e.ns({index:Su.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=$a(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){e.Wa=t})]})})}function pc(t){return o(this,void 0,void 0,function(){return s(this,function(e){if(t.code!==Dr.FAILED_PRECONDITION||t.message!==Ca)throw t;return gr("LocalStore","Unexpectedly lost primary lease"),[2]})})}var dc=function(){function t(t,e,n,r,i,o){this.ln=t,this.tc=n,this.ec=r,this.nc=i,this.listener=o,this.state=0,this.sc=0,this.ic=null,this.stream=null,this.Ps=new $s(t,e)}return t.prototype.rc=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.oc=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.ac()},t.prototype.stop=function(){return o(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this.rc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.cc=function(){this.state=0,this.Ps.reset()},t.prototype.uc=function(){var t=this;this.oc()&&null===this.ic&&(this.ic=this.ln.Pn(this.tc,6e4,function(){return t.hc()}))},t.prototype.lc=function(t){this._c(),this.stream.send(t)},t.prototype.hc=function(){return o(this,void 0,void 0,function(){return s(this,function(t){return this.oc()?[2,this.close(0)]:[2]})})},t.prototype._c=function(){this.ic&&(this.ic.cancel(),this.ic=null)},t.prototype.close=function(t,e){return o(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return this._c(),this.Ps.cancel(),this.sc++,3!==t?this.Ps.reset():e&&e.code===Dr.RESOURCE_EXHAUSTED?(yr(e.toString()),yr("Using maximum backoff delay to prevent overloading the backend."),this.Ps.mn()):e&&e.code===Dr.UNAUTHENTICATED&&this.nc.ni(),null!==this.stream&&(this.fc(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.dc(e)];case 1:return n.sent(),[2]}})})},t.prototype.fc=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.wc(this.sc),n=this.sc;this.nc.getToken().then(function(e){t.sc===n&&t.Tc(e)},function(n){e(function(){var e=new Pr(Dr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.Ec(e)})})},t.prototype.Tc=function(t){var e=this,n=this.wc(this.sc);this.stream=this.Ic(t),this.stream.mc(function(){n(function(){return e.state=2,e.listener.mc()})}),this.stream.dc(function(t){n(function(){return e.Ec(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.ac=function(){var t=this;this.state=4,this.Ps.An(function(){return o(t,void 0,void 0,function(){return s(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.Ec=function(t){return gr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.wc=function(t){var e=this;return function(n){e.ln.fs(function(){return e.sc===t?n():(gr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),vc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,s}return i(e,t),e.prototype.Ic=function(t){return this.ec.Ac("Listen",t)},e.prototype.onMessage=function(t){this.Ps.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:wr()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.Ue?(_r(void 0===e||"string"==typeof e),Yr.fromBase64String(e||"")):(_r(void 0===e||e instanceof Uint8Array),Yr.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(t){var e=void 0===t.code?Dr.UNKNOWN:ei(t.code);return new Pr(e,t.message||"")}(s);n=new Ti(r,i,o,a||null)}else if("documentChange"in e){var u=e.documentChange,c=uo(t,u.document.name),h=io(u.document.updateTime),f=new us({mapValue:{fields:u.document.fields}}),l=new ls(c,h,f,{});n=new Ii(u.targetIds||[],u.removedTargetIds||[],l.key,l)}else if("documentDelete"in e){var p=e.documentDelete,d=uo(t,p.document),v=p.readTime?io(p.readTime):Lr.min(),g=new ps(d,v);n=new Ii([],p.removedTargetIds||[],g.key,g)}else if("documentRemove"in e){var y=e.documentRemove,m=uo(t,y.document);n=new Ii([],y.removedTargetIds||[],m,null)}else{if(!("filter"in e))return wr();var b=e.filter,w=new Zr(b.count||0);n=new Ei(b.targetId,w)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Lr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Lr.min():e.readTime?io(e.readTime):Lr.min()}(t);return this.listener.Rc(e,n)},e.prototype.Pc=function(t){var e={};e.database=fo(this.serializer),e.addTarget=function(t,e){var n,r=e.target;return(n=Qr(r)?{documents:yo(t,r)}:{query:mo(t,r)}).targetId=e.targetId,e.resumeToken.X()>0?n.resumeToken=no(t,e.resumeToken):e.et.A(Lr.min())>0&&(n.readTime=eo(t,e.et.P())),n}(this.serializer,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return wr()}}(0,e.tt);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.lc(e)},e.prototype.gc=function(t){var e={};e.database=fo(this.serializer),e.removeTarget=t,this.lc(e)},e}(dc),gc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,s.Vc=!1,s}return i(e,t),Object.defineProperty(e.prototype,"yc",{get:function(){return this.Vc},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.Vc=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.fc=function(){this.Vc&&this.vc([])},e.prototype.Ic=function(t){return this.ec.Ac("Write",t)},e.prototype.onMessage=function(t){if(_r(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Vc){this.Ps.reset();var e=function(t,e){return t&&t.length>0?(_r(void 0!==e),t.map(function(t){return function(t,e){var n=io(t.updateTime?t.updateTime:e);n.isEqual(Lr.min())&&(n=io(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new zo(n,r)}(t,e)})):[]}(t.writeResults,t.commitTime),n=io(t.commitTime);return this.listener.bc(n,e)}return _r(!t.writeResults||0===t.writeResults.length),this.Vc=!0,this.listener.Sc()},e.prototype.Dc=function(){var t={};t.database=fo(this.serializer),this.lc(t)},e.prototype.vc=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return vo(e.serializer,t)})};this.lc(n)},e}(dc),yc=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.ec=n,i.serializer=r,i.Cc=!1,i}return i(e,t),e.prototype.Nc=function(){if(this.Cc)throw new Pr(Dr.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.xc=function(t,e,n){var r=this;return this.Nc(),this.credentials.getToken().then(function(i){return r.ec.xc(t,e,n,i)}).catch(function(t){throw t.code===Dr.UNAUTHENTICATED&&r.credentials.ni(),t})},e.prototype.Fc=function(t,e,n){var r=this;return this.Nc(),this.credentials.getToken().then(function(i){return r.ec.Fc(t,e,n,i)}).catch(function(t){throw t.code===Dr.UNAUTHENTICATED&&r.credentials.ni(),t})},e.prototype.terminate=function(){this.Cc=!1},e}(function(){}),mc=function(){function t(t,e){this.rs=t,this.Oc=e,this.state="Unknown",this.Mc=0,this.kc=null,this.$c=!0}return t.prototype.Lc=function(){var t=this;0===this.Mc&&(this.Bc("Unknown"),this.kc=this.rs.Pn("online_state_timeout",1e4,function(){return t.kc=null,t.qc("Backend didn't respond within 10 seconds."),t.Bc("Offline"),Promise.resolve()}))},t.prototype.Uc=function(t){"Online"===this.state?this.Bc("Unknown"):(this.Mc++,this.Mc>=1&&(this.Qc(),this.qc("Connection failed 1 times. Most recent error: "+t.toString()),this.Bc("Offline")))},t.prototype.set=function(t){this.Qc(),this.Mc=0,"Online"===t&&(this.$c=!1),this.Bc(t)},t.prototype.Bc=function(t){t!==this.state&&(this.state=t,this.Oc(t))},t.prototype.qc=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.$c?(yr(e),this.$c=!1):gr("OnlineStateTracker",e)},t.prototype.Qc=function(){null!==this.kc&&(this.kc.cancel(),this.kc=null)},t}(),bc=function(t,e,n,r,i){var a=this;this.Kc=t,this.Wc=e,this.rs=n,this.jc={},this.Gc=[],this.zc=new Map,this.Hc=new Set,this.Jc=[],this.Yc=i,this.Yc.Xc(function(t){n.fs(function(){return o(a,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return kc(this)?(gr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return o(this,void 0,void 0,function(){var e;return s(this,function(n){switch(n.label){case 0:return(e=Ir(t)).Hc.add(4),[4,_c(e)];case 1:return n.sent(),e.Zc.set("Unknown"),e.Hc.delete(4),[4,wc(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Zc=new mc(n,r)};function wc(t){return o(this,void 0,void 0,function(){var e,n;return s(this,function(r){switch(r.label){case 0:if(!kc(t))return[3,4];e=0,n=t.Jc,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function _c(t){return o(this,void 0,void 0,function(){var e,n;return s(this,function(r){switch(r.label){case 0:e=0,n=t.Jc,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Ic(t,e){var n=Ir(t);n.zc.has(e.targetId)||(n.zc.set(e.targetId,e),Nc(n)?Ac(n):Gc(n).oc()&&Tc(n,e))}function Ec(t,e){var n=Ir(t),r=Gc(n);n.zc.delete(e),r.oc()&&Sc(n,e),0===n.zc.size&&(r.oc()?r.uc():kc(n)&&n.Zc.set("Unknown"))}function Tc(t,e){t.tu.Ie(e.targetId),Gc(t).Pc(e)}function Sc(t,e){t.tu.Ie(e),Gc(t).gc(e)}function Ac(t){t.tu=new Ai({Be:function(e){return t.jc.Be(e)},qe:function(e){return t.zc.get(e)||null}}),Gc(t).start(),t.Zc.Lc()}function Nc(t){return kc(t)&&!Gc(t).rc()&&t.zc.size>0}function kc(t){return 0===Ir(t).Hc.size}function xc(t){t.tu=void 0}function Oc(t){return o(this,void 0,void 0,function(){return s(this,function(e){return t.zc.forEach(function(e,n){Tc(t,e)}),[2]})})}function Cc(t,e){return o(this,void 0,void 0,function(){return s(this,function(n){return xc(t),Nc(t)?(t.Zc.Uc(e),Ac(t)):t.Zc.set("Unknown"),[2]})})}function Dc(t,e,n){return o(this,void 0,void 0,function(){var r,i,a;return s(this,function(u){switch(u.label){case 0:if(t.Zc.set("Online"),!(e instanceof Ti&&2===e.state&&e.cause))return[3,6];u.label=1;case 1:return u.trys.push([1,3,,5]),[4,function(t,e){return o(this,void 0,void 0,function(){var n,r,i,o;return s(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.zc.has(o=i[r])?[4,t.jc.eu(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.zc.delete(o),t.tu.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return u.sent(),[3,5];case 3:return r=u.sent(),gr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,Pc(t,r)];case 4:return u.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Ii?t.tu.pe(e):e instanceof Ei?t.tu.Fe(e):t.tu.Se(e),n.isEqual(Lr.min()))return[3,13];u.label=7;case 7:return u.trys.push([7,11,,13]),[4,ic(t.Kc)];case 8:return i=u.sent(),n.A(i)>=0?[4,function(t,e){var n=t.tu.ke(e);return n.Gt.forEach(function(n,r){if(n.resumeToken.X()>0){var i=t.zc.get(r);i&&t.zc.set(r,i.st(n.resumeToken,e))}}),n.zt.forEach(function(e){var n=t.zc.get(e);if(n){t.zc.set(e,n.st(Yr.Z,n.et)),Sc(t,e);var r=new Xr(n.target,e,1,n.sequenceNumber);Tc(t,r)}}),t.jc.nu(n)}(t,n)]:[3,10];case 9:u.sent(),u.label=10;case 10:return[3,13];case 11:return gr("RemoteStore","Failed to raise snapshot:",a=u.sent()),[4,Pc(t,a)];case 12:return u.sent(),[3,13];case 13:return[2]}})})}function Pc(t,e,n){return o(this,void 0,void 0,function(){var r=this;return s(this,function(i){switch(i.label){case 0:if(!ea(e))throw e;return t.Hc.add(1),[4,_c(t)];case 1:return i.sent(),t.Zc.set("Offline"),n||(n=function(){return ic(t.Kc)}),t.rs.Ss(function(){return o(r,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return gr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Hc.delete(1),[4,wc(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function Mc(t,e){return e().catch(function(n){return Pc(t,n,e)})}function Lc(t){return o(this,void 0,void 0,function(){var e,n,r,i,o;return s(this,function(s){switch(s.label){case 0:e=Ir(t),n=Kc(e),r=e.Gc.length>0?e.Gc[e.Gc.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return kc(t)&&t.Gc.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,sc(e.Kc,r)];case 3:return null===(i=s.sent())?(0===e.Gc.length&&n.uc(),[3,7]):(r=i.batchId,function(t,e){t.Gc.push(e);var n=Kc(t);n.oc()&&n.yc&&n.vc(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,Pc(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return Rc(e)&&Vc(e),[2]}})})}function Rc(t){return kc(t)&&!Kc(t).rc()&&t.Gc.length>0}function Vc(t){Kc(t).start()}function Fc(t){return o(this,void 0,void 0,function(){return s(this,function(e){return Kc(t).Dc(),[2]})})}function Uc(t){return o(this,void 0,void 0,function(){var e,n,r;return s(this,function(i){for(e=Kc(t),n=0,r=t.Gc;n<r.length;n++)e.vc(r[n].mutations);return[2]})})}function jc(t,e,n){return o(this,void 0,void 0,function(){var r,i;return s(this,function(o){switch(o.label){case 0:return r=t.Gc.shift(),i=Na.from(r,e,n),[4,Mc(t,function(){return t.jc.su(i)})];case 1:return o.sent(),[4,Lc(t)];case 2:return o.sent(),[2]}})})}function qc(t,e){return o(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return e&&Kc(t).yc?[4,function(t,e){return o(this,void 0,void 0,function(){var n,r;return s(this,function(i){switch(i.label){case 0:return ti(r=e.code)&&r!==Dr.ABORTED?(n=t.Gc.shift(),Kc(t).cc(),[4,Mc(t,function(){return t.jc.iu(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,Lc(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Rc(t)&&Vc(t),[2]}})})}function Bc(t,e){return o(this,void 0,void 0,function(){var n;return s(this,function(r){switch(r.label){case 0:return n=Ir(t),e?(n.Hc.delete(2),[4,wc(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Hc.add(2),[4,_c(n)]);case 3:r.sent(),n.Zc.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function Gc(t){var e=this;return t.ru||(t.ru=function(t,e,n){var r=Ir(t);return r.Nc(),new vc(e,r.ec,r.credentials,r.serializer,n)}(t.Wc,t.rs,{mc:Oc.bind(null,t),dc:Cc.bind(null,t),Rc:Dc.bind(null,t)}),t.Jc.push(function(n){return o(e,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return n?(t.ru.cc(),Nc(t)?Ac(t):t.Zc.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.ru.stop()];case 2:e.sent(),xc(t),e.label=3;case 3:return[2]}})})})),t.ru}function Kc(t){var e=this;return t.ou||(t.ou=function(t,e,n){var r=Ir(t);return r.Nc(),new gc(e,r.ec,r.credentials,r.serializer,n)}(t.Wc,t.rs,{mc:Fc.bind(null,t),dc:qc.bind(null,t),Sc:Uc.bind(null,t),bc:jc.bind(null,t)}),t.Jc.push(function(n){return o(e,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return n?(t.ou.cc(),[4,Lc(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.ou.stop()];case 3:e.sent(),t.Gc.length>0&&(gr("RemoteStore","Stopping write stream with "+t.Gc.length+" pending writes"),t.Gc=[]),e.label=4;case 4:return[2]}})})})),t.ou}var zc=function(){function t(){this.au=new oi(Wc.cu),this.uu=new oi(Wc.hu)}return t.prototype.T=function(){return this.au.T()},t.prototype.Qo=function(t,e){var n=new Wc(t,e);this.au=this.au.add(n),this.uu=this.uu.add(n)},t.prototype.lu=function(t,e){var n=this;t.forEach(function(t){return n.Qo(t,e)})},t.prototype.Wo=function(t,e){this._u(new Wc(t,e))},t.prototype.fu=function(t,e){var n=this;t.forEach(function(t){return n.Wo(t,e)})},t.prototype.du=function(t){var e=this,n=new jr(new Vr([])),r=new Wc(n,t),i=new Wc(n,t+1),o=[];return this.uu.Nt([r,i],function(t){e._u(t),o.push(t.key)}),o},t.prototype.wu=function(){var t=this;this.au.forEach(function(e){return t._u(e)})},t.prototype._u=function(t){this.au=this.au.delete(t),this.uu=this.uu.delete(t)},t.prototype.Tu=function(t){var e=new jr(new Vr([])),n=new Wc(e,t),r=new Wc(e,t+1),i=di();return this.uu.Nt([n,r],function(t){i=i.add(t.key)}),i},t.prototype.so=function(t){var e=new Wc(t,0),n=this.au.Ft(e);return null!==n&&t.isEqual(n.key)},t}(),Wc=function(){function t(t,e){this.key=t,this.Eu=e}return t.cu=function(t,e){return jr.V(t.key,e.key)||Sr(t.Eu,e.Eu)},t.hu=function(t,e){return Sr(t.Eu,e.Eu)||jr.V(t.key,e.key)},t}();function Hc(t,e){return"firestore_clients_"+t+"_"+e}function Qc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Js()&&(r+="_"+e.uid),r}function Yc(t,e){return"firestore_targets_"+t+"_"+e}var $c=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Iu=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new Pr(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(yr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.mu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Jc=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Iu=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Pr(r.error.code,r.error.message)),i?new t(e,r.state,o):(yr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.mu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Xc=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Iu=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=gi(),s=0;i&&s<r.activeTargetIds.length;++s)i=Gr(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(yr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Zc=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Iu=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(yr("SharedClientState","Failed to parse online state: "+e),null)},t}(),th=function(){function t(){this.activeTargetIds=gi()}return t.prototype.Au=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Ru=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.mu=function(){var t={activeTargetIds:this.activeTargetIds.O(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),eh=function(){function t(t,e,n,r,i){this.window=t,this.ln=e,this.persistenceKey=n,this.Pu=r,this.gu=null,this.Oc=null,this.Xi=null,this.Vu=this.yu.bind(this),this.pu=new ni(Sr),this.yr=!1,this.vu=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.bu=Hc(this.persistenceKey,this.Pu),this.Su=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.pu=this.pu.rt(this.Pu,new th),this.Du=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Cu=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Nu=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.xu=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Fu=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.Vu)}return t.kn=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return o(this,void 0,void 0,function(){var t,e,n,r,i,o,a,u,c,h,f=this;return s(this,function(s){switch(s.label){case 0:return[4,this.gu.Ca()];case 1:for(t=s.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Pu&&(i=this.getItem(Hc(this.persistenceKey,r)))&&(o=Xc.Iu(r,i))&&(this.pu=this.pu.rt(o.clientId,o));for(this.Ou(),(a=this.storage.getItem(this.xu))&&(u=this.Mu(a))&&this.ku(u),c=0,h=this.vu;c<h.length;c++)this.yu(h[c]);return this.vu=[],this.window.addEventListener("unload",function(){return f.pa()}),this.yr=!0,[2]}})})},t.prototype.er=function(t){this.setItem(this.Su,JSON.stringify(t))},t.prototype.$u=function(){return this.Lu(this.pu)},t.prototype.Bu=function(t){var e=!1;return this.pu.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.qu=function(t){this.Uu(t,"pending")},t.prototype.Qu=function(t,e,n){this.Uu(t,e,n),this.Ku(t)},t.prototype.Wu=function(t){var e="not-current";if(this.Bu(t)){var n=this.storage.getItem(Yc(this.persistenceKey,t));if(n){var r=Jc.Iu(t,n);r&&(e=r.state)}}return this.ju.Au(t),this.Ou(),e},t.prototype.Gu=function(t){this.ju.Ru(t),this.Ou()},t.prototype.zu=function(t){return this.ju.activeTargetIds.has(t)},t.prototype.Hu=function(t){this.removeItem(Yc(this.persistenceKey,t))},t.prototype.Ju=function(t,e,n){this.Yu(t,e,n)},t.prototype.Xu=function(t,e,n){var r=this;e.forEach(function(t){r.Ku(t)}),this.currentUser=t,n.forEach(function(t){r.qu(t)})},t.prototype.Zu=function(t){this.th(t)},t.prototype.eh=function(){this.nh()},t.prototype.pa=function(){this.yr&&(this.window.removeEventListener("storage",this.Vu),this.removeItem(this.bu),this.yr=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return gr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){gr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){gr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.yu=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(gr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.bu)return void yr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ln.Ss(function(){return o(e,void 0,void 0,function(){var t,e,r,i,o,a;return s(this,function(s){if(this.yr){if(null!==n.key)if(this.Du.test(n.key)){if(null==n.newValue)return t=this.sh(n.key),[2,this.ih(t,null)];if(e=this.rh(n.key,n.newValue))return[2,this.ih(e.clientId,e)]}else if(this.Cu.test(n.key)){if(null!==n.newValue&&(r=this.oh(n.key,n.newValue)))return[2,this.ah(r)]}else if(this.Nu.test(n.key)){if(null!==n.newValue&&(i=this.uh(n.key,n.newValue)))return[2,this.hh(i)]}else if(n.key===this.xu){if(null!==n.newValue&&(o=this.Mu(n.newValue)))return[2,this.ku(o)]}else if(n.key===this.Su)(a=function(t){var e=La.nr;if(null!=t)try{var n=JSON.parse(t);_r("number"==typeof n),e=n}catch(t){yr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==La.nr&&this.Xi(a);else if(n.key===this.Fu)return[2,this.gu.lh()]}else this.vu.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"ju",{get:function(){return this.pu.get(this.Pu)},enumerable:!1,configurable:!0}),t.prototype.Ou=function(){this.setItem(this.bu,this.ju.mu())},t.prototype.Uu=function(t,e,n){var r=new $c(this.currentUser,t,e,n),i=Qc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.mu())},t.prototype.Ku=function(t){var e=Qc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.th=function(t){this.storage.setItem(this.xu,JSON.stringify({clientId:this.Pu,onlineState:t}))},t.prototype.Yu=function(t,e,n){var r=Yc(this.persistenceKey,t),i=new Jc(t,e,n);this.setItem(r,i.mu())},t.prototype.nh=function(){this.setItem(this.Fu,"value-not-used")},t.prototype.sh=function(t){var e=this.Du.exec(t);return e?e[1]:null},t.prototype.rh=function(t,e){var n=this.sh(t);return Xc.Iu(n,e)},t.prototype.oh=function(t,e){var n=this.Cu.exec(t),r=Number(n[1]);return $c.Iu(new wa(void 0!==n[2]?n[2]:null),r,e)},t.prototype.uh=function(t,e){var n=this.Nu.exec(t),r=Number(n[1]);return Jc.Iu(r,e)},t.prototype.Mu=function(t){return Zc.Iu(t)},t.prototype.ah=function(t){return o(this,void 0,void 0,function(){return s(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.gu._h(t.batchId,t.state,t.error)]:(gr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.hh=function(t){return this.gu.fh(t.targetId,t.state,t.error)},t.prototype.ih=function(t,e){var n=this,r=e?this.pu.rt(t,e):this.pu.remove(t),i=this.Lu(this.pu),o=this.Lu(r),s=[],a=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||a.push(t)}),this.gu.dh(s,a).then(function(){n.pu=r})},t.prototype.ku=function(t){this.pu.get(t.clientId)&&this.Oc(t.onlineState)},t.prototype.Lu=function(t){var e=gi();return t.forEach(function(t,n){e=e.Ot(n.activeTargetIds)}),e},t}(),nh=function(){function t(){this.wh=new th,this.Th={},this.Oc=null,this.Xi=null}return t.prototype.qu=function(t){},t.prototype.Qu=function(t,e,n){},t.prototype.Wu=function(t){return this.wh.Au(t),this.Th[t]||"not-current"},t.prototype.Ju=function(t,e,n){this.Th[t]=e},t.prototype.Gu=function(t){this.wh.Ru(t)},t.prototype.zu=function(t){return this.wh.activeTargetIds.has(t)},t.prototype.Hu=function(t){delete this.Th[t]},t.prototype.$u=function(){return this.wh.activeTargetIds},t.prototype.Bu=function(t){return this.wh.activeTargetIds.has(t)},t.prototype.start=function(){return this.wh=new th,Promise.resolve()},t.prototype.Xu=function(t,e,n){},t.prototype.Zu=function(t){},t.prototype.pa=function(){},t.prototype.er=function(t){},t.prototype.eh=function(){},t}(),rh=function(t){this.key=t},ih=function(t){this.key=t},oh=function(){function t(t,e){this.query=t,this.Eh=e,this.Ih=null,this.Zt=!1,this.mh=di(),this.Qt=di(),this.Ah=Ds(t),this.Rh=new yi(this.Ah)}return Object.defineProperty(t.prototype,"Ph",{get:function(){return this.Eh},enumerable:!1,configurable:!0}),t.prototype.gh=function(t,e){var n=this,r=e?e.Vh:new mi,i=e?e.Rh:this.Rh,o=e?e.Qt:this.Qt,s=i,a=!1,u=ms(this.query)&&i.size===this.query.limit?i.last():null,c=bs(this.query)&&i.size===this.query.limit?i.first():null;if(t.ut(function(t,e){var h=i.get(t),f=e instanceof ls?e:null;f&&(f=Cs(n.query,f)?f:null);var l=!!h&&n.Qt.has(h.key),p=!!f&&(f.Je||n.Qt.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.yh(h,f)||(r.track({type:2,doc:f}),d=!0,(u&&n.Ah(f,u)>0||c&&n.Ah(f,c)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(u||c)&&(a=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),ms(this.query)||bs(this.query))for(;s.size>this.query.limit;){var h=ms(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{Rh:s,Vh:r,ph:a,Qt:o}},t.prototype.yh=function(t,e){return t.Je&&e.hasCommittedMutations&&!e.Je},t.prototype.bi=function(t,e,n){var r=this,i=this.Rh;this.Rh=t.Rh,this.Qt=t.Qt;var o=t.Vh.qt();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return wr()}};return n(t)-n(e)}(t.type,e.type)||r.Ah(t.doc,e.doc)}),this.bh(n);var s=e?this.Sh():[],a=0===this.mh.size&&this.Zt?1:0,u=a!==this.Ih;return this.Ih=a,0!==o.length||u?{snapshot:new bi(this.query,t.Rh,i,o,t.Qt,0===a,u,!1),Dh:s}:{Dh:s}},t.prototype.Bs=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.bi({Rh:this.Rh,Vh:new mi,Qt:this.Qt,ph:!1},!1)):{Dh:[]}},t.prototype.Ch=function(t){return!this.Eh.has(t)&&!!this.Rh.has(t)&&!this.Rh.get(t).Je},t.prototype.bh=function(t){var e=this;t&&(t.te.forEach(function(t){return e.Eh=e.Eh.add(t)}),t.ee.forEach(function(t){}),t.ne.forEach(function(t){return e.Eh=e.Eh.delete(t)}),this.Zt=t.Zt)},t.prototype.Sh=function(){var t=this;if(!this.Zt)return[];var e=this.mh;this.mh=di(),this.Rh.forEach(function(e){t.Ch(e.key)&&(t.mh=t.mh.add(e.key))});var n=[];return e.forEach(function(e){t.mh.has(e)||n.push(new ih(e))}),this.mh.forEach(function(t){e.has(t)||n.push(new rh(t))}),n},t.prototype.Nh=function(t){this.Eh=t.Xa,this.mh=di();var e=this.gh(t.documents);return this.bi(e,!0)},t.prototype.xh=function(){return bi.jt(this.query,this.Rh,this.Qt,0===this.Ih)},t}(),sh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},ah=function(t){this.key=t,this.Fh=!1},uh=function(){function t(t,e,n,r,i,o){this.Kc=t,this.Oh=e,this.Mh=n,this.kh=r,this.currentUser=i,this.$h=o,this.Lh={},this.Bh=new Cr(function(t){return xs(t)},ks),this.qh=new Map,this.Uh=[],this.Qh=new ni(jr.V),this.Kh=new Map,this.Wh=new zc,this.jh={},this.Gh=new Map,this.zh=qu.vo(),this.onlineState="Unknown",this.Hh=void 0}return Object.defineProperty(t.prototype,"Jh",{get:function(){return!0===this.Hh},enumerable:!1,configurable:!0}),t}();function ch(t,e){return o(this,void 0,void 0,function(){var n,r,i,o,a;return s(this,function(s){switch(s.label){case 0:return n=Fh(t),(i=n.Bh.get(e))?(n.kh.Wu(i.targetId),r=i.view.xh(),[3,4]):[3,1];case 1:return[4,ac(n.Kc,Ts(e))];case 2:return o=s.sent(),a=n.kh.Wu(o.targetId),[4,hh(n,e,o.targetId,"current"===a)];case 3:r=s.sent(),n.Jh&&Ic(n.Oh,o),s.label=4;case 4:return[2,r]}})})}function hh(t,e,n,r){return o(this,void 0,void 0,function(){var i,a,u,c,h,f;return s(this,function(l){switch(l.label){case 0:return t.Yh=function(e,n,r){return function(t,e,n,r){return o(this,void 0,void 0,function(){var i,o,a;return s(this,function(s){switch(s.label){case 0:return(i=e.view.gh(n)).ph?[4,cc(t.Kc,e.query,!1).then(function(t){return e.view.gh(t.documents,i)})]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return o=r&&r.Gt.get(e.targetId),a=e.view.bi(i,t.Jh,o),[2,(Eh(t,e.targetId,a.Dh),a.snapshot)]}})})}(t,e,n,r)},[4,cc(t.Kc,e,!0)];case 1:return i=l.sent(),a=new oh(e,i.Xa),u=a.gh(i.documents),c=_i.Xt(n,r&&"Offline"!==t.onlineState),h=a.bi(u,t.Jh,c),Eh(t,n,h.Dh),f=new sh(e,n,a),[2,(t.Bh.set(e,f),t.qh.has(n)?t.qh.get(n).push(e):t.qh.set(n,[e]),h.snapshot)]}})})}function fh(t,e){return o(this,void 0,void 0,function(){var n,r,i;return s(this,function(o){switch(o.label){case 0:return n=Ir(t),r=n.Bh.get(e),(i=n.qh.get(r.targetId)).length>1?[2,(n.qh.set(r.targetId,i.filter(function(t){return!ks(t,e)})),void n.Bh.delete(e))]:n.Jh?(n.kh.Gu(r.targetId),n.kh.Bu(r.targetId)?[3,2]:[4,uc(n.Kc,r.targetId,!1).then(function(){n.kh.Hu(r.targetId),Ec(n.Oh,r.targetId),_h(n,r.targetId)}).catch(pc)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return _h(n,r.targetId),[4,uc(n.Kc,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function lh(t,e,n){return o(this,void 0,void 0,function(){var r,i,o,a;return s(this,function(s){switch(s.label){case 0:r=Uh(t),s.label=1;case 1:return s.trys.push([1,5,,6]),[4,function(t,e){var n,r=Ir(t),i=Mr.now(),o=e.reduce(function(t,e){return t.add(e.key)},di());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Ga.Li(t,o).next(function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],h=Jo(c,n.get(c.key));null!=h&&s.push(new es(c.key,h,hs(h.proto.mapValue),Wo.exists(!0)))}return r.xi.Qr(t,i,s,e)})}).then(function(t){var e=t.wi(n);return{batchId:t.batchId,Ii:e}})}(r.Kc,e)];case 2:return i=s.sent(),r.kh.qu(i.batchId),function(t,e,n){var r=t.jh[t.currentUser.Ys()];r||(r=new ni(Sr)),r=r.rt(e,n),t.jh[t.currentUser.Ys()]=r}(r,i.batchId,n),[4,Ah(r,i.Ii)];case 3:return s.sent(),[4,Lc(r.Oh)];case 4:return s.sent(),[3,6];case 5:return o=s.sent(),a=fa(o,"Failed to persist write"),n.reject(a),[3,6];case 6:return[2]}})})}function ph(t,e){return o(this,void 0,void 0,function(){var n,r;return s(this,function(i){switch(i.label){case 0:n=Ir(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,oc(n.Kc,e)];case 2:return r=i.sent(),e.Gt.forEach(function(t,e){var r=n.Kh.get(e);r&&(_r(t.te.size+t.ee.size+t.ne.size<=1),t.te.size>0?r.Fh=!0:t.ee.size>0?_r(r.Fh):t.ne.size>0&&(_r(r.Fh),r.Fh=!1))}),[4,Ah(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,pc(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function dh(t,e,n){var r=Ir(t);if(r.Jh&&0===n||!r.Jh&&1===n){var i=[];r.Bh.forEach(function(t,n){var r=n.view.Bs(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=Ir(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Bs(e)&&(r=!0)}),r&&ma(n)}(r.Mh,e),i.length&&r.Lh.Rc(i),r.onlineState=e,r.Jh&&r.kh.Zu(e)}}function vh(t,e,n){return o(this,void 0,void 0,function(){var r,i,o,a,u,c;return s(this,function(s){switch(s.label){case 0:return(r=Ir(t)).kh.Ju(e,"rejected",n),i=r.Kh.get(e),(o=i&&i.key)?(a=(a=new ni(jr.V)).rt(o,new ps(o,Lr.min())),u=di().add(o),c=new wi(Lr.min(),new Map,new oi(Sr),a,u),[4,ph(r,c)]):[3,2];case 1:return s.sent(),r.Qh=r.Qh.remove(o),r.Kh.delete(e),Sh(r),[3,4];case 2:return[4,uc(r.Kc,e,!1).then(function(){return _h(r,e,n)}).catch(pc)];case 3:s.sent(),s.label=4;case 4:return[2]}})})}function gh(t,e){return o(this,void 0,void 0,function(){var n,r,i;return s(this,function(o){switch(o.label){case 0:n=Ir(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,rc(n.Kc,e)];case 2:return i=o.sent(),wh(n,r,null),bh(n,r),n.kh.Qu(r,"acknowledged"),[4,Ah(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,pc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function yh(t,e,n){return o(this,void 0,void 0,function(){var r,i;return s(this,function(o){switch(o.label){case 0:r=Ir(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Ir(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n.xi.Wr(t,e).next(function(e){return _r(null!==e),r=e.keys(),n.xi.Yr(t,e)}).next(function(){return n.xi.no(t)}).next(function(){return n.Ga.Li(t,r)})})}(r.Kc,e)];case 2:return i=o.sent(),wh(r,e,n),bh(r,e),r.kh.Qu(e,"rejected",n),[4,Ah(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,pc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function mh(t,e){return o(this,void 0,void 0,function(){var n,r,i,o,a;return s(this,function(s){switch(s.label){case 0:kc((n=Ir(t)).Oh)||gr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,function(t){var e=Ir(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.xi.zr(t)})}(n.Kc)];case 2:return-1===(r=s.sent())?[2,void e.resolve()]:((i=n.Gh.get(r)||[]).push(e),n.Gh.set(r,i),[3,4]);case 3:return o=s.sent(),a=fa(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(a),[3,4];case 4:return[2]}})})}function bh(t,e){(t.Gh.get(e)||[]).forEach(function(t){t.resolve()}),t.Gh.delete(e)}function wh(t,e,n){var r=Ir(t),i=r.jh[r.currentUser.Ys()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.jh[r.currentUser.Ys()]=i}}function _h(t,e,n){void 0===n&&(n=null),t.kh.Gu(e);for(var r=0,i=t.qh.get(e);r<i.length;r++){var o=i[r];t.Bh.delete(o),n&&t.Lh.Xh(o,n)}t.qh.delete(e),t.Jh&&t.Wh.du(e).forEach(function(e){t.Wh.so(e)||Ih(t,e)})}function Ih(t,e){var n=t.Qh.get(e);null!==n&&(Ec(t.Oh,n),t.Qh=t.Qh.remove(e),t.Kh.delete(n),Sh(t))}function Eh(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof rh?(t.Wh.Qo(o.key,e),Th(t,o)):o instanceof ih?(gr("SyncEngine","Document no longer in limbo: "+o.key),t.Wh.Wo(o.key,e),t.Wh.so(o.key)||Ih(t,o.key)):wr()}}function Th(t,e){var n=e.key;t.Qh.get(n)||(gr("SyncEngine","New document in limbo: "+n),t.Uh.push(n),Sh(t))}function Sh(t){for(;t.Uh.length>0&&t.Qh.size<t.$h;){var e=t.Uh.shift(),n=t.zh.next();t.Kh.set(n,new ah(e)),t.Qh=t.Qh.rt(e,n),Ic(t.Oh,new Xr(Ts(ys(e.path)),n,2,La.nr))}}function Ah(t,e,n){return o(this,void 0,void 0,function(){var r,i,a,u;return s(this,function(c){switch(c.label){case 0:return r=Ir(t),i=[],a=[],u=[],r.Bh.T()?[3,3]:(r.Bh.forEach(function(t,o){u.push(r.Yh(o,e,n).then(function(t){if(t){r.Jh&&r.kh.Ju(o.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Ma.Yi(o.targetId,t);a.push(e)}}))}),[4,Promise.all(u)]);case 1:return c.sent(),r.Lh.Rc(i),[4,function(t,e){return o(this,void 0,void 0,function(){var n,r,i,o,a,u,c,h;return s(this,function(s){switch(s.label){case 0:n=Ir(t),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return Js.forEach(e,function(e){return Js.forEach(e.Hi,function(r){return n.persistence.Lr.Qo(t,e.targetId,r)}).next(function(){return Js.forEach(e.Ji,function(r){return n.persistence.Lr.Wo(t,e.targetId,r)})})})})];case 2:return s.sent(),[3,4];case 3:if(!ea(r=s.sent()))throw r;return gr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)u=(a=o[i]).targetId,a.fromCache||(c=n.Qa.get(u),h=c.it(c.et),n.Qa=n.Qa.rt(u,h));return[2]}})})}(r.Kc,a)];case 2:c.sent(),c.label=3;case 3:return[2]}})})}function Nh(t,e){return o(this,void 0,void 0,function(){var n,r;return s(this,function(i){switch(i.label){case 0:return(n=Ir(t)).currentUser.isEqual(e)?[3,3]:(gr("SyncEngine","User change. New user:",e.Ys()),[4,nc(n.Kc,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Gh.forEach(function(t){t.forEach(function(t){t.reject(new Pr(Dr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.Gh.clear()}(n),n.kh.Xu(e,r.Ja,r.Ya),[4,Ah(n,r.Ha)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function kh(t,e){var n=Ir(t),r=n.Kh.get(e);if(r&&r.Fh)return di().add(r.key);var i=di(),o=n.qh.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=n.Bh.get(a[s]);i=i.Ot(u.view.Ph)}return i}function xh(t,e){return o(this,void 0,void 0,function(){var n,r,i;return s(this,function(o){switch(o.label){case 0:return[4,cc((n=Ir(t)).Kc,e.query,!0)];case 1:return r=o.sent(),i=e.view.Nh(r),[2,(n.Jh&&Eh(n,e.targetId,i.Dh),i)]}})})}function Oh(t){return o(this,void 0,void 0,function(){var e;return s(this,function(n){return[2,fc((e=Ir(t)).Kc).then(function(t){return Ah(e,t)})]})})}function Ch(t,e,n,r){return o(this,void 0,void 0,function(){var i,o;return s(this,function(s){switch(s.label){case 0:return[4,function(t,e){var n=Ir(t),r=Ir(n.xi);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.jr(t,e).next(function(e){return e?n.Ga.Li(t,e):Js.resolve(null)})})}((i=Ir(t)).Kc,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,Lc(i.Oh)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(wh(i,e,r||null),bh(i,e),function(t,e){Ir(Ir(t).xi).Zr(e)}(i.Kc,e)):wr(),s.label=4;case 4:return[4,Ah(i,o)];case 5:return s.sent(),[3,7];case 6:gr("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}function Dh(t,e){return o(this,void 0,void 0,function(){var n,r,i,o,a,u,c;return s(this,function(s){switch(s.label){case 0:return Fh(n=Ir(t)),Uh(n),!0!==e||!0===n.Hh?[3,3]:(r=n.kh.$u(),[4,Ph(n,r.O())]);case 1:return i=s.sent(),n.Hh=!0,[4,Bc(n.Oh,!0)];case 2:for(s.sent(),o=0,a=i;o<a.length;o++)Ic(n.Oh,a[o]);return[3,7];case 3:return!1!==e||!1===n.Hh?[3,7]:(u=[],c=Promise.resolve(),n.qh.forEach(function(t,e){n.kh.zu(e)?u.push(e):c=c.then(function(){return _h(n,e),uc(n.Kc,e,!0)}),Ec(n.Oh,e)}),[4,c]);case 4:return s.sent(),[4,Ph(n,u)];case 5:return s.sent(),function(t){var e=Ir(t);e.Kh.forEach(function(t,n){Ec(e.Oh,n)}),e.Wh.wu(),e.Kh=new Map,e.Qh=new ni(jr.V)}(n),n.Hh=!1,[4,Bc(n.Oh,!1)];case 6:s.sent(),s.label=7;case 7:return[2]}})})}function Ph(t,e,n){return o(this,void 0,void 0,function(){var n,r,i,o,a,u,c,h,f,l,p,d,v;return s(this,function(s){switch(s.label){case 0:n=Ir(t),r=[],i=[],o=0,a=e,s.label=1;case 1:return o<a.length?(c=void 0,(h=n.qh.get(u=a[o]))&&0!==h.length?[4,ac(n.Kc,Ts(h[0]))]:[3,7]):[3,13];case 2:c=s.sent(),f=0,l=h,s.label=3;case 3:return f<l.length?(p=n.Bh.get(l[f]),[4,xh(n,p)]):[3,6];case 4:(d=s.sent()).snapshot&&i.push(d.snapshot),s.label=5;case 5:return f++,[3,3];case 6:return[3,11];case 7:return[4,hc(n.Kc,u)];case 8:return v=s.sent(),[4,ac(n.Kc,v)];case 9:return c=s.sent(),[4,hh(n,Mh(v),u,!1)];case 10:s.sent(),s.label=11;case 11:r.push(c),s.label=12;case 12:return o++,[3,1];case 13:return[2,(n.Lh.Rc(i),r)]}})})}function Mh(t){return gs(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Lh(t){var e=Ir(t);return Ir(Ir(e.Kc).persistence).Ca()}function Rh(t,e,n,r){return o(this,void 0,void 0,function(){var i,o,a;return s(this,function(s){switch(s.label){case 0:return(i=Ir(t)).Hh?(gr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.qh.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,fc(i.Kc)];case 3:return o=s.sent(),a=wi.Yt(e,"current"===n),[4,Ah(i,o,a)];case 4:return s.sent(),[3,8];case 5:return[4,uc(i.Kc,e,!0)];case 6:return s.sent(),_h(i,e,r),[3,8];case 7:wr(),s.label=8;case 8:return[2]}})})}function Vh(t,e,n){return o(this,void 0,void 0,function(){var r,i,o,a,u,c,h,f,l;return s(this,function(p){switch(p.label){case 0:if(!(r=Fh(t)).Hh)return[3,10];i=0,o=e,p.label=1;case 1:return i<o.length?r.qh.has(a=o[i])?(gr("SyncEngine","Adding an already active target "+a),[3,5]):[4,hc(r.Kc,a)]:[3,6];case 2:return u=p.sent(),[4,ac(r.Kc,u)];case 3:return c=p.sent(),[4,hh(r,Mh(u),c.targetId,!1)];case 4:p.sent(),Ic(r.Oh,c),p.label=5;case 5:return i++,[3,1];case 6:h=function(t){return s(this,function(e){switch(e.label){case 0:return r.qh.has(t)?[4,uc(r.Kc,t,!1).then(function(){Ec(r.Oh,t),_h(r,t)}).catch(pc)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},f=0,l=n,p.label=7;case 7:return f<l.length?[5,h(l[f])]:[3,10];case 8:p.sent(),p.label=9;case 9:return f++,[3,7];case 10:return[2]}})})}function Fh(t){var e=Ir(t);return e.Oh.jc.nu=ph.bind(null,e),e.Oh.jc.Be=kh.bind(null,e),e.Oh.jc.eu=vh.bind(null,e),e.Lh.Rc=ga.bind(null,e.Mh),e.Lh.Xh=ya.bind(null,e.Mh),e}function Uh(t){var e=Ir(t);return e.Oh.jc.su=gh.bind(null,e),e.Oh.jc.iu=yh.bind(null,e),e}var jh=function(){function t(){}return t.prototype.za=function(t){this.Zh=t},t.prototype.Ui=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.rn.length||1===t.rn.length&&t.rn[0].field.B())}(e)||n.isEqual(Lr.min())?this.tl(t,e):this.Zh.Li(t,r).next(function(o){var s=i.el(e,o);return(ms(e)||bs(e))&&i.ph(e.limitType,s,r,n)?i.tl(t,e):(vr()<=c.in.DEBUG&&gr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Os(e)),i.Zh.Ui(t,e,n).next(function(t){return s.forEach(function(e){t=t.rt(e.key,e)}),t}))})},t.prototype.el=function(t,e){var n=new oi(Ds(t));return e.forEach(function(e,r){r instanceof ls&&Cs(t,r)&&(n=n.add(r))}),n},t.prototype.ph=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.A(r)>0)},t.prototype.tl=function(t,e){return vr()<=c.in.DEBUG&&gr("IndexFreeQueryEngine","Using full collection scan to execute query:",Os(e)),this.Zh.Ui(t,e,Lr.min())},t}(),qh=function(){function t(t,e){this.Fi=t,this.Lr=e,this.xi=[],this.nl=1,this.sl=new oi(Wc.cu)}return t.prototype.Ur=function(t){return Js.resolve(0===this.xi.length)},t.prototype.Qr=function(t,e,n,r){var i=this.nl;this.nl++;var o=new Aa(i,e,n,r);this.xi.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.sl=this.sl.add(new Wc(u.key,i)),this.Fi.Kr(t,u.key.path.S())}return Js.resolve(o)},t.prototype.Wr=function(t,e){return Js.resolve(this.il(e))},t.prototype.Gr=function(t,e){var n=this.rl(e+1),r=n<0?0:n;return Js.resolve(this.xi.length>r?this.xi[r]:null)},t.prototype.zr=function(){return Js.resolve(0===this.xi.length?-1:this.nl-1)},t.prototype.Hr=function(t){return Js.resolve(this.xi.slice())},t.prototype.Mi=function(t,e){var n=this,r=new Wc(e,0),i=new Wc(e,Number.POSITIVE_INFINITY),o=[];return this.sl.Nt([r,i],function(t){var e=n.il(t.Eu);o.push(e)}),Js.resolve(o)},t.prototype.qi=function(t,e){var n=this,r=new oi(Sr);return e.forEach(function(t){var e=new Wc(t,0),i=new Wc(t,Number.POSITIVE_INFINITY);n.sl.Nt([e,i],function(t){r=r.add(t.Eu)})}),Js.resolve(this.ol(r))},t.prototype.Gi=function(t,e){var n=e.path,r=n.length+1,i=n;jr.G(i)||(i=i.child(""));var o=new Wc(new jr(i),0),s=new oi(Sr);return this.sl.xt(function(t){var e=t.key.path;return!!n.N(e)&&(e.length===r&&(s=s.add(t.Eu)),!0)},o),Js.resolve(this.ol(s))},t.prototype.ol=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.il(t);null!==r&&n.push(r)}),n},t.prototype.Yr=function(t,e){var n=this;_r(0===this.al(e.batchId,"removed")),this.xi.shift();var r=this.sl;return Js.forEach(e.mutations,function(i){var o=new Wc(i.key,e.batchId);return r=r.delete(o),n.Lr.eo(t,i.key)}).next(function(){n.sl=r})},t.prototype.Zr=function(t){},t.prototype.so=function(t,e){var n=new Wc(e,0),r=this.sl.Ft(n);return Js.resolve(e.isEqual(r&&r.key))},t.prototype.no=function(t){return Js.resolve()},t.prototype.al=function(t,e){return this.rl(t)},t.prototype.rl=function(t){return 0===this.xi.length?0:t-this.xi[0].batchId},t.prototype.il=function(t){var e=this.rl(t);return e<0||e>=this.xi.length?null:this.xi[e]},t}(),Bh=function(){function t(t,e){this.Fi=t,this.cl=e,this.docs=new ni(jr.V),this.size=0}return t.prototype.Ri=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.cl(e);return this.docs=this.docs.rt(r,{gi:e,size:s,readTime:n}),this.size+=s-o,this.Fi.Kr(t,r.path.S())},t.prototype.Vi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.yi=function(t,e){var n=this.docs.get(e);return Js.resolve(n?n.gi:null)},t.prototype.getEntries=function(t,e){var n=this,r=ci();return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.gi:null)}),Js.resolve(r)},t.prototype.Ui=function(t,e,n){for(var r=fi(),i=new jr(e.path.child("")),o=this.docs._t(i);o.It();){var s=o.Et(),a=s.value,u=a.gi,c=a.readTime;if(!e.path.N(s.key.path))break;c.A(n)<=0||u instanceof ls&&Cs(e,u)&&(r=r.rt(u.key,u))}return Js.resolve(r)},t.prototype.ul=function(t,e){return Js.forEach(this.docs,function(t){return e(t)})},t.prototype._o=function(t){return new Gh(this)},t.prototype.wo=function(t){return Js.resolve(this.size)},t}(),Gh=function(t){function e(e){var n=this;return(n=t.call(this)||this).To=e,n}return i(e,t),e.prototype.bi=function(t){var e=this,n=[];return this.Ii.forEach(function(r,i){i&&i.gi?n.push(e.To.Ri(t,i.gi,e.Ai(r))):e.To.Vi(r)}),Js.xn(n)},e.prototype.pi=function(t,e){return this.To.yi(t,e)},e.prototype.vi=function(t,e){return this.To.getEntries(t,e)},e}(ka),Kh=function(){function t(t){this.persistence=t,this.hl=new Cr(function(t){return Wr(t)},Hr),this.lastRemoteSnapshotVersion=Lr.min(),this.highestTargetId=0,this.ll=0,this._l=new zc,this.targetCount=0,this.fl=qu.po()}return t.prototype.De=function(t,e){return this.hl.forEach(function(t,n){return e(n)}),Js.resolve()},t.prototype.Co=function(t){return Js.resolve(this.lastRemoteSnapshotVersion)},t.prototype.No=function(t){return Js.resolve(this.ll)},t.prototype.bo=function(t){return this.highestTargetId=this.fl.next(),Js.resolve(this.highestTargetId)},t.prototype.xo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ll&&(this.ll=e),Js.resolve()},t.prototype.Oo=function(t){this.hl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.fl=new qu(e),this.highestTargetId=e),t.sequenceNumber>this.ll&&(this.ll=t.sequenceNumber)},t.prototype.Fo=function(t,e){return this.Oo(e),this.targetCount+=1,Js.resolve()},t.prototype.ko=function(t,e){return this.Oo(e),Js.resolve()},t.prototype.$o=function(t,e){return this.hl.delete(e.target),this._l.du(e.targetId),this.targetCount-=1,Js.resolve()},t.prototype.Nr=function(t,e,n){var r=this,i=0,o=[];return this.hl.forEach(function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.hl.delete(s),o.push(r.Lo(t,a.targetId)),i++)}),Js.xn(o).next(function(){return i})},t.prototype.Bo=function(t){return Js.resolve(this.targetCount)},t.prototype.qo=function(t,e){var n=this.hl.get(e)||null;return Js.resolve(n)},t.prototype.Uo=function(t,e,n){return this._l.lu(e,n),Js.resolve()},t.prototype.Ko=function(t,e,n){this._l.fu(e,n);var r=this.persistence.Lr,i=[];return r&&e.forEach(function(e){i.push(r.eo(t,e))}),Js.xn(i)},t.prototype.Lo=function(t,e){return this._l.du(e),Js.resolve()},t.prototype.jo=function(t,e){var n=this._l.Tu(e);return Js.resolve(n)},t.prototype.so=function(t,e){return Js.resolve(this._l.so(e))},t}(),zh=function(){function t(t){this.serializer=t,this.dl=new Map,this.wl=new Map}return t.prototype.mo=function(t,e){return Js.resolve(this.dl.get(e))},t.prototype.Ao=function(t,e){var n;return this.dl.set(e.id,{id:(n=e).id,version:n.version,createTime:io(n.createTime)}),Js.resolve()},t.prototype.Ro=function(t,e){return Js.resolve(this.wl.get(e))},t.prototype.Po=function(t,e){var n;return this.wl.set(e.name,{name:(n=e).name,query:nu(n.bundledQuery),readTime:io(n.readTime)}),Js.resolve()},t}(),Wh=function(){function t(t,e){var n=this;this.Tl={},this.Jo=new La(0),this.Yo=!1,this.Yo=!0,this.Lr=t(this),this.ra=new Kh(this),this.Fi=new vu,this.Ni=function(t,e){return new Bh(t,function(t){return n.Lr.El(t)})}(this.Fi),this.serializer=new Wa(e),this.oa=new zh(this.serializer)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.pa=function(){return this.Yo=!1,Promise.resolve()},Object.defineProperty(t.prototype,"yr",{get:function(){return this.Yo},enumerable:!1,configurable:!0}),t.prototype.fa=function(){},t.prototype.da=function(){},t.prototype.Oa=function(){return this.Fi},t.prototype.Na=function(t){var e=this.Tl[t.Ys()];return e||(e=new qh(this.Fi,this.Lr),this.Tl[t.Ys()]=e),e},t.prototype.xa=function(){return this.ra},t.prototype.Fa=function(){return this.Ni},t.prototype.Ma=function(){return this.oa},t.prototype.runTransaction=function(t,e,n){var r=this;gr("MemoryPersistence","Starting transaction:",t);var i=new Hh(this.Jo.next());return this.Lr.Il(),n(i).next(function(t){return r.Lr.ml(i).next(function(){return t})}).Cn().then(function(t){return i.Ci(),t})},t.prototype.Al=function(t,e){return Js.Fn(Object.values(this.Tl).map(function(n){return function(){return n.so(t,e)}}))},t}(),Hh=function(t){function e(e){var n=this;return(n=t.call(this)||this).Go=e,n}return i(e,t),e}(Da),Qh=function(){function t(t){this.persistence=t,this.Rl=new zc,this.Pl=null}return t.gl=function(e){return new t(e)},Object.defineProperty(t.prototype,"Vl",{get:function(){if(this.Pl)return this.Pl;throw wr()},enumerable:!1,configurable:!0}),t.prototype.Qo=function(t,e,n){return this.Rl.Qo(n,e),this.Vl.delete(n.toString()),Js.resolve()},t.prototype.Wo=function(t,e,n){return this.Rl.Wo(n,e),this.Vl.add(n.toString()),Js.resolve()},t.prototype.eo=function(t,e){return this.Vl.add(e.toString()),Js.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.Rl.du(e.targetId).forEach(function(t){return n.Vl.add(t.toString())});var r=this.persistence.xa();return r.jo(t,e.targetId).next(function(t){t.forEach(function(t){return n.Vl.add(t.toString())})}).next(function(){return r.$o(t,e)})},t.prototype.Il=function(){this.Pl=new Set},t.prototype.ml=function(t){var e=this,n=this.persistence.Fa()._o();return Js.forEach(this.Vl,function(r){var i=jr.K(r);return e.yl(t,i).next(function(t){t||n.Vi(i)})}).next(function(){return e.Pl=null,n.apply(t)})},t.prototype.qa=function(t,e){var n=this;return this.yl(t,e).next(function(t){t?n.Vl.delete(e.toString()):n.Vl.add(e.toString())})},t.prototype.El=function(t){return 0},t.prototype.yl=function(t,e){var n=this;return Js.Fn([function(){return Js.resolve(n.Rl.so(e))},function(){return n.persistence.xa().so(t,e)},function(){return n.persistence.Al(t,e)}])},t}(),Yh=function(){function t(t){this.pl=t.pl,this.vl=t.vl}return t.prototype.mc=function(t){this.bl=t},t.prototype.dc=function(t){this.Sl=t},t.prototype.onMessage=function(t){this.Dl=t},t.prototype.close=function(){this.vl()},t.prototype.send=function(t){this.pl(t)},t.prototype.Cl=function(){this.bl()},t.prototype.Nl=function(t){this.Sl(t)},t.prototype.xl=function(t){this.Dl(t)},t}(),$h={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Jh=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.i=e.i,n}return i(e,t),e.prototype.Ll=function(t,e,n,r){return new Promise(function(i,o){var s=new hr;s.listenOnce(ur.COMPLETE,function(){try{switch(s.getLastErrorCode()){case ar.NO_ERROR:var e=s.getResponseJson();gr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case ar.TIMEOUT:gr("Connection",'RPC "'+t+'" timed out'),o(new Pr(Dr.DEADLINE_EXCEEDED,"Request time out"));break;case ar.HTTP_ERROR:var n=s.getStatus();if(gr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace("_","-");return Object.values(Dr).indexOf(e)>=0?e:Dr.UNKNOWN}(r.status);o(new Pr(a,r.message))}else o(new Pr(Dr.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Pr(Dr.UNAVAILABLE,"Connection failed."));break;default:wr()}}finally{gr("Connection",'RPC "'+t+'" completed.')}});var a=JSON.stringify(r);s.send(e,"POST",a,n,15)})},e.prototype.Ac=function(t,e){var n=[this.Ol,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new nr,i={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.$l(i.initMessageHeaders,e),(0,h.uI)()||(0,h.b$)()||(0,h.d)()||(0,h.w1)()||(0,h.Mn)()||(0,h.ru)()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");gr("Connection","Creating WebChannel: "+o,i);var s=r.createWebChannel(o,i),a=!1,u=!1,c=new Yh({pl:function(t){u?gr("Connection","Not sending because WebChannel is closed:",t):(a||(gr("Connection","Opening WebChannel transport."),s.open(),a=!0),gr("Connection","WebChannel sending:",t),s.send(t))},vl:function(){return s.close()}}),f=function(t,e){s.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return f(cr.EventType.OPEN,function(){u||gr("Connection","WebChannel transport opened.")}),f(cr.EventType.CLOSE,function(){u||(u=!0,gr("Connection","WebChannel transport closed"),c.Nl())}),f(cr.EventType.ERROR,function(t){u||(u=!0,mr("Connection","WebChannel transport errored:",t),c.Nl(new Pr(Dr.UNAVAILABLE,"The operation could not be completed")))}),f(cr.EventType.MESSAGE,function(t){var e;if(!u){var n=t.data[0];_r(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){gr("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=$r[t];if(void 0!==e)return ei(e)}(i),a=r.message;void 0===o&&(o=Dr.INTERNAL,a="Unknown error status: "+i+" with message "+r.message),u=!0,c.Nl(new Pr(o,a)),s.close()}else gr("Connection","WebChannel received:",n),c.xl(n)}}),setTimeout(function(){c.Cl()},0),c},e}(function(){function t(t){this.Fl=t,this.t=t.t,this.Ol=(t.ssl?"https":"http")+"://"+t.host,this.Ml="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}return t.prototype.xc=function(t,e,n,r){var i=this.kl(t,e);gr("RestConnection","Sending: ",i,n);var o={};return this.$l(o,r),this.Ll(t,i,o,n).then(function(t){return gr("RestConnection","Received: ",t),t},function(e){throw mr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.Fc=function(t,e,n,r){return this.xc(t,e,n,r)},t.prototype.$l=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.0.2",t["Content-Type"]="text/plain",e)for(var n in e.ti)e.ti.hasOwnProperty(n)&&(t[n]=e.ti[n])},t.prototype.kl=function(t,e){return this.Ol+"/v1/"+e+":"+$h[t]},t}()),Xh=function(){function t(){var t=this;this.Bl=function(){return t.ql()},this.Ul=function(){return t.Ql()},this.Kl=[],this.Wl()}return t.prototype.Xc=function(t){this.Kl.push(t)},t.prototype.pa=function(){window.removeEventListener("online",this.Bl),window.removeEventListener("offline",this.Ul)},t.prototype.Wl=function(){window.addEventListener("online",this.Bl),window.addEventListener("offline",this.Ul)},t.prototype.ql=function(){gr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(0)},t.prototype.Ql=function(){gr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(1)},t.kn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Zh=function(){function t(){}return t.prototype.Xc=function(t){},t.prototype.pa=function(){},t}(),tf=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return o(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return this.serializer=xa(t.Fl.t),this.kh=this.jl(t),this.persistence=this.Gl(t),[4,this.persistence.start()];case 1:return e.sent(),this.zl=this.Hl(t),this.Kc=this.Jl(t),[2]}})})},t.prototype.Hl=function(t){return null},t.prototype.Jl=function(t){return ec(this.persistence,new jh,t.Yl,this.serializer)},t.prototype.Gl=function(t){return new Wh(Qh.gl,this.serializer)},t.prototype.jl=function(t){return new nh},t.prototype.terminate=function(){return o(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.kh.pa()];case 1:return t.sent(),[4,this.persistence.pa()];case 2:return t.sent(),[2]}})})},t}(),ef=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return i(e,t),e.prototype.initialize=function(e){return o(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,lc(this.Kc)];case 2:return n.sent(),[4,this.Xl.initialize(this,e)];case 3:return n.sent(),[4,Uh(this.Xl.gu)];case 4:return n.sent(),[4,Lc(this.Xl.Oh)];case 5:return n.sent(),[2]}})})},e.prototype.Jl=function(t){return ec(this.persistence,new jh,t.Yl,this.serializer)},e.prototype.Hl=function(t){return new ja(this.persistence.Lr.Rr,t.rs)},e.prototype.Gl=function(t){var e=Zu(t.Fl.t,t.Fl.persistenceKey),n=void 0!==this.cacheSizeBytes?Ua.Tr(this.cacheSizeBytes):Ua.mr;return new Qu(this.synchronizeTabs,e,t.clientId,n,t.rs,aa(),ua(),this.serializer,this.kh,!!this.forceOwnership)},e.prototype.jl=function(t){return new nh},e}(tf),nf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Xl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return i(e,t),e.prototype.initialize=function(e){return o(this,void 0,void 0,function(){var n,r=this;return s(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Xl.gu,this.kh instanceof eh?(this.kh.gu={_h:Ch.bind(null,n),fh:Rh.bind(null,n),dh:Vh.bind(null,n),Ca:Lh.bind(null,n),lh:Oh.bind(null,n)},[4,this.kh.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence._a(function(t){return o(r,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,Dh(this.Xl.gu,t)];case 1:return e.sent(),this.zl&&(t&&!this.zl.yr?this.zl.start(this.Kc):t||this.zl.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.jl=function(t){var e=aa();if(!eh.kn(e))throw new Pr(Dr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Zu(t.Fl.t,t.Fl.persistenceKey);return new eh(e,t.rs,n,t.clientId,t.Yl)},e}(ef),rf=function(){function t(){}return t.prototype.initialize=function(t,e){return o(this,void 0,void 0,function(){var n=this;return s(this,function(r){switch(r.label){case 0:return this.Kc?[3,2]:(this.Kc=t.Kc,this.kh=t.kh,this.Wc=this.Zl(e),this.Oh=this.t_(e),this.Mh=this.e_(e),this.gu=this.n_(e,!t.synchronizeTabs),this.kh.Oc=function(t){return dh(n.gu,t,1)},this.Oh.jc.s_=Nh.bind(null,this.gu),[4,Bc(this.Oh,this.gu.Jh)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.e_=function(t){return new pa},t.prototype.Zl=function(t){var e=xa(t.Fl.t),n=new Jh(t.Fl);return function(t,e,n){return new yc(t,e,n)}(t.credentials,n,e)},t.prototype.t_=function(t){var e,n,r,i,o,s=this;return e=this.Kc,n=this.Wc,r=t.rs,i=function(t){return dh(s.gu,t,0)},o=Xh.kn()?new Xh:new Zh,new bc(e,n,r,i,o)},t.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){var a=new uh(t,e,n,r,i,o);return s&&(a.Hh=!0),a}(this.Kc,this.Oh,this.Mh,this.kh,t.Yl,t.$h,e)},t.prototype.terminate=function(){return function(t){return o(this,void 0,void 0,function(){var e;return s(this,function(n){switch(n.label){case 0:return e=Ir(t),gr("RemoteStore","RemoteStore shutting down."),e.Hc.add(5),[4,_c(e)];case 1:return n.sent(),e.Yc.pa(),e.Zc.set("Unknown"),[2]}})})}(this.Oh)},t}(),of=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.r_=function(){this.muted=!0},t.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),sf=function(t){this.o_=t};function af(t,e,n){if(!n)throw new Pr(Dr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function uf(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Pr(Dr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function cf(t,e,n,r){if(!0===e&&!0===r)throw new Pr(Dr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function hf(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":wr()}function ff(t,e){if(t instanceof sf&&(t=t.o_),!(t instanceof e)){if(e.name===t.constructor.name)throw new Pr(Dr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=hf(t);throw new Pr(Dr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function lf(t,e){if(e<=0)throw new Pr(Dr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var pf=function(t){this.a_=t},df=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.c_=function(t){if(2!==t.u_)throw t.h_(1===t.u_?this.a_+"() can only appear at the top level of your update data":this.a_+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(pf);function vf(t,e,n){return new qf({u_:3,l_:e.settings.l_,methodName:t.a_,__:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var gf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.c_=function(t){return new Ko(t.path,new Lo)},e.prototype.isEqual=function(t){return t instanceof e},e}(pf),yf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).f_=n,r}return i(e,t),e.prototype.c_=function(t){var e=vf(this,t,!0),n=this.f_.map(function(t){return Hf(t,e)}),r=new Ro(n);return new Ko(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(pf),mf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).f_=n,r}return i(e,t),e.prototype.c_=function(t){var e=vf(this,t,!0),n=this.f_.map(function(t){return Hf(t,e)}),r=new Fo(n);return new Ko(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(pf),bf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).d_=n,r}return i(e,t),e.prototype.c_=function(t){var e=new jo(t.serializer,to(t.serializer,this.d_));return new Ko(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(pf),wf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Pr(Dr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Pr(Dr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.w_=t,this.T_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.w_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.T_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.w_===t.w_&&this.T_===t.T_},t.prototype.toJSON=function(){return{latitude:this.w_,longitude:this.T_}},t.prototype.I=function(t){return Sr(this.w_,t.w_)||Sr(this.T_,t.T_)},t}(),_f=function(){function t(t){this.E_=t}return t.fromBase64String=function(e){try{return new t(Yr.fromBase64String(e))}catch(e){throw new Pr(Dr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(Yr.fromUint8Array(e))},t.prototype.toBase64=function(){return this.E_.toBase64()},t.prototype.toUint8Array=function(){return this.E_.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.E_.isEqual(t.E_)},t}(),If=new Map,Ef=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Pr(Dr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Pr(Dr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,cf("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}();function Tf(){if("undefined"==typeof Uint8Array)throw new Pr(Dr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Sf(){if("undefined"==typeof atob)throw new Pr(Dr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Af=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.fromBase64String=function(t){Sf();try{return new e(Yr.fromBase64String(t))}catch(t){throw new Pr(Dr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},e.fromUint8Array=function(t){return Tf(),new e(Yr.fromUint8Array(t))},e.prototype.toBase64=function(){return Sf(),t.prototype.toBase64.call(this)},e.prototype.toUint8Array=function(){return Tf(),t.prototype.toUint8Array.call(this)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(_f),Nf=function(){function t(){}return t.prototype.I_=function(t,e){switch(void 0===e&&(e="none"),Pi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return qi(t.integerValue||t.doubleValue);case 3:return this.m_(t.timestampValue);case 4:return this.A_(t,e);case 5:return t.stringValue;case 6:return this.R_(Bi(t.bytesValue));case 7:return this.P_(t.referenceValue);case 8:return this.g_(t.geoPointValue);case 9:return this.V_(t.arrayValue,e);case 10:return this.y_(t.mapValue,e);default:throw wr()}},t.prototype.y_=function(t,e){var n=this,r={};return xr(t.fields||{},function(t,i){r[t]=n.I_(i,e)}),r},t.prototype.g_=function(t){return new wf(qi(t.latitude),qi(t.longitude))},t.prototype.V_=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.I_(t,e)})},t.prototype.A_=function(t,e){switch(e){case"previous":var n=Oi(t);return null==n?null:this.I_(n,e);case"estimate":return this.m_(Ci(t));default:return null}},t.prototype.m_=function(t){var e=ji(t);return new Mr(e.seconds,e.nanos)},t.prototype.p_=function(t,e){var n=Vr.k(t);_r(Oo(n));var r=new pr(n.get(1),n.get(3)),i=new jr(n.v(5));return r.isEqual(e)||yr("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),kf=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return i(e,t),e.prototype.R_=function(t){return new Af(t)},e.prototype.P_=function(t){var e=this.p_(t,this.firestore.v_);return Ll.b_(e,this.firestore,null)},e}(Nf),xf=function(){function t(t,e,n,r,i){this.S_=t,this.D_=e,this.C_=n,this.N_=r,this.x_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.C_.path.C()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Pf(this.S_,this.x_,this.C_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.N_},t.prototype.data=function(){if(this.N_){if(this.x_){var t=new Of(this.S_,this.D_,this.C_,this.N_,null);return this.x_.fromFirestore(t)}return this.D_.I_(this.N_.sn())}},t.prototype.get=function(t){if(this.N_){var e=this.N_.data().field(Cf("DocumentSnapshot.get",t));if(null!==e)return this.D_.I_(e)}},t}(),Of=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(xf);function Cf(t,e){return"string"==typeof e?Zf(t,e):e instanceof sf?e.o_.F_:e.F_}var Df=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Pr(Dr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.F_=new Ur(t)}return t.prototype.isEqual=function(t){return this.F_.isEqual(t.F_)},t}(),Pf=function(){function t(t,e,n){this.x_=e,this.C_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"O_",{get:function(){return this.C_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.C_.path.C()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.C_.path.M()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Lf(this.firestore,this.x_,this.C_.path.S())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.C_)},t}(),Mf=function(){function t(t,e,n){this.x_=e,this.M_=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.M_)},t}(),Lf=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,ys(r))||this).firestore=e,i.O_=r,i.type="collection",i}return i(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.M_.path.C()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.M_.path.M()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.O_.S();return t.T()?null:new Pf(this.firestore,null,new jr(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.O_)},e}(Mf);function Rf(t){var e=t.k_(),n=xa(t.v_);return new Bf(t.v_,!!e.ignoreUndefinedProperties,n)}var Vf=/^__.*__$/,Ff=function(){function t(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}return t.prototype.L_=function(t,e){var n=[];return n.push(null!==this.Qe?new es(t,this.data,this.Qe,e):new ts(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new rs(t,this.fieldTransforms)),n},t}(),Uf=function(){function t(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}return t.prototype.L_=function(t,e){var n=[new es(t,this.data,this.Qe,e)];return this.fieldTransforms.length>0&&n.push(new rs(t,this.fieldTransforms)),n},t}();function jf(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw wr()}}var qf=function(){function t(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.B_(),this.fieldTransforms=i||[],this.Qe=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"u_",{get:function(){return this.settings.u_},enumerable:!1,configurable:!0}),t.prototype.q_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},t.prototype.U_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.q_({path:n,__:!1});return r.Q_(t),r},t.prototype.K_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.q_({path:n,__:!1});return r.B_(),r},t.prototype.W_=function(t){return this.q_({path:void 0,__:!0})},t.prototype.h_=function(t){return tl(t,this.settings.methodName,this.settings.j_||!1,this.path,this.settings.l_)},t.prototype.contains=function(t){return void 0!==this.Qe.find(function(e){return t.N(e)})||void 0!==this.fieldTransforms.find(function(e){return t.N(e.field)})},t.prototype.B_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Q_(this.path.get(t))},t.prototype.Q_=function(t){if(0===t.length)throw this.h_("Document fields must not be empty");if(jf(this.u_)&&Vf.test(t))throw this.h_('Document fields cannot begin and end with "__"')},t}(),Bf=function(){function t(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||xa(t)}return t.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new qf({u_:t,methodName:e,l_:n,path:Ur.$(),__:!1,j_:r},this.t,this.serializer,this.ignoreUndefinedProperties)},t}();function Gf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);$f("Data must be an object, but it was:",s,r);var a,u,c=Qf(r,s);if(o.merge)a=new Go(s.Qe),u=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=Jf(e,l[f],n);if(!s.contains(p))throw new Pr(Dr.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");el(h,p)||h.push(p)}a=new Go(h),u=s.fieldTransforms.filter(function(t){return a.He(t.field)})}else a=null,u=s.fieldTransforms;return new Ff(new us(c),a,u)}function Kf(t,e,n,r){var i=t.G_(1,e,n);$f("Data must be an object, but it was:",i,r);var o=[],s=new cs;xr(r,function(t,r){var a=Zf(e,t,n);r instanceof sf&&(r=r.o_);var u=i.K_(a);if(r instanceof df)o.push(a);else{var c=Hf(r,u);null!=c&&(o.push(a),s.set(a,c))}});var a=new Go(o);return new Uf(s.Ye(),a,i.fieldTransforms)}function zf(t,e,n,r,i,o){var s=t.G_(1,e,n),a=[Jf(e,r,n)],u=[i];if(o.length%2!=0)throw new Pr(Dr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(Jf(e,o[c])),u.push(o[c+1]);for(var h=[],f=new cs,l=a.length-1;l>=0;--l)if(!el(h,a[l])){var p=a[l],d=u[l];d instanceof sf&&(d=d.o_);var v=s.K_(p);if(d instanceof df)h.push(p);else{var g=Hf(d,v);null!=g&&(h.push(p),f.set(p,g))}}var y=new Go(h);return new Uf(f.Ye(),y,s.fieldTransforms)}function Wf(t,e,n,r){return void 0===r&&(r=!1),Hf(n,t.G_(r?4:3,e))}function Hf(t,e){if(t instanceof sf&&(t=t.o_),Yf(t))return $f("Unsupported field value:",e,t),Qf(t,e);if(t instanceof pf)return function(t,e){if(!jf(e.u_))throw e.h_(t.a_+"() can only be used with update() and set()");if(!e.path)throw e.h_(t.a_+"() is not currently supported inside arrays");var n=t.c_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.Qe.push(e.path),t instanceof Array){if(e.settings.__&&4!==e.u_)throw e.h_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Hf(o[i],e.W_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof sf&&(t=t.o_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return to(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Mr.fromDate(t);return{timestampValue:eo(e.serializer,n)}}if(t instanceof Mr){var r=new Mr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:eo(e.serializer,r)}}if(t instanceof wf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof _f)return{bytesValue:no(e.serializer,t.E_)};if(t instanceof Pf){var i=e.t,o=t.firestore.v_;if(!o.isEqual(i))throw e.h_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:oo(t.firestore.v_||e.t,t.C_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.h_("Unsupported field value: "+hf(t))}(t,e)}function Qf(t,e){var n={};return Or(t)?e.path&&e.path.length>0&&e.Qe.push(e.path):xr(t,function(t,r){var i=Hf(r,e.U_(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function Yf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Mr||t instanceof wf||t instanceof _f||t instanceof Pf||t instanceof pf)}function $f(t,e,n){if(!Yf(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=hf(n);throw e.h_("an object"===r?t+" a custom object":t+" "+r)}}function Jf(t,e,n){if(e instanceof sf&&(e=e.o_),e instanceof Df)return e.F_;if("string"==typeof e)return Zf(t,e);throw tl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Xf=new RegExp("[~\\*/\\[\\]]");function Zf(t,e,n){if(e.search(Xf)>=0)throw tl("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(Df.bind.apply(Df,a([void 0],e.split("."))))).F_}catch(k){throw tl("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function tl(t,e,n,r,i){var o=r&&!r.T(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new Pr(Dr.INVALID_ARGUMENT,(a+=". ")+t+u)}function el(t,e){return t.some(function(t){return t.isEqual(e)})}var nl=function(){function t(t){this.Wc=t,this.z_=new Map,this.mutations=[],this.H_=!1,this.J_=null,this.Y_=new Set}return t.prototype.X_=function(t){return o(this,void 0,void 0,function(){var e,n=this;return s(this,function(r){switch(r.label){case 0:if(this.Z_(),this.mutations.length>0)throw new Pr(Dr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return o(this,void 0,void 0,function(){var n,r,i,o,a,u;return s(this,function(s){switch(s.label){case 0:return n=Ir(t),r=fo(n.serializer)+"/documents",i={documents:e.map(function(t){return ao(n.serializer,t)})},[4,n.Fc("BatchGetDocuments",r,i)];case 1:return o=s.sent(),a=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){_r(!!e.found);var n=uo(t,e.found.name),r=io(e.found.updateTime),i=new us({mapValue:{fields:e.found.fields}});return new ls(n,r,i,{})}(t,e):"missing"in e?function(t,e){_r(!!e.missing),_r(!!e.readTime);var n=uo(t,e.missing),r=io(e.readTime);return new ps(n,r)}(t,e):wr()}(n.serializer,t);a.set(e.key.toString(),e)}),u=[],[2,(e.forEach(function(t){var e=a.get(t.toString());_r(!!e),u.push(e)}),u)]}})})}(this.Wc,t)];case 1:return[2,((e=r.sent()).forEach(function(t){t instanceof ps||t instanceof ls?n.tf(t):wr()}),e)]}})})},t.prototype.set=function(t,e){this.write(e.L_(t,this.je(t))),this.Y_.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.L_(t,this.ef(t)))}catch(t){this.J_=t}this.Y_.add(t.toString())},t.prototype.delete=function(t){this.write([new ss(t,this.je(t))]),this.Y_.add(t.toString())},t.prototype.commit=function(){return o(this,void 0,void 0,function(){var t,e=this;return s(this,function(n){switch(n.label){case 0:if(this.Z_(),this.J_)throw this.J_;return t=this.z_,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=jr.K(n);e.mutations.push(new as(r,e.je(r)))}),[4,function(t,e){return o(this,void 0,void 0,function(){var n,r,i;return s(this,function(o){switch(o.label){case 0:return n=Ir(t),r=fo(n.serializer)+"/documents",i={writes:e.map(function(t){return vo(n.serializer,t)})},[4,n.xc("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.Wc,this.mutations)];case 1:return n.sent(),this.H_=!0,[2]}})})},t.prototype.tf=function(t){var e;if(t instanceof ls)e=t.version;else{if(!(t instanceof ps))throw wr();e=Lr.min()}var n=this.z_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Pr(Dr.ABORTED,"Document version changed between two reads.")}else this.z_.set(t.key.toString(),e)},t.prototype.je=function(t){var e=this.z_.get(t.toString());return!this.Y_.has(t.toString())&&e?Wo.updateTime(e):Wo.Ge()},t.prototype.ef=function(t){var e=this.z_.get(t.toString());if(!this.Y_.has(t.toString())&&e){if(e.isEqual(Lr.min()))throw new Pr(Dr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Wo.updateTime(e)}return Wo.exists(!0)},t.prototype.write=function(t){this.Z_(),this.mutations=this.mutations.concat(t)},t.prototype.Z_=function(){},t}(),rl=function(){function t(t,e,n,r){this.rs=t,this.Wc=e,this.updateFunction=n,this.us=r,this.nf=5,this.Ps=new $s(this.rs,"transaction_retry")}return t.prototype.run=function(){this.sf()},t.prototype.sf=function(){var t=this;this.Ps.An(function(){return o(t,void 0,void 0,function(){var t,e,n=this;return s(this,function(r){return t=new nl(this.Wc),(e=this.rf(t))&&e.then(function(e){n.rs.fs(function(){return t.commit().then(function(){n.us.resolve(e)}).catch(function(t){n.af(t)})})}).catch(function(t){n.af(t)}),[2]})})})},t.prototype.rf=function(t){try{var e=this.updateFunction(t);return!qr(e)&&e.catch&&e.then?e:(this.us.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.us.reject(t),null}},t.prototype.af=function(t){var e=this;this.nf>0&&this.cf(t)?(this.nf-=1,this.rs.fs(function(){return e.sf(),Promise.resolve()})):this.us.reject(t)},t.prototype.cf=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!ti(e)}return!1},t}(),il=function(){function t(t,e,n){var r=this;this.credentials=t,this.rs=e,this.Fl=n,this.user=wa.UNAUTHENTICATED,this.clientId=Tr.u(),this.uf=function(){},this.oi=new Ys,this.credentials.si(function(t){gr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.uf(t)),r.oi.resolve()})}return t.prototype.getConfiguration=function(){return o(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.oi.promise];case 1:return[2,(t.sent(),{rs:this.rs,Fl:this.Fl,clientId:this.clientId,credentials:this.credentials,Yl:this.user,$h:100})]}})})},t.prototype.hf=function(t){var e=this;this.uf=t,this.oi.promise.then(function(){return e.uf(e.user)})},t.prototype.lf=function(){if(this.rs.Vs)throw new Pr(Dr.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.rs.bs();var e=new Ys;return this.rs.ys(function(){return o(t,void 0,void 0,function(){var t,n;return s(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this._f?[4,this._f.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.ff?[4,this.ff.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.ii(),e.resolve(),[3,6];case 5:return t=r.sent(),n=fa(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}();function ol(t,e){return o(this,void 0,void 0,function(){var n,r=this;return s(this,function(i){switch(i.label){case 0:return t.rs.Ns(),gr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=i.sent(),[4,e.initialize(n)];case 2:return i.sent(),t.hf(function(n){return t.rs.Ss(function(){return o(r,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,nc(e.Kc,n)];case 1:return t.sent(),[2]}})})})}),e.persistence.fa(function(){return t.terminate()}),t.ff=e,[2]}})})}function sl(t,e){return o(this,void 0,void 0,function(){var n,r;return s(this,function(i){switch(i.label){case 0:return t.rs.Ns(),[4,al(t)];case 1:return n=i.sent(),gr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.hf(function(n){return t.rs.Ss(function(){return function(t,e){return o(this,void 0,void 0,function(){var n,r;return s(this,function(i){switch(i.label){case 0:return(n=Ir(t)).rs.Ns(),gr("RemoteStore","RemoteStore received new credentials"),r=kc(n),n.Hc.add(3),[4,_c(n)];case 1:return i.sent(),r&&n.Zc.set("Unknown"),[4,n.jc.s_(e)];case 2:return i.sent(),n.Hc.delete(3),[4,wc(n)];case 3:return i.sent(),[2]}})})}(e.Oh,n)})}),t._f=e,[2]}})})}function al(t){return o(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return t.ff?[3,2]:(gr("FirestoreClient","Using default OfflineComponentProvider"),[4,ol(t,new tf)]);case 1:e.sent(),e.label=2;case 2:return[2,t.ff]}})})}function ul(t){return o(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return t._f?[3,2]:(gr("FirestoreClient","Using default OnlineComponentProvider"),[4,sl(t,new rf)]);case 1:e.sent(),e.label=2;case 2:return[2,t._f]}})})}function cl(t){return al(t).then(function(t){return t.persistence})}function hl(t){return al(t).then(function(t){return t.Kc})}function fl(t){return ul(t).then(function(t){return t.Oh})}function ll(t){return ul(t).then(function(t){return t.gu})}function pl(t){return o(this,void 0,void 0,function(){var e,n;return s(this,function(r){switch(r.label){case 0:return[4,ul(t)];case 1:return e=r.sent(),[2,((n=e.Mh).Ls=ch.bind(null,e.gu),n.Us=fh.bind(null,e.gu),n)]}})})}function dl(t,e){var n=this,r=new Ys;return t.rs.fs(function(){return o(n,void 0,void 0,function(){var n;return s(this,function(i){switch(i.label){case 0:return n=lh,[4,ll(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}function vl(t,e,n){return o(this,void 0,void 0,function(){var r,i,o;return s(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,function(t,e){var n=Ir(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Ga.Oi(t,e)})}(t,e)];case 1:return(r=s.sent())instanceof ls?n.resolve(r):r instanceof ps?n.resolve(null):n.reject(new Pr(Dr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=s.sent(),o=fa(i,"Failed to get document '"+e+" from cache"),n.reject(o),[3,3];case 3:return[2]}})})}function gl(t,e,n,r,i){var o=new of({next:function(o){e.fs(function(){return va(t,s)});var a=o.docs.has(n);!a&&o.fromCache?i.reject(new Pr(Dr.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new Pr(Dr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new ba(ys(n.path),o,{includeMetadataChanges:!0,Hs:!0});return da(t,s)}var yl=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).yf=new ha,r.df="name"in e?e.name:"[DEFAULT]",r}return i(e,t),e.prototype.Vf=function(){return this.pf||Dl(this),this.pf.terminate()},e}(function(){function t(t,e){this.df="(lite)",this.wf=new Ef({}),this.Tf=!1,t instanceof pr?(this.v_=t,this.Ef=new Ia):(this.If=t,this.v_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Pr(Dr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new pr(t.options.projectId)}(t),this.Ef=new Ea(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.If)throw new Pr(Dr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.If},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mf",{get:function(){return this.Tf},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Af",{get:function(){return void 0!==this.Rf},enumerable:!1,configurable:!0}),t.prototype.Pf=function(t){if(this.Tf)throw new Pr(Dr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.wf=new Ef(t),void 0!==t.credentials&&(this.Ef=function(t){if(!t)return new Ia;switch(t.type){case"gapi":var e=t.client;return _r(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Sa(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Pr(Dr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.gf=function(){return this.wf},t.prototype.k_=function(){return this.Tf=!0,this.wf},t.prototype._delete=function(){return this.Rf||(this.Rf=this.Vf()),this.Rf},t.prototype.Vf=function(){return function(t){var e=If.get(t);e&&(gr("ComponentProvider","Removing Datastore"),If.delete(t),e.terminate())}(this),Promise.resolve()},t}());function ml(t,e,n){var r=this,i=new Ys;return t.rs.enqueue(function(){return o(r,void 0,void 0,function(){var r;return s(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,ol(t,n)];case 1:return o.sent(),[4,sl(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Dr.FAILED_PRECONDITION||t.code===Dr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function bl(t){if(t.mf||t.Af)throw new Pr(Dr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var wl=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this).S_=e,a.vf=e,a.metadata=o,a}return i(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.N_){if(this.x_){var e=new _l(this.S_,this.D_,this.C_,this.N_,this.metadata,null);return this.x_.fromFirestore(e,t)}return this.D_.I_(this.N_.sn(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.N_){var n=this.N_.data().field(Cf("DocumentSnapshot.get",t));if(null!==n)return this.D_.I_(n,e.serverTimestamps)}},e}(xf),_l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(wl),Il=function(){function t(t,e,n,r){this.S_=t,this.D_=e,this.bf=r,this.metadata=new Vl(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.bf.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.bf.docs.forEach(function(r){t.call(e,new _l(n.S_,n.D_,r.key,r,new Vl(n.bf.Qt.has(r.key),n.bf.fromCache),n.query.x_))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this.bf.Wt)throw new Pr(Dr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Sf&&this.Df===e||(this.Sf=function(t,e){if(t.bf.Ut.T()){var n=0;return t.bf.docChanges.map(function(e){return{type:"added",doc:new _l(t.S_,t.D_,e.doc.key,e.doc,new Vl(t.bf.Qt.has(e.doc.key),t.bf.fromCache),t.query.x_),oldIndex:-1,newIndex:n++}})}var r=t.bf.Ut;return t.bf.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new _l(t.S_,t.D_,e.doc.key,e.doc,new Vl(t.bf.Qt.has(e.doc.key),t.bf.fromCache),t.query.x_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:El(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this.Df=e),this.Sf},t}();function El(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return wr()}}function Tl(t,e){return t instanceof wl&&e instanceof wl?t.S_===e.S_&&t.C_.isEqual(e.C_)&&(null===t.N_?null===e.N_:t.N_.isEqual(e.N_))&&t.x_===e.x_:t instanceof Il&&e instanceof Il&&t.S_===e.S_&&function(t,e){return t instanceof Mf&&e instanceof Mf&&t.firestore===e.firestore&&ks(t.M_,e.M_)&&t.x_===e.x_}(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.bf.isEqual(e.bf)}var Sl=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return i(e,t),e.prototype.R_=function(t){return new _f(t)},e.prototype.P_=function(t){var e=this.p_(t,this.firestore.v_);return new Pf(this.firestore,null,e)},e}(Nf);function Al(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=ff(t.firestore,yl),s=Rf(o);return e instanceof sf&&(e=e.o_),Nl(o,("string"==typeof e||e instanceof Df?zf(s,"updateDoc",t.C_,e,n,r):Kf(s,"updateDoc",t.C_,e)).L_(t.C_,Wo.exists(!0)))}function Nl(t,e){return dl(Cl(t),e)}function kl(t,e,n){var r=n.docs.get(e.C_),i=new Sl(t);return new wl(t,i,e.C_,r,new Vl(n.hasPendingWrites,n.fromCache),e.x_)}var xl=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){bl(t);var n=Cl(t),r=t.k_(),i=new rf;return ml(n,i,new ef(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.o_,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){bl(t);var e=Cl(t),n=t.k_(),r=new rf;return ml(e,r,new nf(r,n.cacheSizeBytes))}(t.o_)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.mf&&!t.Af)throw new Pr(Dr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Ys;return t.yf.ys(function(){return o(e,void 0,void 0,function(){var e;return s(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return o(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return Xs.kn()?[4,Xs.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(Zu(t.v_,t.df))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t.o_)},t}(),Ol=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).Cf=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof pr||(i.Nf=e),i}return i(e,t),Object.defineProperty(e.prototype,"v_",{get:function(){return this.o_.v_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.o_.gf()),t)).merge,this.o_.Pf(t)},e.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.o_.gf().host&&mr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},e.prototype.enableNetwork=function(){return function(t){var e=this;return t.rs.enqueue(function(){return o(e,void 0,void 0,function(){var e,n;return s(this,function(r){switch(r.label){case 0:return[4,cl(t)];case 1:return e=r.sent(),[4,fl(t)];case 2:return n=r.sent(),[2,(e.da(!0),function(t){var e=Ir(t);return e.Hc.delete(0),wc(e)}(n))]}})})})}(Cl(this.o_))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t.rs.enqueue(function(){return o(e,void 0,void 0,function(){var e,n;return s(this,function(r){switch(r.label){case 0:return[4,cl(t)];case 1:return e=r.sent(),[4,fl(t)];case 2:return n=r.sent(),[2,(e.da(!1),function(t){return o(this,void 0,void 0,function(){var e;return s(this,function(n){switch(n.label){case 0:return(e=Ir(t)).Hc.add(0),[4,_c(e)];case 1:return n.sent(),e.Zc.set("Offline"),[2]}})})}(n))]}})})})}(Cl(this.o_))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&cf("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Cf.enableMultiTabIndexedDbPersistence(this):this.Cf.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Cf.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.o_._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Ys;return t.rs.fs(function(){return o(e,void 0,void 0,function(){var e;return s(this,function(r){switch(r.label){case 0:return e=mh,[4,ll(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(Cl(this.o_))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=Cl(t),i=Oa(e)?e:{next:e},a=new of(i);return t.yf.fs(function(){return o(n,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return t=function(t,e){Ir(t).$s.add(e),e.next()},[4,pl(r)];case 1:return t.apply(void 0,[e.sent(),a]),[2]}})})}),function(){a.r_(),t.yf.fs(function(){return o(n,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return t=function(t,e){Ir(t).$s.delete(e)},[4,pl(r)];case 1:return t.apply(void 0,[e.sent(),a]),[2]}})})})}}(this.o_,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.Nf)throw new Pr(Dr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Nf},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){return af("Firestore.collection","path",t),Cl(this.o_),new Hl(Vr.k(t),this,null)},e.prototype.doc=function(t){return af("Firestore.doc","path",t),Cl(this.o_),Ll.xf(Vr.k(t),this,null)},e.prototype.collectionGroup=function(t){if(af("Firestore.collectionGroup","collectionId",t),t.indexOf("/")>=0)throw new Pr(Dr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return Cl(this.o_),new Kl(function(t){return new vs(Vr.$(),t)}(t),this,null)},e.prototype.runTransaction=function(t){var e=this;return function(t,e){var n=this,r=new Ys;return t.rs.fs(function(){return o(n,void 0,void 0,function(){var n;return s(this,function(i){switch(i.label){case 0:return[4,function(t){return ul(t).then(function(t){return t.Wc})}(t)];case 1:return n=i.sent(),new rl(t.rs,n,e,r).run(),[2]}})})}),r.promise}(Cl(this.o_),function(n){return t(new Pl(e,n))})},e.prototype.batch=function(){return Cl(this.o_),new Ml(this)},e}(sf);function Cl(t){return t.pf||Dl(t),t.pf.lf(),t.pf}function Dl(t){var e=t.k_(),n=function(t,e,n){return new lr(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.v_,t.df,e);t.pf=new il(t.Ef,t.yf,n)}var Pl=function(){function t(t,e){this.S_=t,this.Ff=e,this.Of=Rf(this.S_.o_)}return t.prototype.get=function(t){var e=this,n=Ql(0,t,this.S_),r=new kf(this.S_);return this.Ff.X_([n.C_]).then(function(t){if(!t||1!==t.length)return wr();var i=t[0];if(i instanceof ps)return new Fl(e.S_,new wl(e.S_.o_,r,n.C_,null,new Vl(!1,!1),n.x_));if(i instanceof ls)return new Fl(e.S_,new wl(e.S_.o_,r,n.C_,i,new Vl(!1,!1),n.x_));throw wr()})},t.prototype.set=function(t,e,n){var r=Ql(0,t,this.S_);n=uf("Transaction.set",n);var i=Yl(r.x_,e,n),o=Gf(this.Of,"Transaction.set",r.C_,i,null!==r.x_,n);return this.Ff.set(r.C_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=Ql(0,t,this.S_);return e instanceof sf&&(e=e.o_),o="string"==typeof e||e instanceof Df?zf(this.Of,"Transaction.update",s.C_,e,n,r):Kf(this.Of,"Transaction.update",s.C_,e),this.Ff.update(s.C_,o),this},t.prototype.delete=function(t){var e=Ql(0,t,this.S_);return this.Ff.delete(e.C_),this},t}(),Ml=function(){function t(t){this.S_=t,this.Mf=[],this.kf=!1,this.Of=Rf(this.S_.o_)}return t.prototype.set=function(t,e,n){this.$f();var r=Ql(0,t,this.S_);n=uf("WriteBatch.set",n);var i=Yl(r.x_,e,n),o=Gf(this.Of,"WriteBatch.set",r.C_,i,null!==r.x_,n);return this.Mf=this.Mf.concat(o.L_(r.C_,Wo.Ge())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.$f();var o,s=Ql(0,t,this.S_);return e instanceof sf&&(e=e.o_),o="string"==typeof e||e instanceof Df?zf(this.Of,"WriteBatch.update",s.C_,e,n,r):Kf(this.Of,"WriteBatch.update",s.C_,e),this.Mf=this.Mf.concat(o.L_(s.C_,Wo.exists(!0))),this},t.prototype.delete=function(t){this.$f();var e=Ql(0,t,this.S_);return this.Mf=this.Mf.concat(new ss(e.C_,Wo.Ge())),this},t.prototype.commit=function(){return this.$f(),this.kf=!0,this.Mf.length>0?dl(Cl(this.S_.o_),this.Mf):Promise.resolve()},t.prototype.$f=function(){if(this.kf)throw new Pr(Dr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),Ll=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.D_=new kf(e),r}return i(e,t),e.xf=function(t,n,r){if(t.length%2!=0)throw new Pr(Dr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.M()+" has "+t.length);return new e(n,new Pf(n.o_,r,new jr(t)))},e.b_=function(t,n,r){return new e(n,new Pf(n.o_,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Hl(this.o_.O_.S(),this.firestore,this.o_.x_)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){if(af("DocumentReference.collection","path",t),!t)throw new Pr(Dr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Vr.k(t);return new Hl(this.o_.O_.child(e),this.firestore,null)},e.prototype.isEqual=function(t){return t instanceof sf&&(t=t.o_),t instanceof Pf&&(n=t,((e=this.o_)instanceof Pf||e instanceof Lf)&&(n instanceof Pf||n instanceof Lf)&&e.firestore===n.firestore&&e.path===n.path&&e.x_===n.x_);var e,n},e.prototype.set=function(t,e){e=uf("DocumentReference.set",e);try{return function(t,e,n){var r=ff(t.firestore,yl),i=Yl(t.x_,e,n);return Nl(r,Gf(Rf(r),"setDoc",t.C_,i,null!==t.x_,n).L_(t.C_,Wo.Ge()))}(this.o_,t,e)}catch(t){throw Rl(t,"setDoc","DocumentReference.set")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Al(this.o_,t):Al.apply(void 0,a([this.o_,t,e],n))}catch(t){throw Rl(t,"updateDoc","DocumentReference.update")}},e.prototype.delete=function(){return Nl(ff((t=this.o_).firestore,yl),[new ss(t.C_,Wo.Ge())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Oa(r))return r}return{}}(e),i=function(e,n){var r,i,o;return{next:function(e){o.next&&o.next(function(e){return new Fl(t.firestore,new wl(t.firestore.o_,t.D_,e.C_,e.N_,e.metadata,t.o_.x_))}(e))},error:null===(r=(o=Oa(e[0])?e[0]:Oa(e[1])?e[1]:"function"==typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]}).error)||void 0===r?void 0:r.bind(o),complete:null===(i=o.complete)||void 0===i?void 0:i.bind(o)}}(e);return function(t){for(var e,n,r,i=this,a=[],u=1;u<arguments.length;u++)a[u-1]=arguments[u];var c={includeMetadataChanges:!1},h=0;"object"!=typeof a[h]||Oa(a[h])||(c=a[h],h++);var f,l,p,d={includeMetadataChanges:c.includeMetadataChanges};if(Oa(a[h])){var v=a[h];a[h]=null===(e=v.next)||void 0===e?void 0:e.bind(v),a[h+1]=null===(n=v.error)||void 0===n?void 0:n.bind(v),a[h+2]=null===(r=v.complete)||void 0===r?void 0:r.bind(v)}if(t instanceof Pf)l=ff(t.firestore,yl),p=ys(t.C_.path),f={next:function(e){a[h]&&a[h](kl(l,t,e))},error:a[h+1],complete:a[h+2]};else{l=ff(t.firestore,yl),p=t.M_;var g=new Sl(l);f={next:function(e){a[h]&&a[h](new Il(l,g,t,e))},error:a[h+1],complete:a[h+2]},Gl(t.M_)}var y=Cl(l),m=new of(f),b=new ba(p,m,d);return l.yf.fs(function(){return o(i,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return t=da,[4,pl(y)];case 1:return[2,t.apply(void 0,[e.sent(),b])]}})})}),function(){m.r_(),l.yf.fs(function(){return o(i,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return t=va,[4,pl(y)];case 1:return[2,t.apply(void 0,[e.sent(),b])]}})})})}}(this.o_,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){var e=this,n=ff(t.firestore,yl),r=Cl(n),i=new Sl(n),a=new Ys;return n.yf.fs(function(){return o(e,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,hl(r)];case 1:return[4,vl(e.sent(),t.C_,a)];case 2:return e.sent(),[2]}})})}),a.promise.then(function(e){return new wl(n,i,t.C_,e,new Vl(e instanceof ls&&e.Je,!0),t.x_)})}(this.o_):"server"===(null==t?void 0:t.source)?function(t){var e=this,n=ff(t.firestore,yl),r=Cl(n),i=new Ys;return n.yf.fs(function(){return o(e,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,pl(r)];case 1:return[4,gl(e.sent(),n.yf,t.C_,{source:"server"},i)];case 2:return e.sent(),[2]}})})}),i.promise.then(function(e){return kl(n,t,e)})}(this.o_):function(t){var e=this,n=ff(t.firestore,yl),r=Cl(n),i=new Ys;return n.yf.fs(function(){return o(e,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,pl(r)];case 1:return[4,gl(e.sent(),n.yf,t.C_,{source:"default"},i)];case 2:return e.sent(),[2]}})})}),i.promise.then(function(e){return kl(n,t,e)})}(this.o_)).then(function(t){return new Fl(e.firestore,new wl(e.firestore.o_,e.D_,t.C_,t.N_,t.metadata,e.o_.x_))})},e.prototype.withConverter=function(t){return new e(this.firestore,this.o_.withConverter(t))},e}(sf);function Rl(t,e,n){return t.message=t.message.replace(e+"()",n+"()"),t}var Vl=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Fl=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).S_=e,r}return i(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new Ll(this.S_,this.o_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this.o_.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this.o_.data(t)},e.prototype.get=function(t,e){return this.o_.get(t,e)},e.prototype.isEqual=function(t){return Tl(this.o_,t.o_)},e}(sf),Ul=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.data=function(t){return this.o_.data(t)},e}(Fl);function jl(t,e,n){if(n instanceof sf&&(n=n.o_),"string"==typeof n){if(""===n)throw new Pr(Dr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Is(e)&&-1!==n.indexOf("/"))throw new Pr(Dr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Vr.k(n));if(!jr.G(r))throw new Pr(Dr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Gi(t,new jr(r))}if(n instanceof Pf)return Gi(t,n.C_);throw new Pr(Dr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+hf(n)+".")}function ql(t,e){if(!Array.isArray(t)||0===t.length)throw new Pr(Dr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Pr(Dr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Bl(t,e,n){if(!n.isEqual(e))throw new Pr(Dr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Gl(t){if(bs(t)&&0===t.rn.length)throw new Pr(Dr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Kl=function(){function t(t,e,n){this.M_=t,this.firestore=e,this.x_=n,this.Lf=Rf(e.o_),this.D_=new kf(e)}return t.prototype.where=function(e,n,r){var i=Jf("Query.where",e),o=function(t,e,n,r,i,o,s){var a;if(i.B()){if("array-contains"===o||"array-contains-any"===o)throw new Pr(Dr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){ql(s,o);for(var u=[],c=0,h=s;c<h.length;c++)u.push(jl(r,t,h[c]));a={arrayValue:{values:u}}}else a=jl(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||ql(s,o),a=Wf(n,"Query.where",s,"in"===o||"not-in"===o);var f=Ps.create(i,o,a);return function(t,e){if(e.cn()){var n=_s(t);if(null!==n&&!n.isEqual(e.field))throw new Pr(Dr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=ws(t);null!==r&&Bl(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new Pr(Dr.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(this.M_,0,this.Lf,this.firestore.v_,i,n,r);return new t(function(t,e){var n=t.filters.concat([e]);return new vs(t.path,t.collectionGroup,t.rn.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(this.M_,o),this.firestore,this.x_)},t.prototype.orderBy=function(e,n){var r;if(void 0===n||"asc"===n)r="asc";else{if("desc"!==n)throw new Pr(Dr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r="desc"}var i=Jf("Query.orderBy",e),o=function(t,e,n){if(null!==t.startAt)throw new Pr(Dr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Pr(Dr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Ws(e,n);return function(t,e){if(null===ws(t)){var n=_s(t);null!==n&&Bl(0,n,e.field)}}(t,r),r}(this.M_,i,r);return new t(function(t,e){var n=t.rn.concat([e]);return new vs(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(this.M_,o),this.firestore,this.x_)},t.prototype.limit=function(e){return lf("Query.limit",e),new t(Ss(this.M_,e,"F"),this.firestore,this.x_)},t.prototype.limitToLast=function(e){return lf("Query.limitToLast",e),new t(Ss(this.M_,e,"L"),this.firestore,this.x_)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Bf("Query.startAt",e,n,!0);return new t(As(this.M_,i),this.firestore,this.x_)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Bf("Query.startAfter",e,n,!1);return new t(As(this.M_,i),this.firestore,this.x_)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Bf("Query.endBefore",e,n,!0);return new t(Ns(this.M_,i),this.firestore,this.x_)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Bf("Query.endAt",e,n,!1);return new t(Ns(this.M_,i),this.firestore,this.x_)},t.prototype.isEqual=function(e){return e instanceof t&&this.firestore===e.firestore&&ks(this.M_,e.M_)&&this.x_===e.x_},t.prototype.withConverter=function(e){return new t(this.M_,this.firestore,e)},t.prototype.Bf=function(t,e,n,r){if(e instanceof Fl)return function(t,e,n,r,i){if(!r)throw new Pr(Dr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=Es(t);s<a.length;s++){var u=a[s];if(u.field.B())o.push(Gi(e,r.key));else{var c=r.field(u.field);if(xi(c))throw new Pr(Dr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.M();throw new Pr(Dr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Bs(o,i)}(this.M_,this.firestore.v_,t,e.o_.N_,r);var i=[e].concat(n);return function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new Pr(Dr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.B()){if("string"!=typeof c)throw new Pr(Dr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Is(t)&&-1!==c.indexOf("/"))throw new Pr(Dr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Vr.k(c));if(!jr.G(h))throw new Pr(Dr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new jr(h);a.push(Gi(e,f))}else{var l=Wf(n,r,c);a.push(l)}}return new Bs(a,o)}(this.M_,this.firestore.v_,this.Lf,t,i,r)},t.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var u={},c=0;if("object"!=typeof i[c]||Oa(i[c])||(u=i[c],c++),Oa(i[c])){var h=i[c];i[c]=null===(t=h.next)||void 0===t?void 0:t.bind(h),i[c+1]=null===(e=h.error)||void 0===e?void 0:e.bind(h),i[c+2]=null===(n=h.complete)||void 0===n?void 0:n.bind(h)}var f={next:function(t){i[c]&&i[c](new Wl(r.firestore,new Il(r.firestore.o_,r.D_,new Mf(r.firestore.o_,r.x_,r.M_),t)))},error:i[c+1],complete:i[c+2]};return Gl(this.M_),function(t,e,n,r){var i=this,a=new of(r),u=new ba(e,a,n);return t.rs.fs(function(){return o(i,void 0,void 0,function(){var e;return s(this,function(n){switch(n.label){case 0:return e=da,[4,pl(t)];case 1:return[2,e.apply(void 0,[n.sent(),u])]}})})}),function(){a.r_(),t.rs.fs(function(){return o(i,void 0,void 0,function(){var e;return s(this,function(n){switch(n.label){case 0:return e=va,[4,pl(t)];case 1:return[2,e.apply(void 0,[n.sent(),u])]}})})})}}(Cl(this.firestore.o_),this.M_,u,f)},t.prototype.get=function(t){var e=this;Gl(this.M_);var n=Cl(this.firestore.o_);return(t&&"cache"===t.source?function(t,e){var n=this,r=new Ys;return t.rs.fs(function(){return o(n,void 0,void 0,function(){var n;return s(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return o(this,void 0,void 0,function(){var r,i,o,a,u,c;return s(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,cc(t,e,!0)];case 1:return r=s.sent(),i=new oh(e,r.Xa),o=i.gh(r.documents),a=i.bi(o,!1),n.resolve(a.snapshot),[3,3];case 2:return u=s.sent(),c=fa(u,"Failed to execute query '"+e+" against cache"),n.reject(c),[3,3];case 3:return[2]}})})},[4,hl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,this.M_):function(t,e,n){var r=this;void 0===n&&(n={});var i=new Ys;return t.rs.fs(function(){return o(r,void 0,void 0,function(){var r;return s(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new of({next:function(n){e.fs(function(){return va(t,s)}),n.fromCache&&"server"===r.source?i.reject(new Pr(Dr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new ba(n,o,{includeMetadataChanges:!0,Hs:!0});return da(t,s)},[4,pl(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.rs,e,n,i])]}})})}),i.promise}(n,this.M_,t)).then(function(t){return new Wl(e.firestore,new Il(e.firestore.o_,e.D_,new Mf(e.firestore.o_,e.x_,e.M_),t))})},t}(),zl=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).S_=e,r}return i(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.o_.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new Ul(this.S_,this.o_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this.o_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this.o_.oldIndex},enumerable:!1,configurable:!0}),e}(sf),Wl=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).S_=e,r}return i(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new Kl(this.o_.query.M_,this.S_,this.o_.query.x_)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.o_.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this.o_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this.o_.docs.map(function(e){return new Ul(t.S_,e)})},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this.o_.docChanges(t).map(function(t){return new zl(e.S_,t)})},e.prototype.forEach=function(t,e){var n=this;this.o_.forEach(function(r){t.call(e,new Ul(n.S_,r))})},e.prototype.isEqual=function(t){return Tl(this.o_,t.o_)},e}(sf),Hl=function(t){function e(e,n,r){var i=this;if((i=t.call(this,ys(e),n,r)||this).O_=e,e.length%2!=1)throw new Pr(Dr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.M()+" has "+e.length);return i}return i(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.M_.path.C()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.M_.path.S();return t.T()?null:Ll.xf(t,this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.M_.path.M()},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){0===arguments.length&&(t=Tr.u()),af("CollectionReference.doc","path",t);var e=Vr.k(t);return Ll.xf(this.M_.path.child(e),this.firestore,this.x_)},e.prototype.add=function(t){var e=this.x_?this.x_.toFirestore(t):t,n=this.doc();return Ll.b_(n.o_.C_,this.firestore,null).set(e).then(function(){return n})},e.prototype.withConverter=function(t){return new e(this.O_,this.firestore,t)},e}(Kl);function Ql(t,e,n){var r=ff(e,Pf);if(r.firestore!==n.o_)throw new Pr(Dr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}function Yl(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var $l=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(Df.bind.apply(Df,a([void 0],e))))||this}return i(e,t),e.documentId=function(){return new e(Ur.q().M())},e.prototype.isEqual=function(t){return t instanceof sf&&(t=t.o_),t instanceof Df&&this.o_.F_.isEqual(t.F_)},e}(sf),Jl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.serverTimestamp=function(){var t=new gf("serverTimestamp");return t.a_="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new df("deleteField");return t.a_="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new yf("arrayUnion",t)}).apply(void 0,t);return r.a_="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new mf("arrayRemove",t)}).apply(void 0,t);return r.a_="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new bf("increment",t)}(t);return n.a_="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},e}(sf),Xl={Firestore:Ol,GeoPoint:wf,Timestamp:Mr,Blob:Af,Transaction:Pl,WriteBatch:Ml,DocumentReference:Ll,DocumentSnapshot:Fl,Query:Kl,QueryDocumentSnapshot:Ul,QuerySnapshot:Wl,CollectionReference:Hl,FieldPath:$l,FieldValue:Jl,setLogLevel:function(t){dr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function Zl(t){!function(t,e){t.INTERNAL.registerComponent(new fr.wA("firestore",function(t){return function(t,e){return new Ol(t,new yl(t,e),new xl)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},Xl)))}(t),t.registerVersion("@firebase/firestore","2.0.2")}Zl(u.Z)},6676:function(t,e){!function(t){"use strict";function e(t){return Array.prototype.slice.call(t)}function n(t){return new Promise(function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function r(t,e,r){var i,o=new Promise(function(o,s){n(i=t[e].apply(t,r)).then(o,s)});return o.request=i,o}function i(t,e,n){var i=r(t,e,n);return i.then(function(t){if(t)return new h(t,i.request)})}function o(t,e,n){n.forEach(function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})})}function s(t,e,n,i){i.forEach(function(i){i in n.prototype&&(t.prototype[i]=function(){return r(this[e],i,arguments)})})}function a(t,e,n,r){r.forEach(function(r){r in n.prototype&&(t.prototype[r]=function(){return this[e][r].apply(this[e],arguments)})})}function u(t,e,n,r){r.forEach(function(r){r in n.prototype&&(t.prototype[r]=function(){return i(this[e],r,arguments)})})}function c(t){this._index=t}function h(t,e){this._cursor=t,this._request=e}function f(t){this._store=t}function l(t){this._tx=t,this.complete=new Promise(function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}})}function p(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new l(n)}function d(t){this._db=t}o(c,"_index",["name","keyPath","multiEntry","unique"]),s(c,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),u(c,"_index",IDBIndex,["openCursor","openKeyCursor"]),o(h,"_cursor",["direction","key","primaryKey","value"]),s(h,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(t){t in IDBCursor.prototype&&(h.prototype[t]=function(){var e=this,r=arguments;return Promise.resolve().then(function(){return e._cursor[t].apply(e._cursor,r),n(e._request).then(function(t){if(t)return new h(t,e._request)})})})}),f.prototype.createIndex=function(){return new c(this._store.createIndex.apply(this._store,arguments))},f.prototype.index=function(){return new c(this._store.index.apply(this._store,arguments))},o(f,"_store",["name","keyPath","indexNames","autoIncrement"]),s(f,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),u(f,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),a(f,"_store",IDBObjectStore,["deleteIndex"]),l.prototype.objectStore=function(){return new f(this._tx.objectStore.apply(this._tx,arguments))},o(l,"_tx",["objectStoreNames","mode"]),a(l,"_tx",IDBTransaction,["abort"]),p.prototype.createObjectStore=function(){return new f(this._db.createObjectStore.apply(this._db,arguments))},o(p,"_db",["name","version","objectStoreNames"]),a(p,"_db",IDBDatabase,["deleteObjectStore","close"]),d.prototype.transaction=function(){return new l(this._db.transaction.apply(this._db,arguments))},o(d,"_db",["name","version","objectStoreNames"]),a(d,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(t){[f,c].forEach(function(n){t in n.prototype&&(n.prototype[t.replace("open","iterate")]=function(){var n=e(arguments),r=n[n.length-1],i=this._store||this._index,o=i[t].apply(i,n.slice(0,-1));o.onsuccess=function(){r(o.result)}})})}),[c,f].forEach(function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,r=[];return new Promise(function(i){n.iterateCursor(t,function(t){t?(r.push(t.value),void 0===e||r.length!=e?t.continue():i(r)):i(r)})})})}),t.openDb=function(t,e,n){var i=r(indexedDB,"open",[t,e]),o=i.request;return o&&(o.onupgradeneeded=function(t){n&&n(new p(o.result,t.oldVersion,o.transaction))}),i.then(function(t){return new d(t)})},t.deleteDb=function(t){return r(indexedDB,"deleteDatabase",[t])},Object.defineProperty(t,"__esModule",{value:!0})}(e)},6847:function(t,e,n){"use strict";n.d(e,{$:function(){return cr}});var r=n(4762),i=n(6232),o=(n(6423),n(514),n(9383),function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)});function s(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}u((r=r.apply(t,e||[])).next())})}function a(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}var u=n(8308),c={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},h=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(Error),f=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then(function(t){return n.auth=t},function(){}),this.messaging||e.get().then(function(t){return n.messaging=t},function(){})}return t.prototype.getAuthToken=function(){return s(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 3:return e.sent(),[2,void 0];case 4:return[2]}})})},t.prototype.getInstanceIdToken=function(){return s(this,void 0,void 0,function(){return a(this,function(t){if(!this.messaging||!("Notification"in self)||"granted"!==Notification.permission)return[2,void 0];try{return[2,this.messaging.getToken()]}catch(e){return[2,void 0]}return[2]})})},t.prototype.getContext=function(){return s(this,void 0,void 0,function(){var t,e;return a(this,function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}})})},t}();function l(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var p,d,v,g=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(Array.isArray(t))return t.map(function(t){return e.encode(t)});if("function"==typeof t||"object"==typeof t)return l(t,function(t){return e.encode(t)});throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(function(t){return e.decode(t)}):"function"==typeof t||"object"==typeof t?l(t,function(t){return e.decode(t)}):t},t}(),y=function(){function t(t,e,n,r,i){var o=this;void 0===r&&(r="us-central1"),this.app_=t,this.fetchImpl=i,this.serializer=new g,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(o.deleteService())}},this.contextProvider=new f(e,n),this.cancelAllRequests=new Promise(function(t){o.deleteService=function(){return t()}});try{var s=new URL(r);this.customDomain=s.origin,this.region="us-central1"}catch(a){this.customDomain=null,this.region=r}}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+this.region+"/"+t:null!==this.customDomain?this.customDomain+"/"+t:"https://"+this.region+"-"+e+".cloudfunctions.net/"+t},t.prototype.useEmulator=function(t,e){this.emulatorOrigin="http://"+t+":"+e},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t,e){var n=this;return function(r){return n.call(t,r,e||{})}},t.prototype.postJSON=function(t,e,n){return s(this,void 0,void 0,function(){var r,i;return a(this,function(o){switch(o.label){case 0:n["Content-Type"]="application/json",o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.fetchImpl(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 2:return r=o.sent(),[3,4];case 3:return o.sent(),[2,{status:0,json:null}];case 4:i=null,o.label=5;case 5:return o.trys.push([5,7,,8]),[4,r.json()];case 6:return i=o.sent(),[3,8];case 7:return o.sent(),[3,8];case 8:return[2,{status:r.status,json:i}]}})})},t.prototype.call=function(t,e,n){return s(this,void 0,void 0,function(){var r,i,o,s,u,f,l,p,d,v;return a(this,function(a){switch(a.label){case 0:return r=this._url(t),e=this.serializer.encode(e),i={data:e},o={},[4,this.contextProvider.getContext()];case 1:return(s=a.sent()).authToken&&(o.Authorization="Bearer "+s.authToken),s.instanceIdToken&&(o["Firebase-Instance-ID-Token"]=s.instanceIdToken),u=function(t){var e,n=new Promise(function(n,r){e=setTimeout(function(){r(new h("deadline-exceeded","deadline-exceeded"))},t)});return{timer:e,promise:n}}(n.timeout||7e4),f=u.timer,l=u.promise,[4,Promise.race([m(f,this.postJSON(r,i,o)),l,m(f,this.cancelAllRequests)])];case 2:if(!(p=a.sent()))throw new h("cancelled","Firebase Functions instance was deleted.");if(d=function(t,e,n){var r=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),i=r,o=void 0;try{var s=e&&e.error;if(s){var a=s.status;if("string"==typeof a){if(!c[a])return new h("internal","internal");r=c[a],i=a}var u=s.message;"string"==typeof u&&(i=u),void 0!==(o=s.details)&&(o=n.decode(o))}}catch(f){}return"ok"===r?null:new h(r,i,o)}(p.status,p.json,this.serializer))throw d;if(!p.json)throw new h("internal","Response is not valid JSON object.");if(void 0===(v=p.json.data)&&(v=p.json.result),void 0===v)throw new h("internal","Response is missing data field.");return[2,{data:this.serializer.decode(v)}]}})})},t}();function m(t,e){return s(this,void 0,void 0,function(){var n;return a(this,function(r){switch(r.label){case 0:return[4,e];case 1:return n=r.sent(),clearTimeout(t),[2,n]}})})}p=i.Z,d=fetch.bind(self),v={Functions:y},p.INTERNAL.registerComponent(new u.wA("functions",function(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("messaging");return new y(n,r,i,e,d)},"PUBLIC").setServiceProps(v).setMultipleInstances(!0)),i.Z.registerVersion("@firebase/functions","0.6.1");var b=function(){return(b=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function w(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}u((r=r.apply(t,e||[])).next())})}function _(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function I(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function E(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}var T,S=n(3701),A=n(6676),N=((T={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',T["not-registered"]="Firebase Installation is not registered.",T["installation-not-found"]="Firebase Installation not found.",T["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',T["app-offline"]="Could not process request. Application offline.",T["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",T),k=new S.LL("installations","Installations",N);function x(t){return t instanceof S.ZR&&t.code.includes("request-failed")}function O(t){return"https://firebaseinstallations.googleapis.com/v1/projects/"+t.projectId+"/installations"}function C(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}function D(t,e){return w(this,void 0,void 0,function(){var n,r;return _(this,function(i){switch(i.label){case 0:return[4,e.json()];case 1:return n=i.sent(),[2,k.create("request-failed",{requestName:t,serverCode:(r=n.error).code,serverMessage:r.message,serverStatus:r.status})]}})})}function P(t){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey})}function M(t,e){var n=e.refreshToken,r=P(t);return r.append("Authorization",function(t){return"FIS_v2 "+t}(n)),r}function L(t){return w(this,void 0,void 0,function(){var e;return _(this,function(n){switch(n.label){case 0:return[4,t()];case 1:return(e=n.sent()).status>=500&&e.status<600?[2,t()]:[2,e]}})})}function R(t,e){var n=e.fid;return w(this,void 0,void 0,function(){var e,r,i,o,s;return _(this,function(a){switch(a.label){case 0:return e=O(t),r=P(t),i={method:"POST",headers:r,body:JSON.stringify({fid:n,authVersion:"FIS_v2",appId:t.appId,sdkVersion:"w:0.4.19"})},[4,L(function(){return fetch(e,i)})];case 1:return(o=a.sent()).ok?[4,o.json()]:[3,3];case 2:return[2,{fid:(s=a.sent()).fid||n,registrationStatus:2,refreshToken:s.refreshToken,authToken:C(s.authToken)}];case 3:return[4,D("Create Installation",o)];case 4:throw a.sent()}})})}function V(t){return new Promise(function(e){setTimeout(e,t)})}var F=/^[cdef][\w-]{21}$/;function U(){try{var t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;var e=function(t){return(e=t,btoa(String.fromCharCode.apply(String,function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(E(arguments[e]));return t}(e))).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var e}(t);return F.test(e)?e:""}catch(T){return""}}function j(t){return t.appName+"!"+t.appId}var q=new Map;function B(t,e){var n=j(t);G(n,e),function(t,e){var n=z();n&&n.postMessage({key:t,fid:e}),W()}(n,e)}function G(t,e){var n,r,i=q.get(t);if(i)try{for(var o=I(i),s=o.next();!s.done;s=o.next())(0,s.value)(e)}catch(a){n={error:a}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}var K=null;function z(){return!K&&"BroadcastChannel"in self&&((K=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(t){G(t.data.key,t.data.fid)}),K}function W(){0===q.size&&K&&(K.close(),K=null)}var H="firebase-installations-store",Q=null;function Y(){return Q||(Q=(0,A.openDb)("firebase-installations-database",1,function(t){switch(t.oldVersion){case 0:t.createObjectStore(H)}})),Q}function $(t,e){return w(this,void 0,void 0,function(){var n,r,i,o,s;return _(this,function(a){switch(a.label){case 0:return n=j(t),[4,Y()];case 1:return r=a.sent(),i=r.transaction(H,"readwrite"),[4,(o=i.objectStore(H)).get(n)];case 2:return s=a.sent(),[4,o.put(e,n)];case 3:return a.sent(),[4,i.complete];case 4:return a.sent(),s&&s.fid===e.fid||B(t,e.fid),[2,e]}})})}function J(t){return w(this,void 0,void 0,function(){var e,n,r;return _(this,function(i){switch(i.label){case 0:return e=j(t),[4,Y()];case 1:return n=i.sent(),[4,(r=n.transaction(H,"readwrite")).objectStore(H).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}})})}function X(t,e){return w(this,void 0,void 0,function(){var n,r,i,o,s,a;return _(this,function(u){switch(u.label){case 0:return n=j(t),[4,Y()];case 1:return r=u.sent(),i=r.transaction(H,"readwrite"),[4,(o=i.objectStore(H)).get(n)];case 2:return s=u.sent(),void 0!==(a=e(s))?[3,4]:[4,o.delete(n)];case 3:return u.sent(),[3,6];case 4:return[4,o.put(a,n)];case 5:u.sent(),u.label=6;case 6:return[4,i.complete];case 7:return u.sent(),!a||s&&s.fid===a.fid||B(t,a.fid),[2,a]}})})}function Z(t){return w(this,void 0,void 0,function(){var e,n,r;return _(this,function(i){switch(i.label){case 0:return[4,X(t,function(n){var r=function(t){return nt(t||{fid:U(),registrationStatus:0})}(n),i=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(k.create("app-offline"))};var n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:n,registrationPromise:function(t,e){return w(this,void 0,void 0,function(){var n,r;return _(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,7]),[4,R(t,e)];case 1:return n=i.sent(),[2,$(t,n)];case 2:return x(r=i.sent())&&409===r.customData.serverCode?[4,J(t)]:[3,4];case 3:return i.sent(),[3,6];case 4:return[4,$(t,{fid:e.fid,registrationStatus:0})];case 5:i.sent(),i.label=6;case 6:throw r;case 7:return[2]}})})}(t,n)}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:tt(t)}:{installationEntry:e}}(t,r);return e=i.registrationPromise,i.installationEntry})];case 1:return""!==(n=i.sent()).fid?[3,3]:(r={},[4,e]);case 2:return[2,(r.installationEntry=i.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:e}]}})})}function tt(t){return w(this,void 0,void 0,function(){var e,n,r,i;return _(this,function(o){switch(o.label){case 0:return[4,et(t)];case 1:e=o.sent(),o.label=2;case 2:return 1!==e.registrationStatus?[3,5]:[4,V(100)];case 3:return o.sent(),[4,et(t)];case 4:return e=o.sent(),[3,2];case 5:return 0!==e.registrationStatus?[3,7]:[4,Z(t)];case 6:return n=o.sent(),r=n.installationEntry,(i=n.registrationPromise)?[2,i]:[2,r];case 7:return[2,e]}})})}function et(t){return X(t,function(t){if(!t)throw k.create("installation-not-found");return nt(t)})}function nt(t){return 1===(e=t).registrationStatus&&e.registrationTime+1e4<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}function rt(t,e){var n=t.appConfig,r=t.platformLoggerProvider;return w(this,void 0,void 0,function(){var t,i,o,s,a;return _(this,function(u){switch(u.label){case 0:return t=function(t,e){var n=e.fid;return O(t)+"/"+n+"/authTokens:generate"}(n,e),i=M(n,e),(o=r.getImmediate({optional:!0}))&&i.append("x-firebase-client",o.getPlatformInfoString()),s={method:"POST",headers:i,body:JSON.stringify({installation:{sdkVersion:"w:0.4.19"}})},[4,L(function(){return fetch(t,s)})];case 1:return(a=u.sent()).ok?[4,a.json()]:[3,3];case 2:return[2,C(u.sent())];case 3:return[4,D("Generate Auth Token",a)];case 4:throw u.sent()}})})}function it(t,e){return void 0===e&&(e=!1),w(this,void 0,void 0,function(){var n,r,i;return _(this,function(o){switch(o.label){case 0:return[4,X(t.appConfig,function(r){if(!st(r))throw k.create("not-registered");var i,o=r.authToken;if(!e&&2===(i=o).requestStatus&&!function(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+36e5}(i))return r;if(1===o.requestStatus)return n=function(t,e){return w(this,void 0,void 0,function(){var n,r;return _(this,function(i){switch(i.label){case 0:return[4,ot(t.appConfig)];case 1:n=i.sent(),i.label=2;case 2:return 1!==n.authToken.requestStatus?[3,5]:[4,V(100)];case 3:return i.sent(),[4,ot(t.appConfig)];case 4:return n=i.sent(),[3,2];case 5:return 0===(r=n.authToken).requestStatus?[2,it(t,e)]:[2,r]}})})}(t,e),r;if(!navigator.onLine)throw k.create("app-offline");var s=function(t){var e={requestStatus:1,requestTime:Date.now()};return b(b({},t),{authToken:e})}(r);return n=function(t,e){return w(this,void 0,void 0,function(){var n,r,i;return _(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,8]),[4,rt(t,e)];case 1:return n=o.sent(),i=b(b({},e),{authToken:n}),[4,$(t.appConfig,i)];case 2:return o.sent(),[2,n];case 3:return!x(r=o.sent())||401!==r.customData.serverCode&&404!==r.customData.serverCode?[3,5]:[4,J(t.appConfig)];case 4:return o.sent(),[3,7];case 5:return i=b(b({},e),{authToken:{requestStatus:0}}),[4,$(t.appConfig,i)];case 6:o.sent(),o.label=7;case 7:throw r;case 8:return[2]}})})}(t,s),s})];case 1:return r=o.sent(),n?[4,n]:[3,3];case 2:return i=o.sent(),[3,4];case 3:i=r.authToken,o.label=4;case 4:return[2,i]}})})}function ot(t){return X(t,function(t){if(!st(t))throw k.create("not-registered");var e;return 1===(e=t.authToken).requestStatus&&e.requestTime+1e4<Date.now()?b(b({},t),{authToken:{requestStatus:0}}):t})}function st(t){return void 0!==t&&2===t.registrationStatus}function at(t){return w(this,void 0,void 0,function(){var e;return _(this,function(n){switch(n.label){case 0:return[4,Z(t)];case 1:return(e=n.sent().registrationPromise)?[4,e]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}})})}function ut(t,e){return w(this,void 0,void 0,function(){var n,r,i,o;return _(this,function(s){switch(s.label){case 0:return n=function(t,e){var n=e.fid;return O(t)+"/"+n}(t,e),r=M(t,e),i={method:"DELETE",headers:r},[4,L(function(){return fetch(n,i)})];case 1:return(o=s.sent()).ok?[3,3]:[4,D("Delete Installation",o)];case 2:throw s.sent();case 3:return[2]}})})}function ct(t){return k.create("missing-app-config-values",{valueName:t})}!function(t){t.INTERNAL.registerComponent(new u.wA("installations",function(t){var e=t.getProvider("app").getImmediate(),n={appConfig:function(t){var e,n;if(!t||!t.options)throw ct("App Configuration");if(!t.name)throw ct("App Name");try{for(var r=I(["projectId","apiKey","appId"]),i=r.next();!i.done;i=r.next()){var o=i.value;if(!t.options[o])throw ct(o)}}catch(s){e={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e),platformLoggerProvider:t.getProvider("platform-logger")};return{app:e,getId:function(){return function(t){return w(this,void 0,void 0,function(){var e,n,r;return _(this,function(i){switch(i.label){case 0:return[4,Z(t.appConfig)];case 1:return e=i.sent(),n=e.installationEntry,(r=e.registrationPromise)?r.catch(console.error):it(t).catch(console.error),[2,n.fid]}})})}(n)},getToken:function(t){return function(t,e){return void 0===e&&(e=!1),w(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return[4,at(t.appConfig)];case 1:return n.sent(),[4,it(t,e)];case 2:return[2,n.sent().token]}})})}(n,t)},delete:function(){return function(t){return w(this,void 0,void 0,function(){var e,n;return _(this,function(r){switch(r.label){case 0:return[4,X(e=t.appConfig,function(t){if(!t||0!==t.registrationStatus)return t})];case 1:if(!(n=r.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw k.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw k.create("app-offline");case 3:return[4,ut(e,n)];case 4:return r.sent(),[4,J(e)];case 5:r.sent(),r.label=6;case 6:return[2]}})})}(n)},onIdChange:function(t){return function(t,e){var n=t.appConfig;return function(t,e){z();var n=j(t),r=q.get(n);r||(r=new Set,q.set(n,r)),r.add(e)}(n,e),function(){!function(t,e){var n=j(t),r=q.get(n);r&&(r.delete(e),0===r.size&&q.delete(n),W())}(n,e)}}(n,t)}}},"PUBLIC")),t.registerVersion("@firebase/installations","0.4.19")}(i.Z);var ht,ft=function(){return(ft=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function lt(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}u((r=r.apply(t,e||[])).next())})}function pt(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function dt(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function vt(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}var gt=((ht={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',ht["only-available-in-window"]="This method is available in a Window context.",ht["only-available-in-sw"]="This method is available in a service worker context.",ht["permission-default"]="The notification permission was not granted and dismissed instead.",ht["permission-blocked"]="The notification permission was not granted and blocked instead.",ht["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",ht["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",ht["token-subscribe-failed"]="A problem occurred while subscribing the user to FCM: {$errorInfo}",ht["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",ht["token-unsubscribe-failed"]="A problem occurred while unsubscribing the user from FCM: {$errorInfo}",ht["token-update-failed"]="A problem occurred while updating the user from FCM: {$errorInfo}",ht["token-update-no-token"]="FCM returned no token when updating the user to push.",ht["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",ht["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",ht["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",ht["invalid-vapid-key"]="The public VAPID key must be a string.",ht["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",ht),yt=new S.LL("messaging","Messaging",gt),mt="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",bt=(()=>(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"}(bt||(bt={})),bt))();function wt(t){var e=new Uint8Array(t);return btoa(String.fromCharCode.apply(String,function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(vt(arguments[e]));return t}(e))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function _t(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(e),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}function It(t){return lt(this,void 0,void 0,function(){var e,n=this;return pt(this,function(r){switch(r.label){case 0:return"databases"in indexedDB?[4,indexedDB.databases()]:[3,2];case 1:if(!r.sent().map(function(t){return t.name}).includes("fcm_token_details_db"))return[2,null];r.label=2;case 2:return e=null,[4,(0,A.openDb)("fcm_token_details_db",5,function(r){return lt(n,void 0,void 0,function(){var n,i,o,s;return pt(this,function(a){switch(a.label){case 0:return r.oldVersion<2?[2]:r.objectStoreNames.contains("fcm_token_object_Store")?[4,(n=r.transaction.objectStore("fcm_token_object_Store")).index("fcmSenderId").get(t)]:[2];case 1:return i=a.sent(),[4,n.clear()];case 2:if(a.sent(),!i)return[2];if(2===r.oldVersion){if(!(o=i).auth||!o.p256dh||!o.endpoint)return[2];e={token:o.fcmToken,createTime:null!==(s=o.createTime)&&void 0!==s?s:Date.now(),subscriptionOptions:{auth:o.auth,p256dh:o.p256dh,endpoint:o.endpoint,swScope:o.swScope,vapidKey:"string"==typeof o.vapidKey?o.vapidKey:wt(o.vapidKey)}}}else(3===r.oldVersion||4===r.oldVersion)&&(e={token:(o=i).fcmToken,createTime:o.createTime,subscriptionOptions:{auth:wt(o.auth),p256dh:wt(o.p256dh),endpoint:o.endpoint,swScope:o.swScope,vapidKey:wt(o.vapidKey)}});return[2]}})})})];case 3:return r.sent().close(),[4,(0,A.deleteDb)("fcm_token_details_db")];case 4:return r.sent(),[4,(0,A.deleteDb)("fcm_vapid_details_db")];case 5:return r.sent(),[4,(0,A.deleteDb)("undefined")];case 6:return r.sent(),[2,Et(e)?e:null]}})})}function Et(t){if(!t||!t.subscriptionOptions)return!1;var e=t.subscriptionOptions;return"number"==typeof t.createTime&&t.createTime>0&&"string"==typeof t.token&&t.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}var Tt=null;function St(){return Tt||(Tt=(0,A.openDb)("firebase-messaging-database",1,function(t){switch(t.oldVersion){case 0:t.createObjectStore("firebase-messaging-store")}})),Tt}function At(t){return lt(this,void 0,void 0,function(){var e,n,r;return pt(this,function(i){switch(i.label){case 0:return e=xt(t),[4,St()];case 1:return[4,i.sent().transaction("firebase-messaging-store").objectStore("firebase-messaging-store").get(e)];case 2:return(n=i.sent())?[2,n]:[3,3];case 3:return[4,It(t.appConfig.senderId)];case 4:return(r=i.sent())?[4,Nt(t,r)]:[3,6];case 5:return i.sent(),[2,r];case 6:return[2]}})})}function Nt(t,e){return lt(this,void 0,void 0,function(){var n,r,i;return pt(this,function(o){switch(o.label){case 0:return n=xt(t),[4,St()];case 1:return r=o.sent(),[4,(i=r.transaction("firebase-messaging-store","readwrite")).objectStore("firebase-messaging-store").put(e,n)];case 2:return o.sent(),[4,i.complete];case 3:return o.sent(),[2,e]}})})}function kt(t){return lt(this,void 0,void 0,function(){var e,n,r;return pt(this,function(i){switch(i.label){case 0:return e=xt(t),[4,St()];case 1:return n=i.sent(),[4,(r=n.transaction("firebase-messaging-store","readwrite")).objectStore("firebase-messaging-store").delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}})})}function xt(t){return t.appConfig.appId}function Ot(t,e){return lt(this,void 0,void 0,function(){var n,r,i,o,s;return pt(this,function(a){switch(a.label){case 0:return[4,Mt(t)];case 1:n=a.sent(),r=Lt(e),i={method:"POST",headers:n,body:JSON.stringify(r)},a.label=2;case 2:return a.trys.push([2,5,,6]),[4,fetch(Pt(t.appConfig),i)];case 3:return[4,a.sent().json()];case 4:return o=a.sent(),[3,6];case 5:throw s=a.sent(),yt.create("token-subscribe-failed",{errorInfo:s});case 6:if(o.error)throw yt.create("token-subscribe-failed",{errorInfo:o.error.message});if(!o.token)throw yt.create("token-subscribe-no-token");return[2,o.token]}})})}function Ct(t,e){return lt(this,void 0,void 0,function(){var n,r,i,o,s;return pt(this,function(a){switch(a.label){case 0:return[4,Mt(t)];case 1:n=a.sent(),r=Lt(e.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)},a.label=2;case 2:return a.trys.push([2,5,,6]),[4,fetch(Pt(t.appConfig)+"/"+e.token,i)];case 3:return[4,a.sent().json()];case 4:return o=a.sent(),[3,6];case 5:throw s=a.sent(),yt.create("token-update-failed",{errorInfo:s});case 6:if(o.error)throw yt.create("token-update-failed",{errorInfo:o.error.message});if(!o.token)throw yt.create("token-update-no-token");return[2,o.token]}})})}function Dt(t,e){return lt(this,void 0,void 0,function(){var n,r,i,o;return pt(this,function(s){switch(s.label){case 0:return[4,Mt(t)];case 1:n=s.sent(),r={method:"DELETE",headers:n},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(Pt(t.appConfig)+"/"+e,r)];case 3:return[4,s.sent().json()];case 4:if((i=s.sent()).error)throw yt.create("token-unsubscribe-failed",{errorInfo:i.error.message});return[3,6];case 5:throw o=s.sent(),yt.create("token-unsubscribe-failed",{errorInfo:o});case 6:return[2]}})})}function Pt(t){return"https://fcmregistrations.googleapis.com/v1/projects/"+t.projectId+"/registrations"}function Mt(t){var e=t.appConfig,n=t.installations;return lt(this,void 0,void 0,function(){var t;return pt(this,function(r){switch(r.label){case 0:return[4,n.getToken()];case 1:return t=r.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":"FIS "+t})]}})})}function Lt(t){var e=t.vapidKey,n={web:{endpoint:t.endpoint,auth:t.auth,p256dh:t.p256dh}};return e!==mt&&(n.web.applicationPubKey=e),n}function Rt(t,e,n){return lt(this,void 0,void 0,function(){var r,i,o,s;return pt(this,function(a){switch(a.label){case 0:if("granted"!==Notification.permission)throw yt.create("permission-blocked");return[4,jt(e,n)];case 1:return r=a.sent(),[4,At(t)];case 2:return i=a.sent(),o={vapidKey:n,swScope:e.scope,endpoint:r.endpoint,auth:wt(r.getKey("auth")),p256dh:wt(r.getKey("p256dh"))},i?[3,3]:[2,Ut(t,o)];case 3:if(h=(c=o).endpoint===(u=i.subscriptionOptions).endpoint,c.vapidKey===u.vapidKey&&h&&c.auth===u.auth&&c.p256dh===u.p256dh)return[3,8];a.label=4;case 4:return a.trys.push([4,6,,7]),[4,Dt(t,i.token)];case 5:return a.sent(),[3,7];case 6:return s=a.sent(),console.warn(s),[3,7];case 7:return[2,Ut(t,o)];case 8:return Date.now()>=i.createTime+6048e5?[2,Ft({token:i.token,createTime:Date.now(),subscriptionOptions:o},t,e)]:[2,i.token];case 9:return[2]}var u,c,h})})}function Vt(t,e){return lt(this,void 0,void 0,function(){var n,r;return pt(this,function(i){switch(i.label){case 0:return[4,At(t)];case 1:return(n=i.sent())?[4,Dt(t,n.token)]:[3,4];case 2:return i.sent(),[4,kt(t)];case 3:i.sent(),i.label=4;case 4:return[4,e.pushManager.getSubscription()];case 5:return(r=i.sent())?[2,r.unsubscribe()]:[2,!0]}})})}function Ft(t,e,n){return lt(this,void 0,void 0,function(){var r,i,o;return pt(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,,5]),[4,Ct(e,t)];case 1:return r=s.sent(),i=ft(ft({},t),{token:r,createTime:Date.now()}),[4,Nt(e,i)];case 2:return s.sent(),[2,r];case 3:return o=s.sent(),[4,Vt(e,n)];case 4:throw s.sent(),o;case 5:return[2]}})})}function Ut(t,e){return lt(this,void 0,void 0,function(){var n,r;return pt(this,function(i){switch(i.label){case 0:return[4,Ot(t,e)];case 1:return n=i.sent(),r={token:n,createTime:Date.now(),subscriptionOptions:e},[4,Nt(t,r)];case 2:return i.sent(),[2,r.token]}})})}function jt(t,e){return lt(this,void 0,void 0,function(){var n;return pt(this,function(r){switch(r.label){case 0:return[4,t.pushManager.getSubscription()];case 1:return(n=r.sent())?[2,n]:[2,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:_t(e)})]}})})}function qt(t){return"object"==typeof t&&!!t&&"google.c.a.c_id"in t}function Bt(t){return new Promise(function(e){setTimeout(e,t)})}var Gt=function(){function t(t){var e=this;this.firebaseDependencies=t,this.isOnBackgroundMessageUsed=null,this.vapidKey=null,this.bgMessageHandler=null,self.addEventListener("push",function(t){t.waitUntil(e.onPush(t))}),self.addEventListener("pushsubscriptionchange",function(t){t.waitUntil(e.onSubChange(t))}),self.addEventListener("notificationclick",function(t){t.waitUntil(e.onNotificationClick(t))})}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.setBackgroundMessageHandler=function(t){if(this.isOnBackgroundMessageUsed=!1,!t||"function"!=typeof t)throw yt.create("invalid-bg-handler");this.bgMessageHandler=t},t.prototype.onBackgroundMessage=function(t){var e=this;return this.isOnBackgroundMessageUsed=!0,this.bgMessageHandler=t,function(){e.bgMessageHandler=null}},t.prototype.getToken=function(){var t,e;return lt(this,void 0,void 0,function(){var n;return pt(this,function(r){switch(r.label){case 0:return this.vapidKey?[3,2]:[4,At(this.firebaseDependencies)];case 1:n=r.sent(),this.vapidKey=null!==(e=null===(t=null==n?void 0:n.subscriptionOptions)||void 0===t?void 0:t.vapidKey)&&void 0!==e?e:mt,r.label=2;case 2:return[2,Rt(this.firebaseDependencies,self.registration,this.vapidKey)]}})})},t.prototype.deleteToken=function(){return Vt(this.firebaseDependencies,self.registration)},t.prototype.requestPermission=function(){throw yt.create("only-available-in-window")},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw yt.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw yt.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(){throw yt.create("only-available-in-window")},t.prototype.onMessage=function(){throw yt.create("only-available-in-window")},t.prototype.onTokenRefresh=function(){throw yt.create("only-available-in-window")},t.prototype.onPush=function(t){return lt(this,void 0,void 0,function(){var e,n,r,i;return pt(this,function(o){switch(o.label){case 0:return(e=function(t){var e=t.data;if(!e)return null;try{return e.json()}catch(n){return null}}(t))?[4,Ht()]:(console.debug("FirebaseMessaging: failed to get parsed MessagePayload from the PushEvent. Skip handling the push."),[2]);case 1:return function(t){return t.some(function(t){return"visible"===t.visibilityState&&!t.url.startsWith("chrome-extension://")})}(n=o.sent())?[2,Wt(n,e)]:(r=!1,e.notification?[4,Qt(Kt(e))]:[3,3]);case 2:o.sent(),r=!0,o.label=3;case 3:return!0===r&&!1===this.isOnBackgroundMessageUsed?[2]:(this.bgMessageHandler&&(i=function(t){var e={from:t.from,collapseKey:t.collapse_key};return function(t,e){if(e.notification){t.notification={};var n=e.notification.title;n&&(t.notification.title=n);var r=e.notification.body;r&&(t.notification.body=r);var i=e.notification.image;i&&(t.notification.image=i)}}(e,t),function(t,e){e.data&&(t.data=e.data)}(e,t),function(t,e){if(e.fcmOptions){t.fcmOptions={};var n=e.fcmOptions.link;n&&(t.fcmOptions.link=n);var r=e.fcmOptions.analytics_label;r&&(t.fcmOptions.analyticsLabel=r)}}(e,t),e}(e),"function"==typeof this.bgMessageHandler?this.bgMessageHandler(i):this.bgMessageHandler.next(i)),[4,Bt(1e3)]);case 4:return o.sent(),[2]}})})},t.prototype.onSubChange=function(t){var e,n;return lt(this,void 0,void 0,function(){var r;return pt(this,function(i){switch(i.label){case 0:return t.newSubscription?[3,2]:[4,Vt(this.firebaseDependencies,self.registration)];case 1:return i.sent(),[2];case 2:return[4,At(this.firebaseDependencies)];case 3:return r=i.sent(),[4,Vt(this.firebaseDependencies,self.registration)];case 4:return i.sent(),[4,Rt(this.firebaseDependencies,self.registration,null!==(n=null===(e=null==r?void 0:r.subscriptionOptions)||void 0===e?void 0:e.vapidKey)&&void 0!==n?n:mt)];case 5:return i.sent(),[2]}})})},t.prototype.onNotificationClick=function(t){var e,n;return lt(this,void 0,void 0,function(){var r,i,o,s,a;return pt(this,function(u){switch(u.label){case 0:return(r=null===(n=null===(e=t.notification)||void 0===e?void 0:e.data)||void 0===n?void 0:n.FCM_MSG)?t.action?[2]:(t.stopImmediatePropagation(),t.notification.close(),(i=function(t){var e,n,r;return(null!==(n=null===(e=t.fcmOptions)||void 0===e?void 0:e.link)&&void 0!==n?n:null===(r=t.notification)||void 0===r?void 0:r.click_action)||(qt(t.data)?self.location.origin:null)}(r))?(o=new URL(i,self.location.href),s=new URL(self.location.origin),o.host!==s.host?[2]:[4,zt(o)]):[2]):[2];case 1:return(a=u.sent())?[3,4]:[4,self.clients.openWindow(i)];case 2:return a=u.sent(),[4,Bt(3e3)];case 3:return u.sent(),[3,6];case 4:return[4,a.focus()];case 5:a=u.sent(),u.label=6;case 6:return a?(r.messageType=bt.NOTIFICATION_CLICKED,r.isFirebaseMessaging=!0,[2,a.postMessage(r)]):[2]}})})},t}();function Kt(t){var e,n=ft({},t.notification);return n.data=((e={}).FCM_MSG=t,e),n}function zt(t){return lt(this,void 0,void 0,function(){var e,n,r,i,o,s,a;return pt(this,function(u){switch(u.label){case 0:return[4,Ht()];case 1:e=u.sent();try{for(n=dt(e),r=n.next();!r.done;r=n.next())if(i=r.value,o=new URL(i.url,self.location.href),t.host===o.host)return[2,i]}catch(c){s={error:c}}finally{try{r&&!r.done&&(a=n.return)&&a.call(n)}finally{if(s)throw s.error}}return[2,null]}})})}function Wt(t,e){var n,r;e.isFirebaseMessaging=!0,e.messageType=bt.PUSH_RECEIVED;try{for(var i=dt(t),o=i.next();!o.done;o=i.next())o.value.postMessage(e)}catch(s){n={error:s}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}function Ht(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function Qt(t){var e,n=t.actions,r=Notification.maxActions;return n&&r&&n.length>r&&console.warn("This browser only supports "+r+" actions. The remaining actions will not be displayed."),self.registration.showNotification(null!==(e=t.title)&&void 0!==e?e:"",t)}var Yt=function(){function t(t){var e=this;this.firebaseDependencies=t,this.vapidKey=null,this.onMessageCallback=null,navigator.serviceWorker.addEventListener("message",function(t){return e.messageEventListener(t)})}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.messageEventListener=function(t){return lt(this,void 0,void 0,function(){var e,n;return pt(this,function(r){switch(r.label){case 0:return(e=t.data).isFirebaseMessaging?(this.onMessageCallback&&e.messageType===bt.PUSH_RECEIVED&&("function"==typeof this.onMessageCallback?this.onMessageCallback(function(t){return delete t.messageType,delete t.isFirebaseMessaging,t}(Object.assign({},e))):this.onMessageCallback.next(Object.assign({},e))),qt(n=e.data)&&"1"===n["google.c.a.e"]?[4,this.logEvent(e.messageType,n)]:[3,2]):[2];case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.getVapidKey=function(){return this.vapidKey},t.prototype.getSwReg=function(){return this.swRegistration},t.prototype.getToken=function(t){return lt(this,void 0,void 0,function(){return pt(this,function(e){switch(e.label){case 0:return"default"!==Notification.permission?[3,2]:[4,Notification.requestPermission()];case 1:e.sent(),e.label=2;case 2:if("granted"!==Notification.permission)throw yt.create("permission-blocked");return[4,this.updateVapidKey(null==t?void 0:t.vapidKey)];case 3:return e.sent(),[4,this.updateSwReg(null==t?void 0:t.serviceWorkerRegistration)];case 4:return e.sent(),[2,Rt(this.firebaseDependencies,this.swRegistration,this.vapidKey)]}})})},t.prototype.updateVapidKey=function(t){return lt(this,void 0,void 0,function(){return pt(this,function(e){return t?this.vapidKey=t:this.vapidKey||(this.vapidKey=mt),[2]})})},t.prototype.updateSwReg=function(t){return lt(this,void 0,void 0,function(){return pt(this,function(e){switch(e.label){case 0:return t||this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:e.sent(),e.label=2;case 2:if(!t&&this.swRegistration)return[2];if(!(t instanceof ServiceWorkerRegistration))throw yt.create("invalid-sw-registration");return this.swRegistration=t,[2]}})})},t.prototype.registerDefaultSw=function(){return lt(this,void 0,void 0,function(){var t,e;return pt(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this,[4,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"})];case 1:return t.swRegistration=n.sent(),this.swRegistration.update().catch(function(){}),[3,3];case 2:throw e=n.sent(),yt.create("failed-service-worker-registration",{browserErrorMessage:e.message});case 3:return[2]}})})},t.prototype.deleteToken=function(){return lt(this,void 0,void 0,function(){return pt(this,function(t){switch(t.label){case 0:return this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:t.sent(),t.label=2;case 2:return[2,Vt(this.firebaseDependencies,this.swRegistration)]}})})},t.prototype.requestPermission=function(){return lt(this,void 0,void 0,function(){var t;return pt(this,function(e){switch(e.label){case 0:return"granted"===Notification.permission?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(t=e.sent()))return[2];throw yt.create("denied"===t?"permission-blocked":"permission-default")}})})},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw yt.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw yt.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw yt.create("invalid-sw-registration");if(this.swRegistration)throw yt.create("use-sw-after-get-token");this.swRegistration=t},t.prototype.onMessage=function(t){var e=this;return this.onMessageCallback=t,function(){e.onMessageCallback=null}},t.prototype.setBackgroundMessageHandler=function(){throw yt.create("only-available-in-sw")},t.prototype.onBackgroundMessage=function(){throw yt.create("only-available-in-sw")},t.prototype.onTokenRefresh=function(){return function(){}},t.prototype.logEvent=function(t,e){return lt(this,void 0,void 0,function(){var n;return pt(this,function(r){switch(r.label){case 0:return n=function(t){switch(t){case bt.NOTIFICATION_CLICKED:return"notification_open";case bt.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t),[4,this.firebaseDependencies.analyticsProvider.get()];case 1:return r.sent().logEvent(n,{message_id:e["google.c.a.c_id"],message_name:e["google.c.a.c_l"],message_time:e["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)}),[2]}})})},t}();function $t(t){return yt.create("missing-app-config-values",{valueName:t})}var Jt={isSupported:Xt};function Xt(){return self&&"ServiceWorkerGlobalScope"in self?"indexedDB"in self&&null!==indexedDB&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"indexedDB"in window&&null!==indexedDB&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}i.Z.INTERNAL.registerComponent(new u.wA("messaging",function(t){var e=t.getProvider("app").getImmediate(),n={app:e,appConfig:function(t){var e,n;if(!t||!t.options)throw $t("App Configuration Object");if(!t.name)throw $t("App Name");var r=t.options;try{for(var i=dt(["projectId","apiKey","appId","messagingSenderId"]),o=i.next();!o.done;o=i.next()){var s=o.value;if(!r[s])throw $t(s)}}catch(a){e={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return{appName:t.name,projectId:r.projectId,apiKey:r.apiKey,appId:r.appId,senderId:r.messagingSenderId}}(e),installations:t.getProvider("installations").getImmediate(),analyticsProvider:t.getProvider("analytics-internal")};if(!Xt())throw yt.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new Gt(n):new Yt(n)},"PUBLIC").setServiceProps(Jt)),n(6035);var Zt=function(){return(Zt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function te(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}var ee,ne,re,ie=n(300),oe=((ee={})["trace started"]="Trace {$traceName} was started before.",ee["trace stopped"]="Trace {$traceName} is not running.",ee["nonpositive trace startTime"]="Trace {$traceName} startTime should be positive.",ee["nonpositive trace duration"]="Trace {$traceName} duration should be positive.",ee["no window"]="Window is not available.",ee["no app id"]="App id is not available.",ee["no project id"]="Project id is not available.",ee["no api key"]="Api key is not available.",ee["invalid cc log"]="Attempted to queue invalid cc event",ee["FB not default"]="Performance can only start when Firebase app instance is the default one.",ee["RC response not ok"]="RC response is not ok",ee["invalid attribute name"]="Attribute name {$attributeName} is invalid.",ee["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",ee["invalid custom metric name"]="Custom metric name {$customMetricName} is invalid",ee["invalid String merger input"]="Input for String merger is invalid, contact support team to resolve.",ee),se=new S.LL("performance","Performance",oe),ae=new ie.Yd("Performance");ae.logLevel=ie.in.INFO;var ue,ce=function(){function t(t){if(this.window=t,!t)throw se.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}return t.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},t.prototype.mark=function(t){this.performance&&this.performance.mark&&this.performance.mark(t)},t.prototype.measure=function(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)},t.prototype.getEntriesByType=function(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]},t.prototype.getEntriesByName=function(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]},t.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},t.prototype.requiredApisAvailable=function(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?!!(0,S.hl)()||(ae.info("IndexedDB is not supported by current browswer"),!1):(ae.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)},t.prototype.setupObserver=function(t,e){this.PerformanceObserver&&new this.PerformanceObserver(function(t){for(var n=0,r=t.getEntries();n<r.length;n++)e(r[n])}).observe({entryTypes:[t]})},t.getInstance=function(){return void 0===ne&&(ne=new t(re)),ne},t}();function he(t,e){var n=t.length-e.length;if(n<0||n>1)throw se.create("invalid String merger input");for(var r=[],i=0;i<t.length;i++)r.push(t.charAt(i)),e.length>i&&r.push(e.charAt(i));return r.join("")}var fe,le=function(){function t(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=he("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=he("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return t.prototype.getAppId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!t)throw se.create("no app id");return t},t.prototype.getProjectId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!t)throw se.create("no project id");return t},t.prototype.getApiKey=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!t)throw se.create("no api key");return t},t.prototype.getFlTransportFullUrl=function(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)},t.getInstance=function(){return void 0===ue&&(ue=new t),ue},t}();function pe(){return fe}var de=(()=>(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN"}(de||(de={})),de))(),ve=["firebase_","google_","ga_"],ge=new RegExp("^[a-zA-Z]\\w*$");function ye(){var t=ce.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function me(){switch(ce.getInstance().document.visibilityState){case"visible":return de.VISIBLE;case"hidden":return de.HIDDEN;default:return de.UNKNOWN}}function be(){var t=ce.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function we(t){if(!t)return t;var e=le.getInstance(),n=t.entries||{};return e.loggingEnabled=void 0===n.fpr_enabled||"true"===String(n.fpr_enabled),n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(e.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=_e(e.tracesSamplingRate),e.logNetworkAfterSampling=_e(e.networkRequestsSamplingRate),t}function _e(t){return Math.random()<=t}var Ie,Ee=1;function Te(){return Ee=2,Ie=Ie||function(){var t=ce.getInstance().document;return new Promise(function(e){if(t&&"complete"!==t.readyState){var n=function(){"complete"===t.readyState&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()})}().then(function(){return(t=le.getInstance().installationsService.getId()).then(function(t){fe=t}),t;var t}).then(function(t){return function(t){var e=function(){var t=ce.getInstance().localStorage;if(t){var e=t.getItem("@firebase/performance/configexpire");if(e&&Number(e)>Date.now()){var n=t.getItem("@firebase/performance/config");if(n)try{return JSON.parse(n)}catch(T){return}}}}();return e?(we(e),Promise.resolve()):function(t){return(e=le.getInstance().installationsService.getToken(),e.then(function(t){}),e).then(function(e){var n="https://firebaseremoteconfig.googleapis.com/v1/projects/"+le.getInstance().getProjectId()+"/namespaces/fireperf:fetch?key="+le.getInstance().getApiKey(),r=new Request(n,{method:"POST",headers:{Authorization:"FIREBASE_INSTALLATIONS_AUTH "+e},body:JSON.stringify({app_instance_id:t,app_instance_id_token:e,app_id:le.getInstance().getAppId(),app_version:"0.4.4",sdk_version:"0.0.1"})});return fetch(r).then(function(t){if(t.ok)return t.json();throw se.create("RC response not ok")})}).catch(function(){ae.info("Could not fetch config, will use default configs")});var e}(t).then(we).then(function(t){return function(t){var e=ce.getInstance().localStorage;t&&e&&(e.setItem("@firebase/performance/config",JSON.stringify(t)),e.setItem("@firebase/performance/configexpire",String(Date.now()+60*le.getInstance().configTimeToLive*60*1e3)))}(t)},function(){})}(t)}).then(function(){return Se()},function(){return Se()})}function Se(){Ee=3}var Ae,Ne=3,ke=[],xe=!1;function Oe(t){setTimeout(function(){if(0!==Ne)return ke.length?void function(){var t=te(ke);ke=[];var e=t.map(function(t){return{source_extension_json_proto3:t.message,event_time_ms:String(t.eventTime)}});(function(t,e){return function(t){var e=le.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}(t).then(function(t){return t.ok||ae.info("Call to Firebase backend failed."),t.json()}).then(function(t){var n=Number(t.nextRequestWaitMillis),r=1e4;isNaN(n)||(r=Math.max(n,r));var i=t.logResponseDetails;Array.isArray(i)&&i.length>0&&"RETRY_REQUEST_LATER"===i[0].responseAction&&(ke=te(e,ke),ae.info("Retry transport request later.")),Ne=3,Oe(r)})})({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:le.getInstance().logSource,log_event:e},t).catch(function(){ke=te(t,ke),Ne--,ae.info("Tries left: "+Ne+"."),Oe(1e4)})}():Oe(1e4)},t)}function Ce(t){if(!t.eventTime||!t.message)throw se.create("invalid cc log");ke=te(ke,[t])}function De(t,e){Ae||(Ae=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Ce({message:t.apply(void 0,e),eventTime:Date.now()})}}(Le)),Ae(t,e)}function Pe(t){var e=le.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&ce.getInstance().requiredApisAvailable()&&(t.isAuto&&me()!==de.VISIBLE||(3===Ee?Me(t):Te().then(function(){return Me(t)},function(){return Me(t)})))}function Me(t){if(pe()){var e=le.getInstance();e.loggingEnabled&&e.logTraceAfterSampling&&setTimeout(function(){return De(t,1)},0)}}function Le(t,e){return 0===e?(r={url:(n=t).url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},i={application_info:Re(),network_request_metric:r},JSON.stringify(i)):function(t){var e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=t.counters);var n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=n);var r={application_info:Re(),trace_metric:e};return JSON.stringify(r)}(t);var n,r,i}function Re(){return{google_app_id:le.getInstance().getAppId(),app_instance_id:pe(),web_app_info:{sdk_version:"0.4.4",page_url:ce.getInstance().getUrl(),service_worker_status:ye(),visibility_state:me(),effective_connection_type:be()},application_process_state:0}}var Ve=["_fp","_fcp","_fid"],Fe=function(){function t(t,e,n){void 0===e&&(e=!1),this.name=t,this.isAuto=e,this.state=1,this.customAttributes={},this.counters={},this.api=ce.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark="FB-PERF-TRACE-START-"+this.randomId+"-"+this.name,this.traceStopMark="FB-PERF-TRACE-STOP-"+this.randomId+"-"+this.name,this.traceMeasure=n||"FB-PERF-TRACE-MEASURE-"+this.randomId+"-"+this.name,n&&this.calculateTraceMetrics())}return t.prototype.start=function(){if(1!==this.state)throw se.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},t.prototype.stop=function(){if(2!==this.state)throw se.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Pe(this)},t.prototype.record=function(t,e,n){if(t<=0)throw se.create("nonpositive trace startTime",{traceName:this.name});if(e<=0)throw se.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=Zt({},n.attributes)),n&&n.metrics)for(var r=0,i=Object.keys(n.metrics);r<i.length;r++){var o=i[r];isNaN(Number(n.metrics[o]))||(this.counters[o]=Number(Math.floor(n.metrics[o])))}Pe(this)},t.prototype.incrementMetric=function(t,e){void 0===e&&(e=1),this.putMetric(t,void 0===this.counters[t]?e:this.counters[t]+e)},t.prototype.putMetric=function(t,e){if(o=this.name,0===(i=t).length||i.length>100||!(o&&o.startsWith("_wt_")&&Ve.indexOf(i)>-1)&&i.startsWith("_"))throw se.create("invalid custom metric name",{customMetricName:t});var n,r,i,o;this.counters[t]=(n=e,(r=Math.floor(n))<n&&ae.info("Metric value should be an Integer, setting the value as : "+r+"."),r)},t.prototype.getMetric=function(t){return this.counters[t]||0},t.prototype.putAttribute=function(t,e){var n,r=!(0===(n=t).length||n.length>40||ve.some(function(t){return n.startsWith(t)})||!n.match(ge)),i=function(t){return 0!==t.length&&t.length<=100}(e);if(r&&i)this.customAttributes[t]=e;else{if(!r)throw se.create("invalid attribute name",{attributeName:t});if(!i)throw se.create("invalid attribute value",{attributeValue:e})}},t.prototype.getAttribute=function(t){return this.customAttributes[t]},t.prototype.removeAttribute=function(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]},t.prototype.getAttributes=function(){return Zt({},this.customAttributes)},t.prototype.setStartTime=function(t){this.startTimeUs=t},t.prototype.setDuration=function(t){this.durationUs=t},t.prototype.calculateTraceMetrics=function(){var t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))},t.createOobTrace=function(e,n,r){var i=ce.getInstance().getUrl();if(i){var o=new t("_wt_"+i,!0),s=Math.floor(1e3*ce.getInstance().getTimeOrigin());if(o.setStartTime(s),e&&e[0]&&(o.setDuration(Math.floor(1e3*e[0].duration)),o.putMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),o.putMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),o.putMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd))),n){var a=n.find(function(t){return"first-paint"===t.name});a&&a.startTime&&o.putMetric("_fp",Math.floor(1e3*a.startTime));var u=n.find(function(t){return"first-contentful-paint"===t.name});u&&u.startTime&&o.putMetric("_fcp",Math.floor(1e3*u.startTime)),r&&o.putMetric("_fid",Math.floor(1e3*r))}Pe(o)}},t.createUserTimingTrace=function(e){Pe(new t(e,!1,e))},t}();function Ue(t){var e=t;if(e&&void 0!==e.responseStart){var n=ce.getInstance().getTimeOrigin(),r=Math.floor(1e3*(e.startTime+n)),i=e.responseStart?Math.floor(1e3*(e.responseStart-e.startTime)):void 0,o=Math.floor(1e3*(e.responseEnd-e.startTime));!function(t){var e=le.getInstance();if(e.instrumentationEnabled){var n=t.url,r=e.logEndPointUrl.split("?")[0],i=e.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout(function(){return De(t,0)},0)}}({url:e.name&&e.name.split("?")[0],responsePayloadBytes:e.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o})}}function je(){pe()&&(setTimeout(function(){return function(){var t=ce.getInstance(),e=t.getEntriesByType("navigation"),n=t.getEntriesByType("paint");if(t.onFirstInputDelay){var r=setTimeout(function(){Fe.createOobTrace(e,n),r=void 0},5e3);t.onFirstInputDelay(function(t){r&&(clearTimeout(r),Fe.createOobTrace(e,n,t))})}else Fe.createOobTrace(e,n)}()},0),setTimeout(function(){return function(){for(var t=ce.getInstance(),e=0,n=t.getEntriesByType("resource");e<n.length;e++)Ue(n[e]);t.setupObserver("resource",Ue)}()},0),setTimeout(function(){return function(){for(var t=ce.getInstance(),e=0,n=t.getEntriesByType("measure");e<n.length;e++)qe(n[e]);t.setupObserver("measure",qe)}()},0))}function qe(t){var e=t.name;"FB-PERF-TRACE-MEASURE"!==e.substring(0,"FB-PERF-TRACE-MEASURE".length)&&Fe.createUserTimingTrace(e)}var Be=function(){function t(t){this.app=t,ce.getInstance().requiredApisAvailable()&&(0,S.eu)().then(function(t){t&&(xe||(Oe(5500),xe=!0),Te().then(je,je))}).catch(function(t){ae.info("Environment doesn't support IndexedDB: "+t)})}return t.prototype.trace=function(t){return new Fe(t)},Object.defineProperty(t.prototype,"instrumentationEnabled",{get:function(){return le.getInstance().instrumentationEnabled},set:function(t){le.getInstance().instrumentationEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataCollectionEnabled",{get:function(){return le.getInstance().dataCollectionEnabled},set:function(t){le.getInstance().dataCollectionEnabled=t},enumerable:!1,configurable:!0}),t}();!function(t){t.INTERNAL.registerComponent(new u.wA("performance",function(t){return function(t,e){if("[DEFAULT]"!==t.name)throw se.create("FB not default");if("undefined"==typeof window)throw se.create("no window");return function(t){re=t}(window),le.getInstance().firebaseAppInstance=t,le.getInstance().installationsService=e,new Be(t)}(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())},"PUBLIC")),t.registerVersion("@firebase/performance","0.4.4")}(i.Z);var Ge=function(){return(Ge=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Ke(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}u((r=r.apply(t,e||[])).next())})}function ze(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}var We,He="https://www.googletagmanager.com/gtag/js",Qe=(()=>(function(t){t.EVENT="event",t.SET="set",t.CONFIG="config"}(Qe||(Qe={})),Qe))(),Ye=(()=>(function(t){t.ADD_SHIPPING_INFO="add_shipping_info",t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SELECT_ITEM="select_item",t.SELECT_PROMOTION="select_promotion",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_CART="view_cart",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results"}(Ye||(Ye={})),Ye))(),$e=new ie.Yd("@firebase/analytics");function Je(t,e,n,r,i,o){return Ke(this,void 0,void 0,function(){var s,a,u,c;return ze(this,function(h){switch(h.label){case 0:s=r[i],h.label=1;case 1:return h.trys.push([1,7,,8]),s?[4,e[s]]:[3,3];case 2:return h.sent(),[3,6];case 3:return[4,Promise.all(n)];case 4:return a=h.sent(),(u=a.find(function(t){return t.measurementId===i}))?[4,e[u.appId]]:[3,6];case 5:h.sent(),h.label=6;case 6:return[3,8];case 7:return c=h.sent(),$e.error(c),[3,8];case 8:return t(Qe.CONFIG,i,o),[2]}})})}function Xe(t,e,n,r,i){return Ke(this,void 0,void 0,function(){var o,s,a,u,c,h,f;return ze(this,function(l){switch(l.label){case 0:return l.trys.push([0,4,,5]),o=[],i&&i.send_to?(s=i.send_to,Array.isArray(s)||(s=[s]),[4,Promise.all(n)]):[3,2];case 1:for(a=l.sent(),u=function(t){var n=a.find(function(e){return e.measurementId===t}),r=n&&e[n.appId];if(!r)return o=[],"break";o.push(r)},c=0,h=s;c<h.length&&"break"!==u(h[c]);c++);l.label=2;case 2:return 0===o.length&&(o=Object.values(e)),[4,Promise.all(o)];case 3:return l.sent(),t(Qe.EVENT,r,i||{}),[3,5];case 4:return f=l.sent(),$e.error(f),[3,5];case 5:return[2]}})})}var Ze=((We={})["already-exists"]="A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",We["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",We["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate: {$reason}",We["invalid-analytics-context"]="Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",We["indexeddb-unavailable"]="IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",We["fetch-throttle"]="The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",We["config-fetch-failed"]="Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",We["no-api-key"]='The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',We["no-app-id"]='The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',We),tn=new S.LL("analytics","Analytics",Ze),en=new(function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e=1e3),this.throttleMetadata=t,this.intervalMillis=e}return t.prototype.getThrottleMetadata=function(t){return this.throttleMetadata[t]},t.prototype.setThrottleMetadata=function(t,e){this.throttleMetadata[t]=e},t.prototype.deleteThrottleMetadata=function(t){delete this.throttleMetadata[t]},t}());function nn(t){var e;return Ke(this,void 0,void 0,function(){var n,r,i,o,s,a;return ze(this,function(u){switch(u.label){case 0:return n=t.appId,r={method:"GET",headers:(c=t.apiKey,new Headers({Accept:"application/json","x-goog-api-key":c}))},i="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),[4,fetch(i,r)];case 1:if(200===(o=u.sent()).status||304===o.status)return[3,6];s="",u.label=2;case 2:return u.trys.push([2,4,,5]),[4,o.json()];case 3:return a=u.sent(),(null===(e=a.error)||void 0===e?void 0:e.message)&&(s=a.error.message),[3,5];case 4:return u.sent(),[3,5];case 5:throw tn.create("config-fetch-failed",{httpStatus:o.status,responseMessage:s});case 6:return[2,o.json()]}var c})})}function rn(t,e,n,r){var i=e.throttleEndTimeMillis,o=e.backoffCount;return void 0===r&&(r=en),Ke(this,void 0,void 0,function(){var e,s,a,u,c,h,f;return ze(this,function(l){switch(l.label){case 0:e=t.appId,s=t.measurementId,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,on(n,i)];case 2:return l.sent(),[3,4];case 3:if(a=l.sent(),s)return $e.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID "+s+' provided in the "measurementId" field in the local Firebase config. ['+a.message+"]"),[2,{appId:e,measurementId:s}];throw a;case 4:return l.trys.push([4,6,,7]),[4,nn(t)];case 5:return u=l.sent(),r.deleteThrottleMetadata(e),[2,u];case 6:if(!function(t){if(!(t instanceof S.ZR&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(c=l.sent())){if(r.deleteThrottleMetadata(e),s)return $e.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID "+s+' provided in the "measurementId" field in the local Firebase config. ['+c.message+"]"),[2,{appId:e,measurementId:s}];throw c}return h=503===Number(c.customData.httpStatus)?(0,S.$s)(o,r.intervalMillis,30):(0,S.$s)(o,r.intervalMillis),f={throttleEndTimeMillis:Date.now()+h,backoffCount:o+1},r.setThrottleMetadata(e,f),$e.debug("Calling attemptFetch again in "+h+" millis"),[2,rn(t,f,n,r)];case 7:return[2]}})})}function on(t,e){return new Promise(function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener(function(){clearTimeout(o),r(tn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}var sn,an,un=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach(function(t){return t()})},t}(),cn={},hn=[],fn={},ln="dataLayer",pn="gtag",dn=!1;function vn(t){if(dn)throw tn.create("already-initialized");t.dataLayerName&&(ln=t.dataLayerName),t.gtagName&&(pn=t.gtagName)}function gn(){return Ke(this,void 0,void 0,function(){return ze(this,function(t){switch(t.label){case 0:if((0,S.ru)())return[2,!1];if(!(0,S.zI)())return[2,!1];if(!(0,S.hl)())return[2,!1];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(0,S.eu)()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,!1];case 4:return[2]}})})}!function(t){t.INTERNAL.registerComponent(new u.wA("analytics",function(t){return function(t,e){!function(){var t=[];if((0,S.ru)()&&t.push("This is a browser extension environment."),(0,S.zI)()||t.push("Cookies are not available."),t.length>0){var e=t.map(function(t,e){return"("+(e+1)+") "+t}).join(" "),n=tn.create("invalid-analytics-context",{errorInfo:e});$e.warn(n.message)}}();var n=t.options.appId;if(!n)throw tn.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw tn.create("no-api-key");$e.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '+t.options.measurementId+' provided in the "measurementId" field in the local Firebase config.')}if(null!=cn[n])throw tn.create("already-exists",{id:n});if(!dn){(function(){for(var t=window.document.getElementsByTagName("script"),e=0,n=Object.values(t);e<n.length;e++){var r=n[e];if(r.src&&r.src.includes(He))return r}return null})()||function(t){var e=document.createElement("script");e.src=He+"?l="+t,e.async=!0,document.head.appendChild(e)}(ln),function(t){var e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(ln);var r=function(t,e,n,r,i){var o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(o=window[i]),window[i]=function(t,e,n,r){return function(i,o,s){return Ke(this,void 0,void 0,function(){var a;return ze(this,function(u){switch(u.label){case 0:return u.trys.push([0,6,,7]),i!==Qe.EVENT?[3,2]:[4,Xe(t,e,n,o,s)];case 1:return u.sent(),[3,5];case 2:return i!==Qe.CONFIG?[3,4]:[4,Je(t,e,n,r,o,s)];case 3:return u.sent(),[3,5];case 4:t(Qe.SET,o),u.label=5;case 5:return[3,7];case 6:return a=u.sent(),$e.error(a),[3,7];case 7:return[2]}})})}}(o,t,e,n),{gtagCore:o,wrappedGtag:window[i]}}(cn,hn,fn,ln,pn);an=r.wrappedGtag,sn=r.gtagCore,dn=!0}return cn[n]=function(t,e,n,r,i){return Ke(this,void 0,void 0,function(){var o,s,a,u,c,h,f;return ze(this,function(l){switch(l.label){case 0:return(o=function(t,e,n){return void 0===e&&(e=en),Ke(this,void 0,void 0,function(){var n,r,i,o,s,a,u=this;return ze(this,function(c){if(i=(n=t.options).apiKey,o=n.measurementId,!(r=n.appId))throw tn.create("no-app-id");if(!i){if(o)return[2,{measurementId:o,appId:r}];throw tn.create("no-api-key")}return s=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new un,setTimeout(function(){return Ke(u,void 0,void 0,function(){return ze(this,function(t){return a.abort(),[2]})})},6e4),[2,rn({appId:r,apiKey:i,measurementId:o},s,a,e)]})})}(t)).then(function(e){n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&$e.warn("The measurement ID in the local Firebase config ("+t.options.measurementId+") does not match the measurement ID fetched from the server ("+e.measurementId+"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")}).catch(function(t){return $e.error(t)}),e.push(o),s=function(){return Ke(this,void 0,void 0,function(){var t;return ze(this,function(e){switch(e.label){case 0:return(0,S.hl)()?[3,1]:($e.warn(tn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),[2,!1]);case 1:return e.trys.push([1,3,,4]),[4,(0,S.eu)()];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),$e.warn(tn.create("indexeddb-unavailable",{errorInfo:t}).message),[2,!1];case 4:return[2,!0]}})})}().then(function(t){return t?r.getId():void 0}),[4,Promise.all([o,s])];case 1:return a=l.sent(),u=a[0],c=a[1],i("js",new Date),(f={}).origin="firebase",f.update=!0,h=f,null!=c&&(h.firebase_id=c),i(Qe.CONFIG,u.measurementId,h),[2,u.measurementId]}})})}(t,hn,fn,e,sn),{app:t,logEvent:function(t,e,r){(function(t,e,n,r,i){return Ke(this,void 0,void 0,function(){var o,s;return ze(this,function(a){switch(a.label){case 0:return i&&i.global?(t(Qe.EVENT,n,r),[2]):[3,1];case 1:return[4,e];case 2:o=a.sent(),s=Ge(Ge({},r),{send_to:o}),t(Qe.EVENT,n,s),a.label=3;case 3:return[2]}})})})(an,cn[n],t,e,r).catch(function(t){return $e.error(t)})},setCurrentScreen:function(t,e){(function(t,e,n,r){return Ke(this,void 0,void 0,function(){var i;return ze(this,function(o){switch(o.label){case 0:return r&&r.global?(t(Qe.SET,{screen_name:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(Qe.CONFIG,i,{update:!0,screen_name:n}),o.label=3;case 3:return[2]}})})})(an,cn[n],t,e).catch(function(t){return $e.error(t)})},setUserId:function(t,e){(function(t,e,n,r){return Ke(this,void 0,void 0,function(){var i;return ze(this,function(o){switch(o.label){case 0:return r&&r.global?(t(Qe.SET,{user_id:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(Qe.CONFIG,i,{update:!0,user_id:n}),o.label=3;case 3:return[2]}})})})(an,cn[n],t,e).catch(function(t){return $e.error(t)})},setUserProperties:function(t,e){(function(t,e,n,r){return Ke(this,void 0,void 0,function(){var i,o,s,a,u;return ze(this,function(c){switch(c.label){case 0:if(!r||!r.global)return[3,1];for(i={},o=0,s=Object.keys(n);o<s.length;o++)i["user_properties."+(a=s[o])]=n[a];return t(Qe.SET,i),[2,Promise.resolve()];case 1:return[4,e];case 2:u=c.sent(),t(Qe.CONFIG,u,{update:!0,user_properties:n}),c.label=3;case 3:return[2]}})})})(an,cn[n],t,e).catch(function(t){return $e.error(t)})},setAnalyticsCollectionEnabled:function(t){(function(t,e){return Ke(this,void 0,void 0,function(){var n;return ze(this,function(r){switch(r.label){case 0:return[4,t];case 1:return n=r.sent(),window["ga-disable-"+n]=!e,[2]}})})})(cn[n],t).catch(function(t){return $e.error(t)})},INTERNAL:{delete:function(){return delete cn[n],Promise.resolve()}}}}(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())},"PUBLIC").setServiceProps({settings:vn,EventName:Ye,isSupported:gn})),t.INTERNAL.registerComponent(new u.wA("analytics-internal",function(t){try{return{logEvent:t.getProvider("analytics").getImmediate().logEvent}}catch(e){throw tn.create("interop-component-reg-failed",{reason:e})}},"PRIVATE")),t.registerVersion("@firebase/analytics","0.6.2")}(i.Z);var yn=function(){return(yn=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function mn(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}u((r=r.apply(t,e||[])).next())})}function bn(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}var wn,_n=function(){function t(t,e,n,r){this.client=t,this.storage=e,this.storageCache=n,this.logger=r}return t.prototype.isCachedDataFresh=function(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-e,r=n<=t;return this.logger.debug("Config fetch cache check. Cache age millis: "+n+". Cache max age millis (minimumFetchIntervalMillis setting): "+t+". Is cache hit: "+r+"."),r},t.prototype.fetch=function(t){return mn(this,void 0,void 0,function(){var e,n,r,i,o;return bn(this,function(s){switch(s.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:return e=s.sent(),n=e[0],(r=e[1])&&this.isCachedDataFresh(t.cacheMaxAgeMillis,n)?[2,r]:(t.eTag=r&&r.eTag,[4,this.client.fetch(t)]);case 2:return i=s.sent(),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===i.status&&o.push(this.storage.setLastSuccessfulFetchResponse(i)),[4,Promise.all(o)];case 3:return s.sent(),[2,i]}})})},t}(),In=((wn={})["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",wn["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",wn["registration-api-key"]="Undefined API key. Check Firebase app initialization.",wn["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",wn["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",wn["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",wn["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",wn["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",wn["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",wn["fetch-timeout"]='The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',wn["fetch-throttle"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',wn["fetch-client-parse"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",wn["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",wn),En=new S.LL("remoteconfig","Remote Config",In),Tn=function(){function t(t,e,n,r,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=o}return t.prototype.fetch=function(t){return mn(this,void 0,void 0,function(){var e,n,r,i,o,s,a,u,c,h,f,l,p,d,v,g;return bn(this,function(y){switch(y.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:e=y.sent(),n=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com",r=n+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey,i={sdk_version:this.sdkVersion,app_instance_id:e[0],app_instance_id_token:e[1],app_id:this.appId,language_code:(void 0===m&&(m=navigator),m.languages&&m.languages[0]||m.language)},o={method:"POST",headers:{"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},body:JSON.stringify(i)},s=fetch(r,o),a=new Promise(function(e,n){t.signal.addEventListener(function(){var t=new Error("The operation was aborted.");t.name="AbortError",n(t)})}),y.label=2;case 2:return y.trys.push([2,5,,6]),[4,Promise.race([s,a])];case 3:return y.sent(),[4,s];case 4:return u=y.sent(),[3,6];case 5:throw c=y.sent(),h="fetch-client-network","AbortError"===c.name&&(h="fetch-timeout"),En.create(h,{originalErrorMessage:c.message});case 6:if(f=u.status,l=u.headers.get("ETag")||void 0,200!==u.status)return[3,11];v=void 0,y.label=7;case 7:return y.trys.push([7,9,,10]),[4,u.json()];case 8:return v=y.sent(),[3,10];case 9:throw g=y.sent(),En.create("fetch-client-parse",{originalErrorMessage:g.message});case 10:p=v.entries,d=v.state,y.label=11;case 11:if("INSTANCE_STATE_UNSPECIFIED"===d?f=500:"NO_CHANGE"===d?f=304:"NO_TEMPLATE"!==d&&"EMPTY_CONFIG"!==d||(p={}),304!==f&&200!==f)throw En.create("fetch-status",{httpStatus:f});return[2,{status:f,eTag:l,config:p}]}var m})})},t}(),Sn=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach(function(t){return t()})},t}(),An=["1","true","t","yes","y","on"],Nn=function(){function t(t,e){void 0===e&&(e=""),this._source=t,this._value=e}return t.prototype.asString=function(){return this._value},t.prototype.asBoolean=function(){return"static"!==this._source&&An.indexOf(this._value.toLowerCase())>=0},t.prototype.asNumber=function(){if("static"===this._source)return 0;var t=Number(this._value);return isNaN(t)&&(t=0),t},t.prototype.getSource=function(){return this._source},t}(),kn=function(){function t(t,e,n,r,i){this.app=t,this._client=e,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return t.prototype.setLogLevel=function(t){switch(t){case"debug":this._logger.logLevel=ie.in.DEBUG;break;case"silent":this._logger.logLevel=ie.in.SILENT;break;default:this._logger.logLevel=ie.in.ERROR}},Object.defineProperty(t.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:!1,configurable:!0}),t.prototype.activate=function(){return mn(this,void 0,void 0,function(){var t,e,n;return bn(this,function(r){switch(r.label){case 0:return[4,Promise.all([this._storage.getLastSuccessfulFetchResponse(),this._storage.getActiveConfigEtag()])];case 1:return t=r.sent(),n=t[1],(e=t[0])&&e.config&&e.eTag&&e.eTag!==n?[4,Promise.all([this._storageCache.setActiveConfig(e.config),this._storage.setActiveConfigEtag(e.eTag)])]:[2,!1];case 2:return r.sent(),[2,!0]}})})},t.prototype.ensureInitialized=function(){var t=this;return this._initializePromise||(this._initializePromise=this._storageCache.loadFromStorage().then(function(){t._isInitializationComplete=!0})),this._initializePromise},t.prototype.fetch=function(){return mn(this,void 0,void 0,function(){var t,e,n,r=this;return bn(this,function(i){switch(i.label){case 0:t=new Sn,setTimeout(function(){return mn(r,void 0,void 0,function(){return bn(this,function(e){return t.abort(),[2]})})},this.settings.fetchTimeoutMillis),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,this._client.fetch({cacheMaxAgeMillis:this.settings.minimumFetchIntervalMillis,signal:t})];case 2:return i.sent(),[4,this._storageCache.setLastFetchStatus("success")];case 3:return i.sent(),[3,6];case 4:return e=i.sent(),n=(o=e)instanceof S.ZR&&-1!==o.code.indexOf("fetch-throttle")?"throttle":"failure",[4,this._storageCache.setLastFetchStatus(n)];case 5:throw i.sent(),e;case 6:return[2]}var o})})},t.prototype.fetchAndActivate=function(){return mn(this,void 0,void 0,function(){return bn(this,function(t){switch(t.label){case 0:return[4,this.fetch()];case 1:return t.sent(),[2,this.activate()]}})})},t.prototype.getAll=function(){var t,e,n=this;return(t=this._storageCache.getActiveConfig(),e=this.defaultConfig,void 0===t&&(t={}),void 0===e&&(e={}),Object.keys(yn(yn({},t),e))).reduce(function(t,e){return t[e]=n.getValue(e),t},{})},t.prototype.getBoolean=function(t){return this.getValue(t).asBoolean()},t.prototype.getNumber=function(t){return this.getValue(t).asNumber()},t.prototype.getString=function(t){return this.getValue(t).asString()},t.prototype.getValue=function(t){this._isInitializationComplete||this._logger.debug('A value was requested for key "'+t+'" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var e=this._storageCache.getActiveConfig();return e&&void 0!==e[t]?new Nn("remote",e[t]):this.defaultConfig&&void 0!==this.defaultConfig[t]?new Nn("default",String(this.defaultConfig[t])):(this._logger.debug('Returning static value for key "'+t+'". Define a default or remote value if this is unintentional.'),new Nn("static"))},t}();function xn(t,e){var n=t.target.error||void 0;return En.create(e,{originalErrorMessage:n&&n.message})}var On=function(){function t(t,e,n,r){void 0===r&&(r=new Promise(function(t,e){var n=indexedDB.open("firebase_remote_config",1);n.onerror=function(t){e(xn(t,"storage-open"))},n.onsuccess=function(e){t(e.target.result)},n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore("app_namespace_store",{keyPath:"compositeKey"})}}})),this.appId=t,this.appName=e,this.namespace=n,this.openDbPromise=r}return t.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")},t.prototype.setLastFetchStatus=function(t){return this.set("last_fetch_status",t)},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.set("last_successful_fetch_timestamp_millis",t)},t.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")},t.prototype.setLastSuccessfulFetchResponse=function(t){return this.set("last_successful_fetch_response",t)},t.prototype.getActiveConfig=function(){return this.get("active_config")},t.prototype.setActiveConfig=function(t){return this.set("active_config",t)},t.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")},t.prototype.setActiveConfigEtag=function(t){return this.set("active_config_etag",t)},t.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")},t.prototype.setThrottleMetadata=function(t){return this.set("throttle_metadata",t)},t.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")},t.prototype.get=function(t){return mn(this,void 0,void 0,function(){var e,n=this;return bn(this,function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise(function(r,i){var o=e.transaction(["app_namespace_store"],"readonly").objectStore("app_namespace_store"),s=n.createCompositeKey(t);try{var a=o.get(s);a.onerror=function(t){i(xn(t,"storage-get"))},a.onsuccess=function(t){var e=t.target.result;r(e?e.value:void 0)}}catch(u){i(En.create("storage-get",{originalErrorMessage:u&&u.message}))}})]}})})},t.prototype.set=function(t,e){return mn(this,void 0,void 0,function(){var n,r=this;return bn(this,function(i){switch(i.label){case 0:return[4,this.openDbPromise];case 1:return n=i.sent(),[2,new Promise(function(i,o){var s=n.transaction(["app_namespace_store"],"readwrite").objectStore("app_namespace_store"),a=r.createCompositeKey(t);try{var u=s.put({compositeKey:a,value:e});u.onerror=function(t){o(xn(t,"storage-set"))},u.onsuccess=function(){i()}}catch(c){o(En.create("storage-set",{originalErrorMessage:c&&c.message}))}})]}})})},t.prototype.delete=function(t){return mn(this,void 0,void 0,function(){var e,n=this;return bn(this,function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise(function(r,i){var o=e.transaction(["app_namespace_store"],"readwrite").objectStore("app_namespace_store"),s=n.createCompositeKey(t);try{var a=o.delete(s);a.onerror=function(t){i(xn(t,"storage-delete"))},a.onsuccess=function(){r()}}catch(u){i(En.create("storage-delete",{originalErrorMessage:u&&u.message}))}})]}})})},t.prototype.createCompositeKey=function(t){return[this.appId,this.appName,this.namespace,t].join()},t}(),Cn=function(){function t(t){this.storage=t}return t.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},t.prototype.getActiveConfig=function(){return this.activeConfig},t.prototype.loadFromStorage=function(){return mn(this,void 0,void 0,function(){var t,e,n,r,i,o;return bn(this,function(s){switch(s.label){case 0:return t=this.storage.getLastFetchStatus(),e=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),[4,t];case 1:return(r=s.sent())&&(this.lastFetchStatus=r),[4,e];case 2:return(i=s.sent())&&(this.lastSuccessfulFetchTimestampMillis=i),[4,n];case 3:return(o=s.sent())&&(this.activeConfig=o),[2]}})})},t.prototype.setLastFetchStatus=function(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)},t.prototype.setActiveConfig=function(t){return this.activeConfig=t,this.storage.setActiveConfig(t)},t}();function Dn(t,e){return new Promise(function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener(function(){clearTimeout(o),r(En.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}var Pn,Mn=function(){function t(t,e){this.client=t,this.storage=e}return t.prototype.fetch=function(t){return mn(this,void 0,void 0,function(){var e;return bn(this,function(n){switch(n.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return e=n.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(t,e)]}})})},t.prototype.attemptFetch=function(t,e){var n=e.throttleEndTimeMillis,r=e.backoffCount;return mn(this,void 0,void 0,function(){var e,i,o;return bn(this,function(s){switch(s.label){case 0:return[4,Dn(t.signal,n)];case 1:s.sent(),s.label=2;case 2:return s.trys.push([2,5,,7]),[4,this.client.fetch(t)];case 3:return e=s.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return s.sent(),[2,e];case 5:if(!function(t){if(!(t instanceof S.ZR&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(i=s.sent()))throw i;return o={throttleEndTimeMillis:Date.now()+(0,S.$s)(r),backoffCount:r+1},[4,this.storage.setThrottleMetadata(o)];case 6:return s.sent(),[2,this.attemptFetch(t,o)];case 7:return[2]}})})},t}();(Pn=i.Z).INTERNAL.registerComponent(new u.wA("remoteConfig",function(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("installations").getImmediate();if("undefined"==typeof window)throw En.create("registration-window");var i=n.options,o=i.projectId,s=i.apiKey,a=i.appId;if(!o)throw En.create("registration-project-id");if(!s)throw En.create("registration-api-key");if(!a)throw En.create("registration-app-id");var u=new On(a,n.name,e=e||"firebase"),c=new Cn(u),h=new ie.Yd("@firebase/remote-config");h.logLevel=ie.in.ERROR;var f=new Tn(r,Pn.SDK_VERSION,e,o,s,a),l=new Mn(f,u),p=new _n(l,u,c,h),d=new kn(n,p,c,u,h);return d.ensureInitialized(),d},"PUBLIC").setMultipleInstances(!0)),Pn.registerVersion("@firebase/remote-config","0.1.30"),i.Z.registerVersion("firebase","8.0.2","app"),console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the module builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nCommonJS Modules:\nconst firebase = require('firebase/app');\nrequire('firebase/<PACKAGE>');\n\nES Modules:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n\nTypescript:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n"),i.Z.registerVersion("firebase","8.0.2");var Ln=n(7716),Rn=n(3637),Vn=n(7574),Fn=n(4402),Un=n(5917),jn=n(8002),qn=n(2145),Bn=n(5435),Gn=n(309),Kn=n(7168),zn=n(8583),Wn=n(2329);function Hn(t,e){return function(t,e=Rn.z){return new Vn.y(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot(n)}):r=t.onSnapshot(n),()=>{null!=r&&r()}})}(t,e)}function Qn(t,e){return Hn(t,e).pipe((0,jn.U)(t=>({payload:t,type:"query"})))}function Yn(t,e){return Qn(t,e).pipe((0,jn.U)(t=>t.payload.docChanges().map(t=>({type:t.type,payload:t}))))}function $n(t,e,n){return Qn(t,n).pipe((0,jn.U)(t=>t.payload.docChanges()),(0,qn.R)((t,n)=>function(t,e,n){return e.forEach(e=>{n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)||t.splice(e.newIndex,0,e);break;case"modified":(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))&&(e.oldIndex!==e.newIndex?(t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e)):t.splice(e.newIndex,1,e));break;case"removed":t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref)&&t.splice(e.oldIndex,1)}return t}(t,e))}),t}(t,n,e),[]),(0,jn.U)(t=>t.map(t=>({type:t.type,payload:t}))))}function Jn(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}class Xn{constructor(t,e,n){this.ref=t,this.query=e,this.afs=n}stateChanges(t){return t&&0!==t.length?Yn(this.query,this.afs.schedulers.outsideAngular).pipe((0,jn.U)(e=>e.filter(e=>t.indexOf(e.type)>-1)),(0,Bn.h)(t=>t.length>0),this.afs.keepUnstableUntilFirst):Yn(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe((0,qn.R)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=Jn(t);return $n(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return Qn(this.query,this.afs.schedulers.outsideAngular).pipe((0,jn.U)(e=>e.payload.docs.map(e=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return(0,Fn.D)(this.query.get(t)).pipe((0,Gn.QV)(this.afs.schedulers.insideAngular))}add(t){return this.ref.add(t)}doc(t){return new Zn(this.ref.doc(t),this.afs)}}class Zn{constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const n=this.ref.collection(t),{ref:r,query:i}=or(n,e);return new Xn(r,i,this.afs)}snapshotChanges(){return Hn(this.ref,this.afs.schedulers.outsideAngular).pipe((0,jn.U)(t=>({payload:t,type:"value"}))).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(){return this.snapshotChanges().pipe((0,jn.U)(t=>t.payload.data()))}get(t){return(0,Fn.D)(this.ref.get(t)).pipe((0,Gn.QV)(this.afs.schedulers.insideAngular))}}class tr{constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?Yn(this.query,this.afs.schedulers.outsideAngular).pipe((0,jn.U)(e=>e.filter(e=>t.indexOf(e.type)>-1)),(0,Bn.h)(t=>t.length>0),this.afs.keepUnstableUntilFirst):Yn(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe((0,qn.R)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=Jn(t);return $n(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(){return Qn(this.query,this.afs.schedulers.outsideAngular).pipe((0,jn.U)(t=>t.payload.docs.map(t=>t.data())),this.afs.keepUnstableUntilFirst)}get(t){return(0,Fn.D)(this.query.get(t)).pipe((0,Gn.QV)(this.afs.schedulers.insideAngular))}}const er=n(9383),nr=new Ln.OlP("angularfire2.enableFirestorePersistence"),rr=new Ln.OlP("angularfire2.firestore.persistenceSettings"),ir=new Ln.OlP("angularfire2.firestore.settings");function or(t,e=(t=>t)){return{query:e(t),ref:t}}let sr=(()=>{class t{constructor(t,e,n,r,i,o,s){this.schedulers=new Kn.HU(o),this.keepUnstableUntilFirst=(0,Kn.ss)(this.schedulers),this.firestore=o.runOutsideAngular(()=>{const n=(0,Kn.on)(t,o,e);"registerFirestore"in er&&er.registerFirestore(Wn.Z);const i=n.firestore();return r&&i.settings(r),i}),this.persistenceEnabled$=n&&!(0,zn.PM)(i)?o.runOutsideAngular(()=>{try{return(0,Fn.D)(this.firestore.enablePersistence(s||void 0).then(()=>!0,()=>!1))}catch(t){return(0,Un.of)(!1)}}):(0,Un.of)(!1)}collection(t,e){let n;n="string"==typeof t?this.firestore.collection(t):t;const{ref:r,query:i}=or(n,e),o=this.schedulers.ngZone.run(()=>r);return new Xn(o,i,this)}collectionGroup(t,e){const n=e||(t=>t),r=this.firestore.collectionGroup(t);return new tr(n(r),this)}doc(t){let e;e="string"==typeof t?this.firestore.doc(t):t;const n=this.schedulers.ngZone.run(()=>e);return new Zn(n,this)}createId(){return this.firestore.collection("_").doc().id}}return t.\u0275fac=function(e){return new(e||t)(Ln.LFG(Kn.Dh),Ln.LFG(Kn.xv,8),Ln.LFG(nr,8),Ln.LFG(ir,8),Ln.LFG(Ln.Lbi),Ln.LFG(Ln.R0b),Ln.LFG(rr,8))},t.\u0275prov=(0,Ln.Yz7)({factory:function(){return new t((0,Ln.LFG)(Kn.Dh),(0,Ln.LFG)(Kn.xv,8),(0,Ln.LFG)(nr,8),(0,Ln.LFG)(ir,8),(0,Ln.LFG)(Ln.Lbi),(0,Ln.LFG)(Ln.R0b),(0,Ln.LFG)(rr,8))},token:t,providedIn:"any"}),t})();var ar=n(5346),ur=n(3550);let cr=(()=>{class t{constructor(t,e,n,r){this.afs=t,this.afAuth=e,this.router=n,this.ngZone=r,this.afAuth.authState.subscribe(t=>{t?(this.userData=t,localStorage.setItem("user",JSON.stringify(this.userData)),JSON.parse(localStorage.getItem("user"))):(localStorage.setItem("user",null),JSON.parse(localStorage.getItem("user")))})}SignIn(t,e){return this.afAuth.signInWithEmailAndPassword(t,e).then(t=>{this.ngZone.run(()=>{this.router.navigate(["/tabs/scan"])}),this.SetUserData(t.user)}).catch(t=>{window.alert(t.message)})}SignUp(t,e){return this.afAuth.createUserWithEmailAndPassword(t,e).then(t=>{this.SendVerificationMail(),this.SetUserData(t.user)}).catch(t=>{window.alert(t.message)})}SendVerificationMail(){return(0,r.mG)(this,void 0,void 0,function*(){return yield(yield this.afAuth.currentUser).sendEmailVerification().then(()=>{this.router.navigate(["verify-email-address"])})})}ForgotPassword(t){return this.afAuth.sendPasswordResetEmail(t).then(()=>{window.alert("Password reset email sent, check your inbox.")}).catch(t=>{window.alert(t)})}get isLoggedIn(){const t=JSON.parse(localStorage.getItem("user"));return null!==t&&!1!==t.emailVerified}GoogleAuth(){return this.AuthLogin(new i.Z.auth.GoogleAuthProvider)}FacebookAuth(){return this.AuthLogin(new i.Z.auth.FacebookAuthProvider)}AuthLogin(t){return this.afAuth.signInWithPopup(t).then(t=>{this.ngZone.run(()=>{this.router.navigate(["/tabs/scan"])}),this.SetUserData(t.user)}).catch(t=>{window.alert(t)})}SetUserData(t){return this.afs.doc(`users/${t.uid}`).set({uid:t.uid,email:t.email,displayName:t.displayName,photoURL:t.photoURL,emailVerified:t.emailVerified},{merge:!0})}SignOut(){return this.afAuth.signOut().then(()=>{localStorage.removeItem("user"),this.router.navigate(["login"])})}}return t.\u0275fac=function(e){return new(e||t)(Ln.LFG(sr),Ln.LFG(ar.z),Ln.LFG(ur.F0),Ln.LFG(Ln.R0b))},t.\u0275prov=Ln.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},4762:function(t,e,n){"use strict";function r(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}u((r=r.apply(t,e||[])).next())})}n.d(e,{mG:function(){return r}})}}]);